"use strict";(()=>{var Wo=Object.defineProperty;var Vo=(i,e,t)=>e in i?Wo(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Re=(i,e,t)=>Vo(i,typeof e!="symbol"?e+"":e,t);var f=typeof window<"u"?window:void 0,J=typeof globalThis<"u"?globalThis:f,gs=Array.prototype,wr=gs.forEach,kr=gs.indexOf,ee=J?.navigator,y=J?.document,K=J?.location,zn=J?.fetch,Un=J!=null&&J.XMLHttpRequest&&"withCredentials"in new J.XMLHttpRequest?J.XMLHttpRequest:void 0,Er=J?.AbortController,Y=ee?.userAgent,S=f??{},_e={DEBUG:!1,LIB_VERSION:"1.289.0"};function Sr(i,e,t,n,r,s,o){try{var a=i[s](o),l=a.value}catch(u){return void t(u)}a.done?e(l):Promise.resolve(l).then(n,r)}function Cr(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(l){Sr(s,n,r,o,a,"next",l)}function a(l){Sr(s,n,r,o,a,"throw",l)}o(void 0)})}}function k(){return k=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},k.apply(null,arguments)}function fs(i,e){if(i==null)return{};var t={};for(var n in i)if({}.hasOwnProperty.call(i,n)){if(e.indexOf(n)!==-1)continue;t[n]=i[n]}return t}var Xo=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],xr=function(i,e){if(e===void 0&&(e=[]),!i)return!1;var t=i.toLowerCase();return Xo.concat(e).some(n=>{var r=n.toLowerCase();return t.indexOf(r)!==-1})},Yo=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function R(i,e){return i.indexOf(e)!==-1}var gn=function(i){return i.trim()},qn=function(i){return i.replace(/^\$/,"")},Ko=Array.isArray,vs=Object.prototype,_s=vs.hasOwnProperty,fn=vs.toString,$=Ko||function(i){return fn.call(i)==="[object Array]"},$e=i=>typeof i=="function",G=i=>i===Object(i)&&!$(i),Ye=i=>{if(G(i)){for(var e in i)if(_s.call(i,e))return!1;return!0}return!1},m=i=>i===void 0,B=i=>fn.call(i)=="[object String]",Hn=i=>B(i)&&i.trim().length===0,we=i=>i===null,F=i=>m(i)||we(i),ge=i=>fn.call(i)=="[object Number]",Le=i=>fn.call(i)==="[object Boolean]",Jo=i=>i instanceof FormData,Zo=i=>R(Yo,i);function Gn(i){return i===null||typeof i!="object"}function Vt(i,e){return Object.prototype.toString.call(i)==="[object "+e+"]"}function ms(i){return!m(Event)&&function(e,t){try{return e instanceof t}catch{return!1}}(i,Event)}var Qo=[!0,"true",1,"1","yes"],xn=i=>R(Qo,i),ea=[!1,"false",0,"0","no"];function de(i,e,t,n,r){return e>t&&(n.warn("min cannot be greater than max."),e=t),ge(i)?i>t?(n.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):i<e?(n.warn(" cannot be less than min: "+e+". Using min value instead."),e):i:(n.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+r),de(r||t,e,t,n))}var Wn=class{constructor(e){this.t={},this.i=e.i,this.o=de(e.bucketSize,0,100,e.h),this.m=de(e.refillRate,0,this.o,e.h),this.$=de(e.refillInterval,0,864e5,e.h)}S(e,t){var n=t-e.lastAccess,r=Math.floor(n/this.$);if(r>0){var s=r*this.m;e.tokens=Math.min(e.tokens+s,this.o),e.lastAccess=e.lastAccess+r*this.$}}consumeRateLimit(e){var t,n=Date.now(),r=String(e),s=this.t[r];return s?this.S(s,n):(s={tokens:this.o,lastAccess:n},this.t[r]=s),s.tokens===0||(s.tokens--,s.tokens===0&&((t=this.i)==null||t.call(this,e)),s.tokens===0)}stop(){this.t={}}},Nt,Tr,Tn,ta=i=>i instanceof Error;function na(i){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return Tn&&t.length===Tr||(Tr=t.length,Tn=t.reduce((n,r)=>{Nt||(Nt={});var s=Nt[r];if(s)n[s[0]]=s[1];else for(var o=i(r),a=o.length-1;a>=0;a--){var l=o[a],u=l?.filename,c=e[r];if(u&&c){n[u]=c,Nt[r]=[u,c];break}}return n},{})),Tn}}var Qe="?";function Vn(i,e,t,n){var r={platform:"web:javascript",filename:i,function:e==="<anonymous>"?Qe:e,in_app:!0};return m(t)||(r.lineno=t),m(n)||(r.colno=n),r}var ys=(i,e)=>{var t=i.indexOf("safari-extension")!==-1,n=i.indexOf("safari-web-extension")!==-1;return t||n?[i.indexOf("@")!==-1?i.split("@")[0]:Qe,t?"safari-extension:"+e:"safari-web-extension:"+e]:[i,e]},ia=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,ra=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,sa=/\((\S*)(?::(\d+))(?::(\d+))\)/,oa=i=>{var e=ia.exec(i);if(e){var[,t,n,r]=e;return Vn(t,Qe,+n,+r)}var s=ra.exec(i);if(s){if(s[2]&&s[2].indexOf("eval")===0){var o=sa.exec(s[2]);o&&(s[2]=o[1],s[3]=o[2],s[4]=o[3])}var[a,l]=ys(s[1]||Qe,s[2]);return Vn(l,a,s[3]?+s[3]:void 0,s[4]?+s[4]:void 0)}},aa=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,la=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,ca=i=>{var e=aa.exec(i);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){var t=la.exec(e[3]);t&&(e[1]=e[1]||"eval",e[3]=t[1],e[4]=t[2],e[5]="")}var n=e[3],r=e[1]||Qe;return[r,n]=ys(r,n),Vn(n,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},Rr=/\(error: (.*)\)/,Pr=50;function ua(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return function(n,r){r===void 0&&(r=0);for(var s=[],o=n.split(`
`),a=r;a<o.length;a++){var l=o[a];if(!(l.length>1024)){var u=Rr.test(l)?l.replace(Rr,"$1"):l;if(!u.match(/\S*Error: /)){for(var c of e){var h=c(u);if(h){s.push(h);break}}if(s.length>=Pr)break}}}return function(d){if(!d.length)return[];var p=Array.from(d);return p.reverse(),p.slice(0,Pr).map(g=>{return k({},g,{filename:g.filename||(v=p,v[v.length-1]||{}).filename,function:g.function||Qe});var v})}(s)}}var Xn=class{constructor(e,t,n){e===void 0&&(e=[]),t===void 0&&(t=[]),n===void 0&&(n=[]),this.coercers=e,this.modifiers=n,this.stackParser=ua(...t)}buildFromUnknown(e,t){t===void 0&&(t={});var n=t&&t.mechanism||{handled:!0,type:"generic"},r=this.buildCoercingContext(n,t,0).apply(e),s=this.buildParsingContext(),o=this.parseStacktrace(r,s);return{$exception_list:this.convertToExceptionList(o,n),$exception_level:"error"}}modifyFrames(e){var t=this;return Cr(function*(){for(var n of e)n.stacktrace&&n.stacktrace.frames&&$(n.stacktrace.frames)&&(n.stacktrace.frames=yield t.applyModifiers(n.stacktrace.frames));return e})()}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var n,r;return e.cause!=null&&(n=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(r=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?1:0),t.chunkIdMap)),k({},e,{cause:n,stack:r})}applyChunkIds(e,t){return e.map(n=>(n.filename&&t&&(n.chunk_id=t[n.filename]),n))}applyCoercers(e,t){for(var n of this.coercers)if(n.match(e))return n.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return Cr(function*(){var n=e;for(var r of t.modifiers)n=yield r(n);return n})()}convertToExceptionList(e,t){var n,r,s,o={type:e.type,value:e.value,mechanism:{type:(n=t.type)!==null&&n!==void 0?n:"generic",handled:(r=t.handled)===null||r===void 0||r,synthetic:(s=e.synthetic)!==null&&s!==void 0&&s}};e.stack&&(o.stacktrace={type:"raw",frames:e.stack});var a=[o];return e.cause!=null&&a.push(...this.convertToExceptionList(e.cause,k({},t,{handled:!0}))),a}buildParsingContext(){return{chunkIdMap:na(this.stackParser)}}buildCoercingContext(e,t,n){n===void 0&&(n=0);var r=(s,o)=>{if(o<=4){var a=this.buildCoercingContext(e,t,o);return this.applyCoercers(s,a)}};return k({},t,{syntheticException:n==0?t.syntheticException:void 0,mechanism:e,apply:s=>r(s,n),next:s=>r(s,n+1)})}},Yn=class{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var n=B(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:n?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return Vt(e,"DOMException")}isDOMError(e){return Vt(e,"DOMError")}},Kn=class{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var n=e.message;return n.error&&typeof n.error.message=="string"?String(n.error.message):String(n)}getStack(e){return e.stacktrace||e.stack||void 0}},Jn=class{constructor(){}match(e){return Vt(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var n,r=t.apply(e.error);return r||{type:"ErrorEvent",value:e.message,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}},da=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i,Zn=class{match(e){return typeof e=="string"}coerce(e,t){var n,[r,s]=this.getInfos(e);return{type:r??"Error",value:s??e,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}getInfos(e){var t="Error",n=e,r=e.match(da);return r&&(t=r[1],n=r[2]),[t,n]}},ha=["fatal","error","warning","log","info","debug"];function bs(i,e){e===void 0&&(e=40);var t=Object.keys(i);if(t.sort(),!t.length)return"[object has no keys]";for(var n=t.length;n>0;n--){var r=t.slice(0,n).join(", ");if(!(r.length>e))return n===t.length||r.length<=e?r:r.slice(0,e)+"..."}return""}var Qn=class{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var n,r=this.getErrorPropertyFromObject(e);return r?t.apply(r):{type:this.getType(e),value:this.getValue(e),stack:(n=t.syntheticException)==null?void 0:n.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return ms(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var n=this.getObjectClassName(e);return(n&&n!=="Object"?"'"+n+"'":"Object")+" captured as exception with keys: "+bs(e)}isSeverityLevel(e){return B(e)&&!Hn(e)&&ha.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if(ta(n))return n}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}},ei=class{match(e){return ms(e)}coerce(e,t){var n,r=e.constructor.name;return{type:r,value:r+" captured as exception with keys: "+bs(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}},ti=class{match(e){return Gn(e)}coerce(e,t){var n;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}},ni=class{match(e){return Vt(e,"PromiseRejectionEvent")}coerce(e,t){var n,r=this.getUnhandledRejectionReason(e);return Gn(r)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(r),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}:t.apply(r)}getUnhandledRejectionReason(e){if(Gn(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}},ws=i=>{var e={k:function(t){if(f&&(_e.DEBUG||S.POSTHOG_DEBUG)&&!m(f.console)&&f.console){for(var n=("__rrweb_original__"in f.console[t])?f.console[t].__rrweb_original__:f.console[t],r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];n(i,...s)}},info:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.k("log",...n)},warn:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.k("warn",...n)},error:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.k("error",...n)},critical:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];console.error(i,...n)},uninitializedWarning:t=>{e.error("You must initialize PostHog before calling "+t)},createLogger:t=>ws(i+" "+t)};return e},w=ws("[PostHog.js]"),U=w.createLogger,pa=U("[ExternalScriptsLoader]"),Ir=(i,e,t)=>{if(i.config.disable_external_dependency_loading)return pa.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var n=y?.querySelectorAll("script");if(n){for(var r,s=function(){if(n[o].src===e){var l=n[o];return l.__posthog_loading_callback_fired?{v:t()}:(l.addEventListener("load",u=>{l.__posthog_loading_callback_fired=!0,t(void 0,u)}),l.onerror=u=>t(u),{v:void 0})}},o=0;o<n.length;o++)if(r=s())return r.v}var a=()=>{if(!y)return t("document not found");var l=y.createElement("script");if(l.type="text/javascript",l.crossOrigin="anonymous",l.src=e,l.onload=h=>{l.__posthog_loading_callback_fired=!0,t(void 0,h)},l.onerror=h=>t(h),i.config.prepare_external_dependency_script&&(l=i.config.prepare_external_dependency_script(l)),!l)return t("prepare_external_dependency_script returned null");var u,c=y.querySelectorAll("body > script");c.length>0?(u=c[0].parentNode)==null||u.insertBefore(l,c[0]):y.body.appendChild(l)};y!=null&&y.body?a():y?.addEventListener("DOMContentLoaded",a)};S.__PosthogExtensions__=S.__PosthogExtensions__||{},S.__PosthogExtensions__.loadExternalDependency=(i,e,t)=>{var n="/static/"+e+".js?v="+i.version;if(e==="remote-config"&&(n="/array/"+i.config.token+"/config.js"),e==="toolbar"){var r=3e5;n=n+"&t="+Math.floor(Date.now()/r)*r}var s=i.requestRouter.endpointFor("assets",n);Ir(i,s,t)},S.__PosthogExtensions__.loadSiteApp=(i,e,t)=>{var n=i.requestRouter.endpointFor("api",e);Ir(i,n,t)};var Xt={};function De(i,e,t){if($(i)){if(wr&&i.forEach===wr)i.forEach(e,t);else if("length"in i&&i.length===+i.length){for(var n=0,r=i.length;n<r;n++)if(n in i&&e.call(t,i[n],n)===Xt)return}}}function A(i,e,t){if(!F(i)){if($(i))return De(i,e,t);if(Jo(i)){for(var n of i.entries())if(e.call(t,n[1],n[0])===Xt)return}else for(var r in i)if(_s.call(i,r)&&e.call(t,i[r],r)===Xt)return}}var N=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return De(t,function(r){for(var s in r)r[s]!==void 0&&(i[s]=r[s])}),i},it=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return De(t,function(r){De(r,function(s){i.push(s)})}),i};function Ht(i){for(var e=Object.keys(i),t=e.length,n=new Array(t);t--;)n[t]=[e[t],i[e[t]]];return n}var Ar=function(i){try{return i()}catch{return}},ga=function(i){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.apply(this,t)}catch(r){w.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),w.critical(r)}}},Ji=function(i){var e={};return A(i,function(t,n){(B(t)&&t.length>0||ge(t))&&(e[n]=t)}),e};function fa(i,e){return t=i,n=s=>B(s)&&!we(e)?s.slice(0,e):s,r=new Set,function s(o,a){return o!==Object(o)?n?n(o,a):o:r.has(o)?void 0:(r.add(o),$(o)?(l=[],De(o,u=>{l.push(s(u))})):(l={},A(o,(u,c)=>{r.has(u)||(l[c]=s(u,c))})),l);var l}(t);var t,n,r}var va=["herokuapp.com","vercel.app","netlify.app"];function _a(i){var e=i?.hostname;if(!B(e))return!1;var t=e.split(".").slice(-2).join(".");for(var n of va)if(t===n)return!1;return!0}function ks(i,e){for(var t=0;t<i.length;t++)if(e(i[t]))return i[t]}function M(i,e,t,n){var{capture:r=!1,passive:s=!0}=n??{};i?.addEventListener(e,t,{capture:r,passive:s})}var Es="$people_distinct_id",ft="__alias",vt="__timers",Or="$autocapture_disabled_server_side",ii="$heatmaps_enabled_server_side",Fr="$exception_capture_enabled_server_side",ri="$error_tracking_suppression_rules",$r="$error_tracking_capture_extension_exceptions",Lr="$web_vitals_enabled_server_side",Ss="$dead_clicks_enabled_server_side",Dr="$web_vitals_allowed_metrics",Rn="$session_recording_remote_config",Yt="$sesid",Cs="$session_is_sampled",Ke="$enabled_feature_flags",_t="$early_access_features",si="$feature_flag_details",mt="$stored_person_properties",ze="$stored_group_properties",oi="$surveys",Mt="$surveys_activated",Kt="$flag_call_reported",me="$user_state",ai="$client_session_props",li="$capture_rate_limit",ci="$initial_campaign_params",ui="$initial_referrer_info",Jt="$initial_person_info",Zt="$epp",xs="__POSTHOG_TOOLBAR__",lt="$posthog_cookieless",ma=[Es,ft,"__cmpns",vt,"$session_recording_enabled_server_side",ii,Yt,Ke,ri,me,_t,si,ze,mt,oi,Kt,ai,li,ci,ui,Zt,Jt];function Nr(i){return i instanceof Element&&(i.id===xs||!(i.closest==null||!i.closest(".toolbar-global-fade-container")))}function vn(i){return!!i&&i.nodeType===1}function Ne(i,e){return!!i&&!!i.tagName&&i.tagName.toLowerCase()===e.toLowerCase()}function Ts(i){return!!i&&i.nodeType===3}function Rs(i){return!!i&&i.nodeType===11}function Zi(i){return i?gn(i).split(/\s+/):[]}function Mr(i){var e=f?.location.href;return!!(e&&i&&i.some(t=>e.match(t)))}function Qt(i){var e="";switch(typeof i.className){case"string":e=i.className;break;case"object":e=(i.className&&"baseVal"in i.className?i.className.baseVal:null)||i.getAttribute("class")||"";break;default:e=""}return Zi(e)}function Ps(i){return F(i)?null:gn(i).split(/(\s+)/).filter(e=>Ct(e)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function _n(i){var e="";return di(i)&&!$s(i)&&i.childNodes&&i.childNodes.length&&A(i.childNodes,function(t){var n;Ts(t)&&t.textContent&&(e+=(n=Ps(t.textContent))!==null&&n!==void 0?n:"")}),gn(e)}function Is(i){return m(i.target)?i.srcElement||null:(e=i.target)!=null&&e.shadowRoot?i.composedPath()[0]||null:i.target||null;var e}var Qi=["a","button","form","input","select","textarea","label"];function As(i,e){if(m(e))return!0;var t,n=function(s){if(e.some(o=>s.matches(o)))return{v:!0}};for(var r of i)if(t=n(r))return t.v;return!1}function Os(i){var e=i.parentNode;return!(!e||!vn(e))&&e}var jr=[".ph-no-rageclick",".ph-no-capture"],er=i=>!i||Ne(i,"html")||!vn(i),Fs=(i,e)=>{if(!f||er(i))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,n=[i],r=i;r.parentNode&&!Ne(r,"body");)if(Rs(r.parentNode))n.push(r.parentNode.host),r=r.parentNode.host;else{var s=Os(r);if(!s)break;if(e||Qi.indexOf(s.tagName.toLowerCase())>-1)t=!0;else{var o=f.getComputedStyle(s);o&&o.getPropertyValue("cursor")==="pointer"&&(t=!0)}n.push(s),r=s}return{parentIsUsefulElement:t,targetElementList:n}};function ya(i,e,t,n,r){var s,o,a,l;if(t===void 0&&(t=void 0),!f||er(i)||(s=t)!=null&&s.url_allowlist&&!Mr(t.url_allowlist)||(o=t)!=null&&o.url_ignorelist&&Mr(t.url_ignorelist))return!1;if((a=t)!=null&&a.dom_event_allowlist){var u=t.dom_event_allowlist;if(u&&!u.some(g=>e.type===g))return!1}var{parentIsUsefulElement:c,targetElementList:h}=Fs(i,n);if(!function(g,v){var _=v?.element_allowlist;if(m(_))return!0;var E,x=function(C){if(_.some(P=>C.tagName.toLowerCase()===P))return{v:!0}};for(var b of g)if(E=x(b))return E.v;return!1}(h,t)||!As(h,(l=t)==null?void 0:l.css_selector_allowlist))return!1;var d=f.getComputedStyle(i);if(d&&d.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var p=i.tagName.toLowerCase();switch(p){case"html":return!1;case"form":return(r||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(r||["change","click"]).indexOf(e.type)>=0;default:return c?(r||["click"]).indexOf(e.type)>=0:(r||["click"]).indexOf(e.type)>=0&&(Qi.indexOf(p)>-1||i.getAttribute("contenteditable")==="true")}}function di(i){for(var e=i;e.parentNode&&!Ne(e,"body");e=e.parentNode){var t=Qt(e);if(R(t,"ph-sensitive")||R(t,"ph-no-capture"))return!1}if(R(Qt(i),"ph-include"))return!0;var n=i.type||"";if(B(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var r=i.name||i.id||"";return!(B(r)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(r.replace(/[^a-zA-Z0-9]/g,"")))}function $s(i){return!!(Ne(i,"input")&&!["button","checkbox","submit","reset"].includes(i.type)||Ne(i,"select")||Ne(i,"textarea")||i.getAttribute("contenteditable")==="true")}var Ls="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",ba=new RegExp("^(?:"+Ls+")$"),wa=new RegExp(Ls),Ds="\\d{3}-?\\d{2}-?\\d{4}",ka=new RegExp("^("+Ds+")$"),Ea=new RegExp("("+Ds+")");function Ct(i,e){return e===void 0&&(e=!0),!(F(i)||B(i)&&(i=gn(i),(e?ba:wa).test((i||"").replace(/[- ]/g,""))||(e?ka:Ea).test(i)))}function Ns(i){var e=_n(i);return Ct(e=(e+" "+Ms(i)).trim())?e:""}function Ms(i){var e="";return i&&i.childNodes&&i.childNodes.length&&A(i.childNodes,function(t){var n;if(t&&((n=t.tagName)==null?void 0:n.toLowerCase())==="span")try{var r=_n(t);e=(e+" "+r).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+Ms(t)).trim())}catch(s){w.error("[AutoCapture]",s)}}),e}function Sa(i){return function(e){var t=e.map(n=>{var r,s,o="";if(n.tag_name&&(o+=n.tag_name),n.attr_class)for(var a of(n.attr_class.sort(),n.attr_class))o+="."+a.replace(/"/g,"");var l=k({},n.text?{text:n.text}:{},{"nth-child":(r=n.nth_child)!==null&&r!==void 0?r:0,"nth-of-type":(s=n.nth_of_type)!==null&&s!==void 0?s:0},n.href?{href:n.href}:{},n.attr_id?{attr_id:n.attr_id}:{},n.attributes),u={};return Ht(l).sort((c,h)=>{var[d]=c,[p]=h;return d.localeCompare(p)}).forEach(c=>{var[h,d]=c;return u[Br(h.toString())]=Br(d.toString())}),o+=":",o+=Ht(u).map(c=>{var[h,d]=c;return h+'="'+d+'"'}).join("")});return t.join(";")}(function(e){return e.map(t=>{var n,r,s={text:(n=t.$el_text)==null?void 0:n.slice(0,400),tag_name:t.tag_name,href:(r=t.attr__href)==null?void 0:r.slice(0,2048),attr_class:Ca(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Ht(t).filter(o=>{var[a]=o;return a.indexOf("attr__")===0}).forEach(o=>{var[a,l]=o;return s.attributes[a]=l}),s})}(i))}function Br(i){return i.replace(/"|\\"/g,'\\"')}function Ca(i){var e=i.attr__class;return e?$(e)?e:Zi(e):void 0}var en=class{constructor(){this.clicks=[]}isRageClick(e,t,n){var r=this.clicks[this.clicks.length-1];if(r&&Math.abs(e-r.x)+Math.abs(t-r.y)<30&&n-r.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:n}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}},Pn="$copy_autocapture",be=function(i){return i.GZipJS="gzip-js",i.Base64="base64",i}({});var tn=i=>{var e=y?.createElement("a");return m(e)?null:(e.href=i,e)},xa=function(i,e){var t,n;e===void 0&&(e="&");var r=[];return A(i,function(s,o){m(s)||m(o)||o==="undefined"||(t=encodeURIComponent((a=>a instanceof File)(s)?s.name:s.toString()),n=encodeURIComponent(o),r[r.length]=n+"="+t)}),r.join(e)},nn=function(i,e){for(var t,n=((i.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),r=0;r<n.length;r++){var s=n[r].split("=");if(s[0]===e){t=s;break}}if(!$(t)||t.length<2)return"";var o=t[1];try{o=decodeURIComponent(o)}catch{w.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},At=function(i,e,t){if(!i||!e||!e.length)return i;for(var n=i.split("#"),r=n[0]||"",s=n[1],o=r.split("?"),a=o[1],l=o[0],u=(a||"").split("&"),c=[],h=0;h<u.length;h++){var d=u[h].split("=");$(d)&&(e.includes(d[0])?c.push(d[0]+"="+t):c.push(u[h]))}var p=l;return a!=null&&(p+="?"+c.join("&")),s!=null&&(p+="#"+s),p},rn=function(i,e){var t=i.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},zr=U("[AutoCapture]");function In(i,e){return e.length>i?e.slice(0,i)+"...":e}function Ta(i){if(i.previousElementSibling)return i.previousElementSibling;var e=i;do e=e.previousSibling;while(e&&!vn(e));return e}function Ra(i,e,t,n){var r=i.tagName.toLowerCase(),s={tag_name:r};Qi.indexOf(r)>-1&&!t&&(r.toLowerCase()==="a"||r.toLowerCase()==="button"?s.$el_text=In(1024,Ns(i)):s.$el_text=In(1024,_n(i)));var o=Qt(i);o.length>0&&(s.classes=o.filter(function(c){return c!==""})),A(i.attributes,function(c){var h;if((!$s(i)||["name","id","class","aria-label"].indexOf(c.name)!==-1)&&(n==null||!n.includes(c.name))&&!e&&Ct(c.value)&&(h=c.name,!B(h)||h.substring(0,10)!=="_ngcontent"&&h.substring(0,7)!=="_nghost")){var d=c.value;c.name==="class"&&(d=Zi(d).join(" ")),s["attr__"+c.name]=In(1024,d)}});for(var a=1,l=1,u=i;u=Ta(u);)a++,u.tagName===i.tagName&&l++;return s.nth_child=a,s.nth_of_type=l,s}function Pa(i,e){for(var t,n,{e:r,maskAllElementAttributes:s,maskAllText:o,elementAttributeIgnoreList:a,elementsChainAsString:l}=e,u=[i],c=i;c.parentNode&&!Ne(c,"body");)Rs(c.parentNode)?(u.push(c.parentNode.host),c=c.parentNode.host):(u.push(c.parentNode),c=c.parentNode);var h,d=[],p={},g=!1,v=!1;if(A(u,C=>{var P=di(C);C.tagName.toLowerCase()==="a"&&(g=C.getAttribute("href"),g=P&&g&&Ct(g)&&g),R(Qt(C),"ph-no-capture")&&(v=!0),d.push(Ra(C,s,o,a));var z=function(q){if(!di(q))return{};var T={};return A(q.attributes,function(j){if(j.name&&j.name.indexOf("data-ph-capture-attribute")===0){var D=j.name.replace("data-ph-capture-attribute-",""),oe=j.value;D&&oe&&Ct(oe)&&(T[D]=oe)}}),T}(C);N(p,z)}),v)return{props:{},explicitNoCapture:v};if(o||(i.tagName.toLowerCase()==="a"||i.tagName.toLowerCase()==="button"?d[0].$el_text=Ns(i):d[0].$el_text=_n(i)),g){var _,E;d[0].attr__href=g;var x=(_=tn(g))==null?void 0:_.host,b=f==null||(E=f.location)==null?void 0:E.host;x&&b&&x!==b&&(h=g)}return{props:N({$event_type:r.type,$ce_version:1},l?{}:{$elements:d},{$elements_chain:Sa(d)},(t=d[0])!=null&&t.$el_text?{$el_text:(n=d[0])==null?void 0:n.$el_text}:{},h&&r.type==="click"?{$external_click_url:h}:{},p)}}var hi=class{constructor(e){this.P=!1,this.T=null,this.rageclicks=new en,this.R=!1,this.instance=e,this.I=null}get C(){var e,t,n=G(this.instance.config.autocapture)?this.instance.config.autocapture:{};return n.url_allowlist=(e=n.url_allowlist)==null?void 0:e.map(r=>new RegExp(r)),n.url_ignorelist=(t=n.url_ignorelist)==null?void 0:t.map(r=>new RegExp(r)),n}O(){if(this.isBrowserSupported()){if(f&&y){var e=n=>{n=n||f?.event;try{this.F(n)}catch(r){zr.error("Failed to capture event",r)}};if(M(y,"submit",e,{capture:!0}),M(y,"change",e,{capture:!0}),M(y,"click",e,{capture:!0}),this.C.capture_copied_text){var t=n=>{n=n||f?.event,this.F(n,Pn)};M(y,"copy",t,{capture:!0}),M(y,"cut",t,{capture:!0})}}}else zr.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.P&&(this.O(),this.P=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.R=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[Or]:!!e.autocapture_opt_out}),this.T=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.I=e}getElementSelectors(e){var t,n=[];return(t=this.I)==null||t.forEach(r=>{var s=y?.querySelectorAll(r);s?.forEach(o=>{e===o&&n.push(r)})}),n}get isEnabled(){var e,t,n=(e=this.instance.persistence)==null?void 0:e.props[Or],r=this.T;if(we(r)&&!Le(n)&&!this.instance.M())return!1;var s=(t=this.T)!==null&&t!==void 0?t:!!n;return!!this.instance.config.autocapture&&!s}F(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var n,r=Is(e);Ts(r)&&(r=r.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&function(d,p){if(!f||er(d))return!1;var g,v;if((g=Le(p)?!!p&&jr:(v=p?.css_selector_ignorelist)!==null&&v!==void 0?v:jr)===!1)return!1;var{targetElementList:_}=Fs(d,!1);return!As(_,g)}(r,this.instance.config.rageclick)&&this.F(e,"$rageclick");var s=t===Pn;if(r&&ya(r,e,this.C,s,s?["copy","cut"]:void 0)){var{props:o,explicitNoCapture:a}=Pa(r,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.C.element_attribute_ignorelist,elementsChainAsString:this.R});if(a)return!1;var l=this.getElementSelectors(r);if(l&&l.length>0&&(o.$element_selectors=l),t===Pn){var u,c=Ps(f==null||(u=f.getSelection())==null?void 0:u.toString()),h=e.type||"clipboard";if(!c)return!1;o.$selected_content=c,o.$copy_type=h}return this.instance.capture(t,o),!0}}}isBrowserSupported(){return $e(y?.querySelectorAll)}};Math.trunc||(Math.trunc=function(i){return i<0?Math.ceil(i):Math.floor(i)}),Number.isInteger||(Number.isInteger=function(i){return ge(i)&&isFinite(i)&&Math.floor(i)===i});var Ur="0123456789abcdef",pi=class i{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,n,r){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(r)||e<0||t<0||n<0||r<0||e>0xffffffffffff||t>4095||n>1073741823||r>4294967295)throw new RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=e/Math.pow(2,40),s[1]=e/Math.pow(2,32),s[2]=e/Math.pow(2,24),s[3]=e/Math.pow(2,16),s[4]=e/Math.pow(2,8),s[5]=e,s[6]=112|t>>>8,s[7]=t,s[8]=128|n>>>24,s[9]=n>>>16,s[10]=n>>>8,s[11]=n,s[12]=r>>>24,s[13]=r>>>16,s[14]=r>>>8,s[15]=r,new i(s)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+Ur.charAt(this.bytes[t]>>>4)+Ur.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new i(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(n!==0)return Math.sign(n)}return 0}},gi=class{constructor(){this.A=0,this.D=0,this.j=new fi}generate(){var e=this.generateOrAbort();if(m(e)){this.A=0;var t=this.generateOrAbort();if(m(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.A)this.A=e,this.L();else{if(!(e+1e4>this.A))return;this.D++,this.D>4398046511103&&(this.A++,this.L())}return pi.fromFieldsV7(this.A,Math.trunc(this.D/Math.pow(2,30)),this.D&Math.pow(2,30)-1,this.j.nextUint32())}L(){this.D=1024*this.j.nextUint32()+(1023&this.j.nextUint32())}},qr,js=i=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<i.length;e++)i[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return i};f&&!m(f.crypto)&&crypto.getRandomValues&&(js=i=>crypto.getRandomValues(i));var fi=class{constructor(){this.N=new Uint32Array(8),this.U=1/0}nextUint32(){return this.U>=this.N.length&&(js(this.N),this.U=0),this.N[this.U++]}},Fe=()=>Ia().toString(),Ia=()=>(qr||(qr=new gi)).generate(),ct="",Aa=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Oa(i,e){if(e){var t=function(r,s){if(s===void 0&&(s=y),ct)return ct;if(!s||["localhost","127.0.0.1"].includes(r))return"";for(var o=r.split("."),a=Math.min(o.length,8),l="dmn_chk_"+Fe();!ct&&a--;){var u=o.slice(a).join("."),c=l+"=1;domain=."+u+";path=/";s.cookie=c+";max-age=3",s.cookie.includes(l)&&(s.cookie=c+";max-age=0",ct=u)}return ct}(i);if(!t){var n=(r=>{var s=r.match(Aa);return s?s[0]:""})(i);n!==t&&w.info("Warning: cookie subdomain discovery mismatch",n,t),t=n}return t?"; domain=."+t:""}return""}var pe={H:()=>!!y,B:function(i){w.error("cookieStore error: "+i)},q:function(i){if(y){try{for(var e=i+"=",t=y.cookie.split(";").filter(s=>s.length),n=0;n<t.length;n++){for(var r=t[n];r.charAt(0)==" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return decodeURIComponent(r.substring(e.length,r.length))}}catch{}return null}},W:function(i){var e;try{e=JSON.parse(pe.q(i))||{}}catch{}return e},G:function(i,e,t,n,r){if(y)try{var s="",o="",a=Oa(y.location.hostname,n);if(t){var l=new Date;l.setTime(l.getTime()+24*t*60*60*1e3),s="; expires="+l.toUTCString()}r&&(o="; secure");var u=i+"="+encodeURIComponent(JSON.stringify(e))+s+"; SameSite=Lax; path=/"+a+o;return u.length>3686.4&&w.warn("cookieStore warning: large cookie, len="+u.length),y.cookie=u,u}catch{return}},V:function(i,e){if(y!=null&&y.cookie)try{pe.G(i,"",-1,e)}catch{return}}},An=null,L={H:function(){if(!we(An))return An;var i=!0;if(m(f))i=!1;else try{var e="__mplssupport__";L.G(e,"xyz"),L.q(e)!=='"xyz"'&&(i=!1),L.V(e)}catch{i=!1}return i||w.error("localStorage unsupported; falling back to cookie store"),An=i,i},B:function(i){w.error("localStorage error: "+i)},q:function(i){try{return f?.localStorage.getItem(i)}catch(e){L.B(e)}return null},W:function(i){try{return JSON.parse(L.q(i))||{}}catch{}return null},G:function(i,e){try{f?.localStorage.setItem(i,JSON.stringify(e))}catch(t){L.B(t)}},V:function(i){try{f?.localStorage.removeItem(i)}catch(e){L.B(e)}}},Fa=["distinct_id",Yt,Cs,Zt,Jt],jt=k({},L,{W:function(i){try{var e={};try{e=pe.W(i)||{}}catch{}var t=N(e,JSON.parse(L.q(i)||"{}"));return L.G(i,t),t}catch{}return null},G:function(i,e,t,n,r,s){try{L.G(i,e,void 0,void 0,s);var o={};Fa.forEach(a=>{e[a]&&(o[a]=e[a])}),Object.keys(o).length&&pe.G(i,o,t,n,r,s)}catch(a){L.B(a)}},V:function(i,e){try{f?.localStorage.removeItem(i),pe.V(i,e)}catch(t){L.B(t)}}}),Bt={},$a={H:function(){return!0},B:function(i){w.error("memoryStorage error: "+i)},q:function(i){return Bt[i]||null},W:function(i){return Bt[i]||null},G:function(i,e){Bt[i]=e},V:function(i){delete Bt[i]}},je=null,H={H:function(){if(!we(je))return je;if(je=!0,m(f))je=!1;else try{var i="__support__";H.G(i,"xyz"),H.q(i)!=='"xyz"'&&(je=!1),H.V(i)}catch{je=!1}return je},B:function(i){w.error("sessionStorage error: ",i)},q:function(i){try{return f?.sessionStorage.getItem(i)}catch(e){H.B(e)}return null},W:function(i){try{return JSON.parse(H.q(i))||null}catch{}return null},G:function(i,e){try{f?.sessionStorage.setItem(i,JSON.stringify(e))}catch(t){H.B(t)}},V:function(i){try{f?.sessionStorage.removeItem(i)}catch(e){H.B(e)}}},ye=function(i){return i[i.PENDING=-1]="PENDING",i[i.DENIED=0]="DENIED",i[i.GRANTED=1]="GRANTED",i}({}),vi=class{constructor(e){this._instance=e}get C(){return this._instance.config}get consent(){return this.J()?ye.DENIED:this.K}isOptedOut(){return this.C.cookieless_mode==="always"||this.consent===ye.DENIED||this.consent===ye.PENDING&&(this.C.opt_out_capturing_by_default||this.C.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===ye.DENIED}optInOut(e){this.Y.G(this.X,e?1:0,this.C.cookie_expiration,this.C.cross_subdomain_cookie,this.C.secure_cookie)}reset(){this.Y.V(this.X,this.C.cross_subdomain_cookie)}get X(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:n}=this._instance.config;return n||(t?t+e:"__ph_opt_in_out_"+e)}get K(){var e=this.Y.q(this.X);return xn(e)?ye.GRANTED:R(ea,e)?ye.DENIED:ye.PENDING}get Y(){if(!this.Z){var e=this.C.opt_out_capturing_persistence_type;this.Z=e==="localStorage"?L:pe;var t=e==="localStorage"?pe:L;t.q(this.X)&&(this.Z.q(this.X)||this.optInOut(xn(t.q(this.X))),t.V(this.X,this.C.cross_subdomain_cookie))}return this.Z}J(){return!!this.C.respect_dnt&&!!ks([ee?.doNotTrack,ee?.msDoNotTrack,S.doNotTrack],e=>xn(e))}},zt=U("[Dead Clicks]"),La=()=>!0,Da=i=>{var e,t=!((e=i.instance.persistence)==null||!e.get_property(Ss)),n=i.instance.config.capture_dead_clicks;return Le(n)?n:t},sn=class{get lazyLoadedDeadClicksAutocapture(){return this.tt}constructor(e,t,n){this.instance=e,this.isEnabled=t,this.onCapture=n,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[Ss]:e?.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.it(()=>{this.et()})}it(e){var t,n;(t=S.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(n=S.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"dead-clicks-autocapture",r=>{r?zt.error("failed to load script",r):e()})}et(){var e;if(y){if(!this.tt&&(e=S.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=G(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.tt=S.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.tt.start(y),zt.info("starting...")}}else zt.error("`document` not found. Cannot start.")}stop(){this.tt&&(this.tt.stop(),this.tt=void 0,zt.info("stopping..."))}},ut=U("[ExceptionAutocapture]"),_i=class{constructor(e){var t,n,r;this.rt=()=>{var s;if(f&&this.isEnabled&&(s=S.__PosthogExtensions__)!=null&&s.errorWrappingFunctions){var o=S.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,a=S.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,l=S.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.st&&this.C.capture_unhandled_errors&&(this.st=o(this.captureException.bind(this))),!this.nt&&this.C.capture_unhandled_rejections&&(this.nt=a(this.captureException.bind(this))),!this.ot&&this.C.capture_console_errors&&(this.ot=l(this.captureException.bind(this)))}catch(u){ut.error("failed to start",u),this.lt()}}},this._instance=e,this.ut=!((t=this._instance.persistence)==null||!t.props[Fr]),this.C=this.ht(),this.dt=new Wn({refillRate:(n=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&n!==void 0?n:1,bucketSize:(r=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&r!==void 0?r:10,refillInterval:1e4,h:ut}),this.startIfEnabled()}ht(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return G(e)?t=k({},t,e):(m(e)?this.ut:e)&&(t=k({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.C.capture_console_errors||this.C.capture_unhandled_errors||this.C.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(ut.info("enabled"),this.it(this.rt))}it(e){var t,n;(t=S.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(n=S.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"exception-autocapture",r=>{if(r)return ut.error("failed to load script",r);e()})}lt(){var e,t,n;(e=this.st)==null||e.call(this),this.st=void 0,(t=this.nt)==null||t.call(this),this.nt=void 0,(n=this.ot)==null||n.call(this),this.ot=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ut=!!t||!1,this.C=this.ht(),this._instance.persistence&&this._instance.persistence.register({[Fr]:this.ut}),this.startIfEnabled()}captureException(e){var t,n,r=(t=e==null||(n=e.$exception_list)==null||(n=n[0])==null?void 0:n.type)!==null&&t!==void 0?t:"Exception";this.dt.consumeRateLimit(r)?ut.info("Skipping exception capture because of client rate limiting.",{exception:r}):this._instance.exceptions.sendExceptionEvent(e)}};function Hr(i,e,t){try{if(!(e in i))return()=>{};var n=i[e],r=t(n);return $e(r)&&(r.prototype=r.prototype||{},Object.defineProperties(r,{__posthog_wrapped__:{enumerable:!1,value:!0}})),i[e]=r,()=>{i[e]=n}}catch{return()=>{}}}var mi=class{constructor(e){var t;this._instance=e,this.vt=(f==null||(t=f.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(w.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.ct&&this.ct(),this.ct=void 0,w.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(f&&f.history){var n=this;(e=f.history.pushState)!=null&&e.__posthog_wrapped__||Hr(f.history,"pushState",r=>function(s,o,a){r.call(this,s,o,a),n.ft("pushState")}),(t=f.history.replaceState)!=null&&t.__posthog_wrapped__||Hr(f.history,"replaceState",r=>function(s,o,a){r.call(this,s,o,a),n.ft("replaceState")}),this.gt()}}ft(e){try{var t,n=f==null||(t=f.location)==null?void 0:t.pathname;if(!n)return;n!==this.vt&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.vt=n}catch(r){w.error("Error capturing "+e+" pageview",r)}}gt(){if(!this.ct){var e=()=>{this.ft("popstate")};M(f,"popstate",e),this.ct=()=>{f&&f.removeEventListener("popstate",e)}}}},On=U("[SegmentIntegration]");function Na(i,e){var t=i.config.segment;if(!t)return e();(function(n,r){var s=n.config.segment;if(!s)return r();var o=l=>{var u=()=>l.anonymousId()||Fe();n.config.get_device_id=u,l.id()&&(n.register({distinct_id:l.id(),$device_id:u()}),n.persistence.set_property(me,"identified")),r()},a=s.user();"then"in a&&$e(a.then)?a.then(l=>o(l)):o(a)})(i,()=>{t.register((n=>{Promise&&Promise.resolve||On.warn("This browser does not have Promise support, and can not use the segment integration");var r=(s,o)=>{if(!o)return s;s.event.userId||s.event.anonymousId===n.get_distinct_id()||(On.info("No userId set, resetting PostHog"),n.reset()),s.event.userId&&s.event.userId!==n.get_distinct_id()&&(On.info("UserId set, identifying with PostHog"),n.identify(s.event.userId));var a=n.calculateEventProperties(o,s.event.properties);return s.event.properties=Object.assign({},a,s.event.properties),s};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:s=>r(s,s.event.event),page:s=>r(s,"$pageview"),identify:s=>r(s,"$identify"),screen:s=>r(s,"$screen")}})(i)).then(()=>{e()})})}var Bs="posthog-js";function zs(i,e){var{organization:t,projectId:n,prefix:r,severityAllowList:s=["error"],sendExceptionsToPostHog:o=!0}=e===void 0?{}:e;return a=>{var l,u,c,h,d;if(!(s==="*"||s.includes(a.level))||!i.__loaded)return a;a.tags||(a.tags={});var p=i.requestRouter.endpointFor("ui","/project/"+i.config.token+"/person/"+i.get_distinct_id());a.tags["PostHog Person URL"]=p,i.sessionRecordingStarted()&&(a.tags["PostHog Recording URL"]=i.get_session_replay_url({withTimestamp:!0}));var g=((l=a.exception)==null?void 0:l.values)||[],v=g.map(E=>k({},E,{stacktrace:E.stacktrace?k({},E.stacktrace,{type:"raw",frames:(E.stacktrace.frames||[]).map(x=>k({},x,{platform:"web:javascript"}))}):void 0})),_={$exception_message:((u=g[0])==null?void 0:u.value)||a.message,$exception_type:(c=g[0])==null?void 0:c.type,$exception_level:a.level,$exception_list:v,$sentry_event_id:a.event_id,$sentry_exception:a.exception,$sentry_exception_message:((h=g[0])==null?void 0:h.value)||a.message,$sentry_exception_type:(d=g[0])==null?void 0:d.type,$sentry_tags:a.tags};return t&&n&&(_.$sentry_url=(r||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+a.event_id),o&&i.exceptions.sendExceptionEvent(_),a}}var yi=class{constructor(e,t,n,r,s,o){this.name=Bs,this.setupOnce=function(a){a(zs(e,{organization:t,projectId:n,prefix:r,severityAllowList:s,sendExceptionsToPostHog:o==null||o}))}}},Ma=f!=null&&f.location?rn(f.location.hash,"__posthog")||rn(location.hash,"state"):null,Gr="_postHogToolbarParams",Wr=U("[Toolbar]"),Oe=function(i){return i[i.UNINITIALIZED=0]="UNINITIALIZED",i[i.LOADING=1]="LOADING",i[i.LOADED=2]="LOADED",i}(Oe||{}),bi=class{constructor(e){this.instance=e}_t(e){S.ph_toolbar_state=e}yt(){var e;return(e=S.ph_toolbar_state)!==null&&e!==void 0?e:Oe.UNINITIALIZED}maybeLoadToolbar(e,t,n){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),!f||!y)return!1;e=e??f.location,n=n??f.history;try{if(!t){try{f.localStorage.setItem("test","test"),f.localStorage.removeItem("test")}catch{return!1}t=f?.localStorage}var r,s=Ma||rn(e.hash,"__posthog")||rn(e.hash,"state"),o=s?Ar(()=>JSON.parse(atob(decodeURIComponent(s))))||Ar(()=>JSON.parse(decodeURIComponent(s))):null;return o&&o.action==="ph_authorize"?((r=o).source="url",r&&Object.keys(r).length>0&&(o.desiredHash?e.hash=o.desiredHash:n?n.replaceState(n.state,"",e.pathname+e.search):e.hash="")):((r=JSON.parse(t.getItem(Gr)||"{}")).source="localstorage",delete r.userIntent),!(!r.token||this.instance.config.token!==r.token)&&(this.loadToolbar(r),!0)}catch{return!1}}bt(e){var t=S.ph_load_toolbar||S.ph_load_editor;!F(t)&&$e(t)?t(e,this.instance):Wr.warn("No toolbar load function found")}loadToolbar(e){var t=!(y==null||!y.getElementById(xs));if(!f||t)return!1;var n=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,r=k({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(f.localStorage.setItem(Gr,JSON.stringify(k({},r,{source:void 0}))),this.yt()===Oe.LOADED)this.bt(r);else if(this.yt()===Oe.UNINITIALIZED){var s;this._t(Oe.LOADING),(s=S.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this.instance,"toolbar",o=>{if(o)return Wr.error("[Toolbar] Failed to load",o),void this._t(Oe.UNINITIALIZED);this._t(Oe.LOADED),this.bt(r)}),M(f,"turbolinks:load",()=>{this._t(Oe.UNINITIALIZED),this.loadToolbar(r)})}return!0}wt(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,n){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),this.maybeLoadToolbar(e,t,n)}},ja=U("[TracingHeaders]"),wi=class{constructor(e){this.xt=void 0,this.$t=void 0,this.rt=()=>{var t,n;m(this.xt)&&((t=S.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),m(this.$t)&&((n=S.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}it(e){var t,n;(t=S.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(n=S.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"tracing-headers",r=>{if(r)return ja.error("failed to load script",r);e()})}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.it(this.rt):((e=this.xt)==null||e.call(this),(t=this.$t)==null||t.call(this),this.xt=void 0,this.$t=void 0)}},re="Mobile",on="iOS",he="Android",xt="Tablet",Us=he+" "+xt,qs="iPad",Hs="Apple",Gs=Hs+" Watch",Tt="Safari",et="BlackBerry",Ws="Samsung",Vs=Ws+"Browser",Xs=Ws+" Internet",Ue="Chrome",Ba=Ue+" OS",Ys=Ue+" "+on,tr="Internet Explorer",Ks=tr+" "+re,nr="Opera",za=nr+" Mini",ir="Edge",Js="Microsoft "+ir,Je="Firefox",Zs=Je+" "+on,Rt="Nintendo",Pt="PlayStation",Ze="Xbox",Qs=he+" "+re,eo=re+" "+Tt,yt="Windows",ki=yt+" Phone",Vr="Nokia",Ei="Ouya",to="Generic",Ua=to+" "+re.toLowerCase(),no=to+" "+xt.toLowerCase(),Si="Konqueror",V="(\\d+(\\.\\d+)?)",Fn=new RegExp("Version/"+V),qa=new RegExp(Ze,"i"),Ha=new RegExp(Pt+" \\w+","i"),Ga=new RegExp(Rt+" \\w+","i"),rr=new RegExp(et+"|PlayBook|BB10","i"),Wa={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Va=(i,e)=>e&&R(e,Hs)||function(t){return R(t,Tt)&&!R(t,Ue)&&!R(t,he)}(i),io=function(i,e){return e=e||"",R(i," OPR/")&&R(i,"Mini")?za:R(i," OPR/")?nr:rr.test(i)?et:R(i,"IE"+re)||R(i,"WPDesktop")?Ks:R(i,Vs)?Xs:R(i,ir)||R(i,"Edg/")?Js:R(i,"FBIOS")?"Facebook "+re:R(i,"UCWEB")||R(i,"UCBrowser")?"UC Browser":R(i,"CriOS")?Ys:R(i,"CrMo")||R(i,Ue)?Ue:R(i,he)&&R(i,Tt)?Qs:R(i,"FxiOS")?Zs:R(i.toLowerCase(),Si.toLowerCase())?Si:Va(i,e)?R(i,re)?eo:Tt:R(i,Je)?Je:R(i,"MSIE")||R(i,"Trident/")?tr:R(i,"Gecko")?Je:""},Xa={[Ks]:[new RegExp("rv:"+V)],[Js]:[new RegExp(ir+"?\\/"+V)],[Ue]:[new RegExp("("+Ue+"|CrMo)\\/"+V)],[Ys]:[new RegExp("CriOS\\/"+V)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+V)],[Tt]:[Fn],[eo]:[Fn],[nr]:[new RegExp("(Opera|OPR)\\/"+V)],[Je]:[new RegExp(Je+"\\/"+V)],[Zs]:[new RegExp("FxiOS\\/"+V)],[Si]:[new RegExp("Konqueror[:/]?"+V,"i")],[et]:[new RegExp(et+" "+V),Fn],[Qs]:[new RegExp("android\\s"+V,"i")],[Xs]:[new RegExp(Vs+"\\/"+V)],[tr]:[new RegExp("(rv:|MSIE )"+V)],Mozilla:[new RegExp("rv:"+V)]},Ya=function(i,e){var t=io(i,e),n=Xa[t];if(m(n))return null;for(var r=0;r<n.length;r++){var s=n[r],o=i.match(s);if(o)return parseFloat(o[o.length-2])}return null},Xr=[[new RegExp(Ze+"; "+Ze+" (.*?)[);]","i"),i=>[Ze,i&&i[1]||""]],[new RegExp(Rt,"i"),[Rt,""]],[new RegExp(Pt,"i"),[Pt,""]],[rr,[et,""]],[new RegExp(yt,"i"),(i,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[ki,""];if(new RegExp(re).test(e)&&!/IEMobile\b/.test(e))return[yt+" "+re,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var n=t[1],r=Wa[n]||"";return/arm/i.test(e)&&(r="RT"),[yt,r]}return[yt,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,i=>{if(i&&i[3]){var e=[i[3],i[4],i[5]||"0"];return[on,e.join(".")]}return[on,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,i=>{var e="";return i&&i.length>=3&&(e=m(i[2])?i[3]:i[2]),["watchOS",e]}],[new RegExp("("+he+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+he+")","i"),i=>{if(i&&i[2]){var e=[i[2],i[3],i[4]||"0"];return[he,e.join(".")]}return[he,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,i=>{var e=["Mac OS X",""];if(i&&i[1]){var t=[i[1],i[2],i[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[Ba,""]],[/Linux|debian/i,["Linux",""]]],Yr=function(i){return Ga.test(i)?Rt:Ha.test(i)?Pt:qa.test(i)?Ze:new RegExp(Ei,"i").test(i)?Ei:new RegExp("("+ki+"|WPDesktop)","i").test(i)?ki:/iPad/.test(i)?qs:/iPod/.test(i)?"iPod Touch":/iPhone/.test(i)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(i)?Gs:rr.test(i)?et:/(kobo)\s(ereader|touch)/i.test(i)?"Kobo":new RegExp(Vr,"i").test(i)?Vr:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(i)||/(kf[a-z]+)( bui|\)).+silk\//i.test(i)?"Kindle Fire":/(Android|ZTE)/i.test(i)?!new RegExp(re).test(i)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(i)?/pixel[\daxl ]{1,6}/i.test(i)&&!/pixel c/i.test(i)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(i)||/lmy47v/i.test(i)&&!/QTAQZ3/i.test(i)?he:Us:he:new RegExp("(pda|"+re+")","i").test(i)?Ua:new RegExp(xt,"i").test(i)&&!new RegExp(xt+" pc","i").test(i)?no:""},Ut="https?://(.*)",rt=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Ka=it(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],rt),Ot="<masked>",Ja=["li_fat_id"];function ro(i,e,t){if(!y)return{};var n,r=e?it([],rt,t||[]):[],s=so(At(y.URL,r,Ot),i),o=(n={},A(Ja,function(a){var l=pe.q(a);n[a]=l||null}),n);return N(o,s)}function so(i,e){var t=Ka.concat(e||[]),n={};return A(t,function(r){var s=nn(i,r);n[r]=s||null}),n}function oo(i){var e=function(s){return s?s.search(Ut+"google.([^/?]*)")===0?"google":s.search(Ut+"bing.com")===0?"bing":s.search(Ut+"yahoo.com")===0?"yahoo":s.search(Ut+"duckduckgo.com")===0?"duckduckgo":null:null}(i),t=e!="yahoo"?"q":"p",n={};if(!we(e)){n.$search_engine=e;var r=y?nn(y.referrer,t):"";r.length&&(n.ph_keyword=r)}return n}function Kr(){return navigator.language||navigator.userLanguage}function ao(){return y?.referrer||"$direct"}function lo(i,e){var t=i?it([],rt,e||[]):[],n=K?.href.substring(0,1e3);return{r:ao().substring(0,1e3),u:n?At(n,t,Ot):void 0}}function co(i){var e,{r:t,u:n}=i,r={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=tn(t))==null?void 0:e.host};if(n){r.$current_url=n;var s=tn(n);r.$host=s?.host,r.$pathname=s?.pathname;var o=so(n);N(r,o)}if(t){var a=oo(t);N(r,a)}return r}function uo(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function Za(){try{return new Date().getTimezoneOffset()}catch{return}}function Qa(i,e){if(!Y)return{};var t,n,r,s=i?it([],rt,e||[]):[],[o,a]=function(l){for(var u=0;u<Xr.length;u++){var[c,h]=Xr[u],d=c.exec(l),p=d&&($e(h)?h(d,l):h);if(p)return p}return["",""]}(Y);return N(Ji({$os:o,$os_version:a,$browser:io(Y,navigator.vendor),$device:Yr(Y),$device_type:(n=Y,r=Yr(n),r===qs||r===Us||r==="Kobo"||r==="Kindle Fire"||r===no?xt:r===Rt||r===Ze||r===Pt||r===Ei?"Console":r===Gs?"Wearable":r?re:"Desktop"),$timezone:uo(),$timezone_offset:Za()}),{$current_url:At(K?.href,s,Ot),$host:K?.host,$pathname:K?.pathname,$raw_user_agent:Y.length>1e3?Y.substring(0,997)+"...":Y,$browser_version:Ya(Y,navigator.vendor),$browser_language:Kr(),$browser_language_prefix:(t=Kr(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:f?.screen.height,$screen_width:f?.screen.width,$viewport_height:f?.innerHeight,$viewport_width:f?.innerWidth,$lib:"web",$lib_version:_e.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Pe=U("[Web Vitals]"),Jr=9e5,Ci=class{constructor(e){var t;this.St=!1,this.P=!1,this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Et=()=>{clearTimeout(this.kt),this.N.metrics.length!==0&&(this._instance.capture("$web_vitals",this.N.metrics.reduce((n,r)=>k({},n,{["$web_vitals_"+r.name+"_event"]:k({},r),["$web_vitals_"+r.name+"_value"]:r.value}),{})),this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.Pt=n=>{var r,s=(r=this._instance.sessionManager)==null?void 0:r.checkAndGetSessionAndWindowId(!0);if(m(s))Pe.error("Could not read session ID. Dropping metrics!");else{this.N=this.N||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var o=this.Tt();m(o)||(F(n?.name)||F(n?.value)?Pe.error("Invalid metric received",n):this.Rt&&n.value>=this.Rt?Pe.error("Ignoring metric with value >= "+this.Rt,n):(this.N.url!==o&&(this.Et(),this.kt=setTimeout(this.Et,this.flushToCaptureTimeoutMs)),m(this.N.url)&&(this.N.url=o),this.N.firstMetricTimestamp=m(this.N.firstMetricTimestamp)?Date.now():this.N.firstMetricTimestamp,n.attribution&&n.attribution.interactionTargetElement&&(n.attribution.interactionTargetElement=void 0),this.N.metrics.push(k({},n,{$current_url:o,$session_id:s.sessionId,$window_id:s.windowId,timestamp:Date.now()})),this.N.metrics.length===this.allowedMetrics.length&&this.Et()))}},this.rt=()=>{var n,r,s,o,a=S.__PosthogExtensions__;m(a)||m(a.postHogWebVitalsCallbacks)||({onLCP:n,onCLS:r,onFCP:s,onINP:o}=a.postHogWebVitalsCallbacks),n&&r&&s&&o?(this.allowedMetrics.indexOf("LCP")>-1&&n(this.Pt.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&r(this.Pt.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&s(this.Pt.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&o(this.Pt.bind(this)),this.P=!0):Pe.error("web vitals callbacks not loaded - not starting")},this._instance=e,this.St=!((t=this._instance.persistence)==null||!t.props[Lr]),this.startIfEnabled()}get allowedMetrics(){var e,t,n=G(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return m(n)?((t=this._instance.persistence)==null?void 0:t.props[Dr])||["CLS","FCP","INP","LCP"]:n}get flushToCaptureTimeoutMs(){return(G(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get Rt(){var e=G(this._instance.config.capture_performance)&&ge(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:Jr;return 0<e&&e<=6e4?Jr:e}get isEnabled(){var e=K?.protocol;if(e!=="http:"&&e!=="https:")return Pe.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=G(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Le(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Le(t)?t:this.St}startIfEnabled(){this.isEnabled&&!this.P&&(Pe.info("enabled, starting..."),this.it(this.rt))}onRemoteConfig(e){var t=G(e.capturePerformance)&&!!e.capturePerformance.web_vitals,n=G(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[Lr]:t}),this._instance.persistence.register({[Dr]:n})),this.St=t,this.startIfEnabled()}it(e){var t,n;(t=S.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks&&e(),(n=S.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"web-vitals",r=>{r?Pe.error("failed to load script",r):e()})}Tt(){var e=f?f.location.href:void 0;if(e){var t=this._instance.config.mask_personal_data_properties,n=this._instance.config.custom_personal_data_properties,r=t?it([],rt,n||[]):[];return At(e,r,Ot)}Pe.error("Could not determine current URL")}},el=U("[Heatmaps]");function Zr(i){return G(i)&&"clientX"in i&&"clientY"in i&&ge(i.clientX)&&ge(i.clientY)}var xi=class{constructor(e){var t;this.rageclicks=new en,this.St=!1,this.P=!1,this.It=null,this.instance=e,this.St=!((t=this.instance.persistence)==null||!t.props[ii])}get flushIntervalMilliseconds(){var e=5e3;return G(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return m(this.instance.config.capture_heatmaps)?m(this.instance.config.enable_heatmaps)?this.St:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.P)return;el.info("starting..."),this.Ct(),this.Ot()}else{var e;clearInterval((e=this.It)!==null&&e!==void 0?e:void 0),this.Ft(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[ii]:t}),this.St=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.N;return this.N=void 0,e}Mt(e){this.At(e.originalEvent,"deadclick")}Ot(){this.It&&clearInterval(this.It),this.It=function(e){return e?.visibilityState==="visible"}(y)?setInterval(this.Dt.bind(this),this.flushIntervalMilliseconds):null}Ct(){f&&y&&(this.jt=this.Dt.bind(this),M(f,"beforeunload",this.jt),this.Lt=e=>this.At(e||f?.event),M(y,"click",this.Lt,{capture:!0}),this.Nt=e=>this.Ut(e||f?.event),M(y,"mousemove",this.Nt,{capture:!0}),this.Ht=new sn(this.instance,La,this.Mt.bind(this)),this.Ht.startIfEnabled(),this.zt=this.Ot.bind(this),M(y,"visibilitychange",this.zt),this.P=!0)}Ft(){var e;f&&y&&(this.jt&&f.removeEventListener("beforeunload",this.jt),this.Lt&&y.removeEventListener("click",this.Lt,{capture:!0}),this.Nt&&y.removeEventListener("mousemove",this.Nt,{capture:!0}),this.zt&&y.removeEventListener("visibilitychange",this.zt),clearTimeout(this.Bt),(e=this.Ht)==null||e.stop(),this.P=!1)}qt(e,t){var n=this.instance.scrollManager.scrollY(),r=this.instance.scrollManager.scrollX(),s=this.instance.scrollManager.scrollElement(),o=function(a,l,u){for(var c=a;c&&vn(c)&&!Ne(c,"body");){if(c===u)return!1;if(R(l,f?.getComputedStyle(c).position))return!0;c=Os(c)}return!1}(Is(e),["fixed","sticky"],s);return{x:e.clientX+(o?0:r),y:e.clientY+(o?0:n),target_fixed:o,type:t}}At(e,t){var n;if(t===void 0&&(t="click"),!Nr(e.target)&&Zr(e)){var r=this.qt(e,t);(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.Wt(k({},r,{type:"rageclick"})),this.Wt(r)}}Ut(e){!Nr(e.target)&&Zr(e)&&(clearTimeout(this.Bt),this.Bt=setTimeout(()=>{this.Wt(this.qt(e,"mousemove"))},500))}Wt(e){if(f){var t=f.location.href,n=this.instance.config.mask_personal_data_properties,r=this.instance.config.custom_personal_data_properties,s=n?it([],rt,r||[]):[],o=At(t,s,Ot);this.N=this.N||{},this.N[o]||(this.N[o]=[]),this.N[o].push(e)}}Dt(){this.N&&!Ye(this.N)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}},Ti=class{constructor(e){this._instance=e}doPageView(e,t){var n,r=this.Gt(e,t);return this.Vt={pathname:(n=f?.location.pathname)!==null&&n!==void 0?n:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),r}doPageLeave(e){var t;return this.Gt(e,(t=this.Vt)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.Vt)==null?void 0:e.pageViewId}}Gt(e,t){var n=this.Vt;if(!n)return{$pageview_id:t};var r={$pageview_id:t,$prev_pageview_id:n.pageViewId},s=this._instance.scrollManager.getContext();if(s&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:o,lastScrollY:a,maxScrollY:l,maxContentHeight:u,lastContentY:c,maxContentY:h}=s;if(!(m(o)||m(a)||m(l)||m(u)||m(c)||m(h))){o=Math.ceil(o),a=Math.ceil(a),l=Math.ceil(l),u=Math.ceil(u),c=Math.ceil(c),h=Math.ceil(h);var d=o<=1?1:de(a/o,0,1,w),p=o<=1?1:de(l/o,0,1,w),g=u<=1?1:de(c/u,0,1,w),v=u<=1?1:de(h/u,0,1,w);r=N(r,{$prev_pageview_last_scroll:a,$prev_pageview_last_scroll_percentage:d,$prev_pageview_max_scroll:l,$prev_pageview_max_scroll_percentage:p,$prev_pageview_last_content:c,$prev_pageview_last_content_percentage:g,$prev_pageview_max_content:h,$prev_pageview_max_content_percentage:v})}}return n.pathname&&(r.$prev_pageview_pathname=n.pathname),n.timestamp&&(r.$prev_pageview_duration=(e.getTime()-n.timestamp.getTime())/1e3),r}},se=Uint8Array,X=Uint16Array,tt=Uint32Array,sr=new se([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),or=new se([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Qr=new se([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ho=function(i,e){for(var t=new X(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];var r=new tt(t[30]);for(n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},po=ho(sr,2),tl=po[0],Ri=po[1];tl[28]=258,Ri[258]=28;for(Pi=ho(or,0)[1],an=new X(32768),O=0;O<32768;++O)Ie=(43690&O)>>>1|(21845&O)<<1,Ie=(61680&(Ie=(52428&Ie)>>>2|(13107&Ie)<<2))>>>4|(3855&Ie)<<4,an[O]=((65280&Ie)>>>8|(255&Ie)<<8)>>>1;var Ie,Pi,an,O,kt=function(i,e,t){for(var n=i.length,r=0,s=new X(e);r<n;++r)++s[i[r]-1];var o,a=new X(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;if(t){o=new X(1<<e);var l=15-e;for(r=0;r<n;++r)if(i[r])for(var u=r<<4|i[r],c=e-i[r],h=a[i[r]-1]++<<c,d=h|(1<<c)-1;h<=d;++h)o[an[h]>>>l]=u}else for(o=new X(n),r=0;r<n;++r)o[r]=an[a[i[r]-1]++]>>>15-i[r];return o},qe=new se(288);for(O=0;O<144;++O)qe[O]=8;for(O=144;O<256;++O)qe[O]=9;for(O=256;O<280;++O)qe[O]=7;for(O=280;O<288;++O)qe[O]=8;var ln=new se(32);for(O=0;O<32;++O)ln[O]=5;var nl=kt(qe,9,0),il=kt(ln,5,0),go=function(i){return(i/8>>0)+(7&i&&1)},fo=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof X?X:i instanceof tt?tt:se)(t-e);return n.set(i.subarray(e,t)),n},ve=function(i,e,t){t<<=7&e;var n=e/8>>0;i[n]|=t,i[n+1]|=t>>>8},dt=function(i,e,t){t<<=7&e;var n=e/8>>0;i[n]|=t,i[n+1]|=t>>>8,i[n+2]|=t>>>16},$n=function(i,e){for(var t=[],n=0;n<i.length;++n)i[n]&&t.push({s:n,f:i[n]});var r=t.length,s=t.slice();if(!r)return[new se(0),0];if(r==1){var o=new se(t[0].s+1);return o[t[0].s]=1,[o,1]}t.sort(function(P,z){return P.f-z.f}),t.push({s:-1,f:25001});var a=t[0],l=t[1],u=0,c=1,h=2;for(t[0]={s:-1,f:a.f+l.f,l:a,r:l};c!=r-1;)a=t[t[u].f<t[h].f?u++:h++],l=t[u!=c&&t[u].f<t[h].f?u++:h++],t[c++]={s:-1,f:a.f+l.f,l:a,r:l};var d=s[0].s;for(n=1;n<r;++n)s[n].s>d&&(d=s[n].s);var p=new X(d+1),g=Ii(t[c-1],p,0);if(g>e){n=0;var v=0,_=g-e,E=1<<_;for(s.sort(function(P,z){return p[z.s]-p[P.s]||P.f-z.f});n<r;++n){var x=s[n].s;if(!(p[x]>e))break;v+=E-(1<<g-p[x]),p[x]=e}for(v>>>=_;v>0;){var b=s[n].s;p[b]<e?v-=1<<e-p[b]++-1:++n}for(;n>=0&&v;--n){var C=s[n].s;p[C]==e&&(--p[C],++v)}g=e}return[new se(p),g]},Ii=function(i,e,t){return i.s==-1?Math.max(Ii(i.l,e,t+1),Ii(i.r,e,t+1)):e[i.s]=t},es=function(i){for(var e=i.length;e&&!i[--e];);for(var t=new X(++e),n=0,r=i[0],s=1,o=function(l){t[n++]=l},a=1;a<=e;++a)if(i[a]==r&&a!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(r),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(r);s=1,r=i[a]}return[t.subarray(0,n),e]},ht=function(i,e){for(var t=0,n=0;n<e.length;++n)t+=i[n]*e[n];return t},Ai=function(i,e,t){var n=t.length,r=go(e+2);i[r]=255&n,i[r+1]=n>>>8,i[r+2]=255^i[r],i[r+3]=255^i[r+1];for(var s=0;s<n;++s)i[r+s+4]=t[s];return 8*(r+4+n)},ts=function(i,e,t,n,r,s,o,a,l,u,c){ve(e,c++,t),++r[256];for(var h=$n(r,15),d=h[0],p=h[1],g=$n(s,15),v=g[0],_=g[1],E=es(d),x=E[0],b=E[1],C=es(v),P=C[0],z=C[1],q=new X(19),T=0;T<x.length;++T)q[31&x[T]]++;for(T=0;T<P.length;++T)q[31&P[T]]++;for(var j=$n(q,7),D=j[0],oe=j[1],ne=19;ne>4&&!D[Qr[ne-1]];--ne);var fe,le,ce,He,Se=u+5<<3,Me=ht(r,qe)+ht(s,ln)+o,ue=ht(r,d)+ht(s,v)+o+14+3*ne+ht(q,D)+(2*q[16]+3*q[17]+7*q[18]);if(Se<=Me&&Se<=ue)return Ai(e,c,i.subarray(l,l+u));if(ve(e,c,1+(ue<Me)),c+=2,ue<Me){fe=kt(d,p,0),le=d,ce=kt(v,_,0),He=v;var Ce=kt(D,oe,0);for(ve(e,c,b-257),ve(e,c+5,z-1),ve(e,c+10,ne-4),c+=14,T=0;T<ne;++T)ve(e,c+3*T,D[Qr[T]]);c+=3*ne;for(var Ge=[x,P],W=0;W<2;++W){var ie=Ge[W];for(T=0;T<ie.length;++T){var Q=31&ie[T];ve(e,c,Ce[Q]),c+=D[Q],Q>15&&(ve(e,c,ie[T]>>>5&127),c+=ie[T]>>>12)}}}else fe=nl,le=qe,ce=il,He=ln;for(T=0;T<a;++T)if(n[T]>255){Q=n[T]>>>18&31,dt(e,c,fe[Q+257]),c+=le[Q+257],Q>7&&(ve(e,c,n[T]>>>23&31),c+=sr[Q]);var We=31&n[T];dt(e,c,ce[We]),c+=He[We],We>3&&(dt(e,c,n[T]>>>5&8191),c+=or[We])}else dt(e,c,fe[n[T]]),c+=le[n[T]];return dt(e,c,fe[256]),c+le[256]},rl=new tt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),sl=function(){for(var i=new tt(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;i[e]=t}return i}(),ol=function(i,e,t,n,r){return function(s,o,a,l,u,c){var h=s.length,d=new se(l+h+5*(1+Math.floor(h/7e3))+u),p=d.subarray(l,d.length-u),g=0;if(!o||h<8)for(var v=0;v<=h;v+=65535){var _=v+65535;_<h?g=Ai(p,g,s.subarray(v,_)):(p[v]=c,g=Ai(p,g,s.subarray(v,h)))}else{for(var E=rl[o-1],x=E>>>13,b=8191&E,C=(1<<a)-1,P=new X(32768),z=new X(C+1),q=Math.ceil(a/3),T=2*q,j=function(Cn){return(s[Cn]^s[Cn+1]<<q^s[Cn+2]<<T)&C},D=new tt(25e3),oe=new X(288),ne=new X(32),fe=0,le=0,ce=(v=0,0),He=0,Se=0;v<h;++v){var Me=j(v),ue=32767&v,Ce=z[Me];if(P[ue]=Ce,z[Me]=ue,He<=v){var Ge=h-v;if((fe>7e3||ce>24576)&&Ge>423){g=ts(s,p,0,D,oe,ne,le,ce,Se,v-Se,g),ce=fe=le=0,Se=v;for(var W=0;W<286;++W)oe[W]=0;for(W=0;W<30;++W)ne[W]=0}var ie=2,Q=0,We=b,xe=ue-Ce&32767;if(Ge>2&&Me==j(v-xe))for(var Uo=Math.min(x,Ge)-1,qo=Math.min(32767,v),Ho=Math.min(258,Ge);xe<=qo&&--We&&ue!=Ce;){if(s[v+ie]==s[v+ie-xe]){for(var Te=0;Te<Ho&&s[v+Te]==s[v+Te-xe];++Te);if(Te>ie){if(ie=Te,Q=xe,Te>Uo)break;var Go=Math.min(xe,Te-2),_r=0;for(W=0;W<Go;++W){var Sn=v-xe+W+32768&32767,mr=Sn-P[Sn]+32768&32767;mr>_r&&(_r=mr,Ce=Sn)}}}xe+=(ue=Ce)-(Ce=P[ue])+32768&32767}if(Q){D[ce++]=268435456|Ri[ie]<<18|Pi[Q];var yr=31&Ri[ie],br=31&Pi[Q];le+=sr[yr]+or[br],++oe[257+yr],++ne[br],He=v+ie,++fe}else D[ce++]=s[v],++oe[s[v]]}}g=ts(s,p,c,D,oe,ne,le,ce,Se,v-Se,g)}return fo(d,0,l+go(g)+u)}(i,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(i.length)))):12+e.mem,t,n,!0)},Ln=function(i,e,t){for(;t;++e)i[e]=t,t>>>=8};function al(i,e){e===void 0&&(e={});var t=function(){var a=4294967295;return{p:function(l){for(var u=a,c=0;c<l.length;++c)u=sl[255&u^l[c]]^u>>>8;a=u},d:function(){return 4294967295^a}}}(),n=i.length;t.p(i);var r,s=ol(i,e,10+((r=e).filename&&r.filename.length+1||0),8),o=s.length;return function(a,l){var u=l.filename;if(a[0]=31,a[1]=139,a[2]=8,a[8]=l.level<2?4:l.level==9?2:0,a[9]=3,l.mtime!=0&&Ln(a,4,Math.floor(new Date(l.mtime||Date.now())/1e3)),u){a[3]=8;for(var c=0;c<=u.length;++c)a[c+10]=u.charCodeAt(c)}}(s,e),Ln(s,o-8,t.d()),Ln(s,o-4,n),s}var ll=function(i){var e,t,n,r,s="";for(e=t=0,n=(i=(i+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,r=0;r<n;r++){var o=i.charCodeAt(r),a=null;o<128?t++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),we(a)||(t>e&&(s+=i.substring(e,t)),s+=a,e=t=r+1)}return t>e&&(s+=i.substring(e,i.length)),s},cl=!!Un||!!zn,ns="text/plain",cn=function(i,e,t){var n;t===void 0&&(t=!0);var[r,s]=i.split("?"),o=k({},e),a=(n=s?.split("&").map(u=>{var c,[h,d]=u.split("="),p=t&&(c=o[h])!==null&&c!==void 0?c:d;return delete o[h],h+"="+p}))!==null&&n!==void 0?n:[],l=xa(o);return l&&a.push(l),r+"?"+a.join("&")},bt=(i,e)=>JSON.stringify(i,(t,n)=>typeof n=="bigint"?n.toString():n,e),Dn=i=>{var{data:e,compression:t}=i;if(e){if(t===be.GZipJS){var n=al(function(l,u){var c=l.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(l);for(var h=new se(l.length+(l.length>>>1)),d=0,p=function(E){h[d++]=E},g=0;g<c;++g){if(d+5>h.length){var v=new se(d+8+(c-g<<1));v.set(h),h=v}var _=l.charCodeAt(g);_<128||u?p(_):_<2048?(p(192|_>>>6),p(128|63&_)):_>55295&&_<57344?(p(240|(_=65536+(1047552&_)|1023&l.charCodeAt(++g))>>>18),p(128|_>>>12&63),p(128|_>>>6&63),p(128|63&_)):(p(224|_>>>12),p(128|_>>>6&63),p(128|63&_))}return fo(h,0,d)}(bt(e)),{mtime:0}),r=new Blob([n],{type:ns});return{contentType:ns,body:r,estimatedSize:r.size}}if(t===be.Base64){var s=function(l){var u,c,h,d,p,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=0,_=0,E="",x=[];if(!l)return l;l=ll(l);do u=(p=l.charCodeAt(v++)<<16|l.charCodeAt(v++)<<8|l.charCodeAt(v++))>>18&63,c=p>>12&63,h=p>>6&63,d=63&p,x[_++]=g.charAt(u)+g.charAt(c)+g.charAt(h)+g.charAt(d);while(v<l.length);switch(E=x.join(""),l.length%3){case 1:E=E.slice(0,-2)+"==";break;case 2:E=E.slice(0,-1)+"="}return E}(bt(e)),o=(l=>"data="+encodeURIComponent(typeof l=="string"?l:bt(l)))(s);return{contentType:"application/x-www-form-urlencoded",body:o,estimatedSize:new Blob([o]).size}}var a=bt(e);return{contentType:"application/json",body:a,estimatedSize:new Blob([a]).size}}},Gt=[];zn&&Gt.push({transport:"fetch",method:i=>{var e,t,{contentType:n,body:r,estimatedSize:s}=(e=Dn(i))!==null&&e!==void 0?e:{},o=new Headers;A(i.headers,function(c,h){o.append(h,c)}),n&&o.append("Content-Type",n);var a=i.url,l=null;if(Er){var u=new Er;l={signal:u.signal,timeout:setTimeout(()=>u.abort(),i.timeout)}}zn(a,k({method:i?.method||"GET",headers:o,keepalive:i.method==="POST"&&(s||0)<52428.8,body:r,signal:(t=l)==null?void 0:t.signal},i.fetchOptions)).then(c=>c.text().then(h=>{var d={statusCode:c.status,text:h};if(c.status===200)try{d.json=JSON.parse(h)}catch(p){w.error(p)}i.callback==null||i.callback(d)})).catch(c=>{w.error(c),i.callback==null||i.callback({statusCode:0,text:c})}).finally(()=>l?clearTimeout(l.timeout):null)}}),Un&&Gt.push({transport:"XHR",method:i=>{var e,t=new Un;t.open(i.method||"GET",i.url,!0);var{contentType:n,body:r}=(e=Dn(i))!==null&&e!==void 0?e:{};A(i.headers,function(s,o){t.setRequestHeader(o,s)}),n&&t.setRequestHeader("Content-Type",n),i.timeout&&(t.timeout=i.timeout),i.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var s={statusCode:t.status,text:t.responseText};if(t.status===200)try{s.json=JSON.parse(t.responseText)}catch{}i.callback==null||i.callback(s)}},t.send(r)}}),ee!=null&&ee.sendBeacon&&Gt.push({transport:"sendBeacon",method:i=>{var e=cn(i.url,{beacon:"1"});try{var t,{contentType:n,body:r}=(t=Dn(i))!==null&&t!==void 0?t:{},s=typeof r=="string"?new Blob([r],{type:n}):r;ee.sendBeacon(e,s)}catch{}}});var nt=function(i,e){if(!function(t){try{new RegExp(t)}catch{return!1}return!0}(e))return!1;try{return new RegExp(e).test(i)}catch{return!1}};function is(i,e,t){return bt({distinct_id:i,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var vo={exact:(i,e)=>e.some(t=>i.some(n=>t===n)),is_not:(i,e)=>e.every(t=>i.every(n=>t!==n)),regex:(i,e)=>e.some(t=>i.some(n=>nt(t,n))),not_regex:(i,e)=>e.every(t=>i.every(n=>!nt(t,n))),icontains:(i,e)=>e.map(qt).some(t=>i.map(qt).some(n=>t.includes(n))),not_icontains:(i,e)=>e.map(qt).every(t=>i.map(qt).every(n=>!t.includes(n)))},qt=i=>i.toLowerCase(),Nn=U("[Error tracking]"),Oi=class{constructor(e){var t,n;this.Jt=[],this.Kt=new Xn([new Yn,new ni,new Jn,new Kn,new ei,new Qn,new Zn,new ti],[oa,ca]),this._instance=e,this.Jt=(t=(n=this._instance.persistence)==null?void 0:n.get_property(ri))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,n,r,s=(t=(n=e.errorTracking)==null?void 0:n.suppressionRules)!==null&&t!==void 0?t:[],o=(r=e.errorTracking)==null?void 0:r.captureExtensionExceptions;this.Jt=s,this._instance.persistence&&this._instance.persistence.register({[ri]:this.Jt,[$r]:o})}get Yt(){var e,t=!!this._instance.get_property($r),n=this._instance.config.error_tracking.captureExtensionExceptions;return(e=n??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.Kt.buildFromUnknown(e,{syntheticException:t?.syntheticException,mechanism:{handled:t?.handled}})}sendExceptionEvent(e){var t=e.$exception_list;if(this.Xt(t)){if(this.Qt(t))return void Nn.info("Skipping exception capture because a suppression rule matched");if(!this.Yt&&this.Zt(t))return void Nn.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.ti(t))return void Nn.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}Qt(e){if(e.length===0)return!1;var t=e.reduce((n,r)=>{var{type:s,value:o}=r;return B(s)&&s.length>0&&n.$exception_types.push(s),B(o)&&o.length>0&&n.$exception_values.push(o),n},{$exception_types:[],$exception_values:[]});return this.Jt.some(n=>{var r=n.values.map(s=>{var o,a=vo[s.operator],l=$(s.value)?s.value:[s.value],u=(o=t[s.key])!==null&&o!==void 0?o:[];return l.length>0&&a(l,u)});return n.type==="OR"?r.some(Boolean):r.every(Boolean)})}Zt(e){return e.flatMap(t=>{var n,r;return(n=(r=t.stacktrace)==null?void 0:r.frames)!==null&&n!==void 0?n:[]}).some(t=>t.filename&&t.filename.startsWith("chrome-extension://"))}ti(e){if(e.length>0){var t,n,r,s,o=(t=(n=e[0].stacktrace)==null?void 0:n.frames)!==null&&t!==void 0?t:[],a=o[o.length-1];return(r=a==null||(s=a.filename)==null?void 0:s.includes("posthog.com/static"))!==null&&r!==void 0&&r}return!1}Xt(e){return!F(e)&&$(e)}},ae=U("[FeatureFlags]"),Mn="$active_feature_flags",Ve="$override_feature_flags",rs="$feature_flag_payloads",pt="$override_feature_flag_payloads",ss="$feature_flag_request_id",os=i=>{var e={};for(var[t,n]of Ht(i||{}))n&&(e[t]=n);return e},ul=i=>{var e=i.flags;return e?(i.featureFlags=Object.fromEntries(Object.keys(e).map(t=>{var n;return[t,(n=e[t].variant)!==null&&n!==void 0?n:e[t].enabled]})),i.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter(t=>e[t].enabled).filter(t=>{var n;return(n=e[t].metadata)==null?void 0:n.payload}).map(t=>{var n;return[t,(n=e[t].metadata)==null?void 0:n.payload]}))):ae.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),i},dl=function(i){return i.FeatureFlags="feature_flags",i.Recordings="recordings",i}({}),Fi=class{constructor(e){this.ii=!1,this.ei=!1,this.ri=!1,this.si=!1,this.ni=!1,this.oi=!1,this.ai=!1,this._instance=e,this.featureFlagEventHandlers=[]}li(){var e=this._instance.config.evaluation_environments;return e!=null&&e.length?e.filter(t=>{var n=t&&typeof t=="string"&&t.trim().length>0;return n||ae.error("Invalid evaluation environment found:",t,"Expected non-empty string"),n}):[]}ui(){return this.li().length>0}flags(){if(this._instance.config.__preview_remote_config)this.oi=!0;else{var e=!this.hi&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.di({disableFlags:e})}}get hasLoadedFlags(){return this.ei}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(si),t=this._instance.get_property(Ve),n=this._instance.get_property(pt);if(!n&&!t)return e||{};var r=N({},e||{}),s=[...new Set([...Object.keys(n||{}),...Object.keys(t||{})])];for(var o of s){var a,l,u=r[o],c=t?.[o],h=m(c)?(a=u?.enabled)!==null&&a!==void 0&&a:!!c,d=m(c)?u.variant:typeof c=="string"?c:void 0,p=n?.[o],g=k({},u,{enabled:h,variant:h?d??u?.variant:void 0});h!==u?.enabled&&(g.original_enabled=u?.enabled),d!==u?.variant&&(g.original_variant=u?.variant),p&&(g.metadata=k({},u?.metadata,{payload:p,original_payload:u==null||(l=u.metadata)==null?void 0:l.payload})),r[o]=g}return this.ii||(ae.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:n,finalDetails:r}),this.ii=!0),r}getFlagVariants(){var e=this._instance.get_property(Ke),t=this._instance.get_property(Ve);if(!t)return e||{};for(var n=N({},e),r=Object.keys(t),s=0;s<r.length;s++)n[r[s]]=t[r[s]];return this.ii||(ae.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this.ii=!0),n}getFlagPayloads(){var e=this._instance.get_property(rs),t=this._instance.get_property(pt);if(!t)return e||{};for(var n=N({},e||{}),r=Object.keys(t),s=0;s<r.length;s++)n[r[s]]=t[r[s]];return this.ii||(ae.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:n}),this.ii=!0),n}reloadFeatureFlags(){this.si||this._instance.config.advanced_disable_feature_flags||this.hi||(this.hi=setTimeout(()=>{this.di()},5))}vi(){clearTimeout(this.hi),this.hi=void 0}ensureFlagsLoaded(){this.ei||this.ri||this.hi||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.si=e}di(e){var t;if(this.vi(),!this._instance.M())if(this.ri)this.ni=!0;else{var n={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:k({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(mt)||{}),group_properties:this._instance.get_property(ze)};(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(n.disable_flags=!0),this.ui()&&(n.evaluation_environments=this.li());var r=this._instance.config.__preview_remote_config,s=r?"/flags/?v=2":"/flags/?v=2&config=true",o=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",a=this._instance.requestRouter.endpointFor("flags",s+o);r&&(n.timezone=uo()),this.ri=!0,this._instance.ci({method:"POST",url:a,data:n,compression:this._instance.config.disable_compression?void 0:be.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:l=>{var u,c,h=!0;if(l.statusCode===200&&(this.ni||(this.$anon_distinct_id=void 0),h=!1),this.ri=!1,this.oi||(this.oi=!0,this._instance.fi((c=l.json)!==null&&c!==void 0?c:{})),!n.disable_flags||this.ni)if(this.ai=!h,l.json&&(u=l.json.quotaLimited)!=null&&u.includes(dl.FeatureFlags))ae.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var d;n.disable_flags||this.receivedFeatureFlags((d=l.json)!==null&&d!==void 0?d:{},h),this.ni&&(this.ni=!1,this.di())}}})}}getFeatureFlag(e,t){if(t===void 0&&(t={}),this.ei||this.getFlags()&&this.getFlags().length>0){var n=this.getFlagVariants()[e],r=""+n,s=this._instance.get_property(ss)||void 0,o=this._instance.get_property(Kt)||{};if((t.send_event||!("send_event"in t))&&(!(e in o)||!o[e].includes(r))){var a,l,u,c,h,d,p,g,v;$(o[e])?o[e].push(r):o[e]=[r],(a=this._instance.persistence)==null||a.register({[Kt]:o});var _=this.getFeatureFlagDetails(e),E={$feature_flag:e,$feature_flag_response:n,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_request_id:s,$feature_flag_bootstrapped_response:((l=this._instance.config.bootstrap)==null||(l=l.featureFlags)==null?void 0:l[e])||null,$feature_flag_bootstrapped_payload:((u=this._instance.config.bootstrap)==null||(u=u.featureFlagPayloads)==null?void 0:u[e])||null,$used_bootstrap_value:!this.ai};m(_==null||(c=_.metadata)==null?void 0:c.version)||(E.$feature_flag_version=_.metadata.version);var x,b=(h=_==null||(d=_.reason)==null?void 0:d.description)!==null&&h!==void 0?h:_==null||(p=_.reason)==null?void 0:p.code;b&&(E.$feature_flag_reason=b),_!=null&&(g=_.metadata)!=null&&g.id&&(E.$feature_flag_id=_.metadata.id),m(_?.original_variant)&&m(_?.original_enabled)||(E.$feature_flag_original_response=m(_.original_variant)?_.original_enabled:_.original_variant),_!=null&&(v=_.metadata)!=null&&v.original_payload&&(E.$feature_flag_original_payload=_==null||(x=_.metadata)==null?void 0:x.original_payload),this._instance.capture("$feature_flag_called",E)}return n}ae.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}getRemoteConfigPayload(e,t){var n=this._instance.config.token,r={distinct_id:this._instance.get_distinct_id(),token:n};this.ui()&&(r.evaluation_environments=this.li()),this._instance.ci({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2&config=true"),data:r,compression:this._instance.config.disable_compression?void 0:be.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:s=>{var o,a=(o=s.json)==null?void 0:o.featureFlagPayloads;t(a?.[e]||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.ei||this.getFlags()&&this.getFlags().length>0){var n=this.getFeatureFlag(e,t);return m(n)?void 0:!!n}ae.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(t=>t!==e)}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ei=!0;var n=this.getFlagVariants(),r=this.getFlagPayloads(),s=this.getFlagsWithDetails();(function(o,a,l,u,c){l===void 0&&(l={}),u===void 0&&(u={}),c===void 0&&(c={});var h=ul(o),d=h.flags,p=h.featureFlags,g=h.featureFlagPayloads;if(p){var v=o.requestId;if($(p)){ae.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var _={};if(p)for(var E=0;E<p.length;E++)_[p[E]]=!0;a&&a.register({[Mn]:p,[Ke]:_})}else{var x=p,b=g,C=d;o.errorsWhileComputingFlags&&(x=k({},l,x),b=k({},u,b),C=k({},c,C)),a&&a.register(k({[Mn]:Object.keys(os(x)),[Ke]:x||{},[rs]:b||{},[si]:C||{}},v?{[ss]:v}:{}))}}})(e,this._instance.persistence,n,r,s),this.pi(t)}}override(e,t){t===void 0&&(t=!1),ae.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return ae.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(Ve),this._instance.persistence.unregister(pt),void this.pi();if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,n=e;if(this.ii=!!((t=n.suppressWarning)!==null&&t!==void 0&&t),"flags"in n){if(n.flags===!1)this._instance.persistence.unregister(Ve);else if(n.flags)if($(n.flags)){for(var r={},s=0;s<n.flags.length;s++)r[n.flags[s]]=!0;this._instance.persistence.register({[Ve]:r})}else this._instance.persistence.register({[Ve]:n.flags})}return"payloads"in n&&(n.payloads===!1?this._instance.persistence.unregister(pt):n.payloads&&this._instance.persistence.register({[pt]:n.payloads})),void this.pi()}this.pi()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ei){var{flags:t,flagVariants:n}=this.gi();e(t,n)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,n){var r,s=(this._instance.get_property(_t)||[]).find(u=>u.flagKey===e),o={["$feature_enrollment/"+e]:t},a={$feature_flag:e,$feature_enrollment:t,$set:o};s&&(a.$early_access_feature_name=s.name),n&&(a.$feature_enrollment_stage=n),this._instance.capture("$feature_enrollment_update",a),this.setPersonPropertiesForFlags(o,!1);var l=k({},this.getFlagVariants(),{[e]:t});(r=this._instance.persistence)==null||r.register({[Mn]:Object.keys(os(l)),[Ke]:l}),this.pi()}getEarlyAccessFeatures(e,t,n){t===void 0&&(t=!1);var r=this._instance.get_property(_t),s=n?"&"+n.map(o=>"stage="+o).join("&"):"";if(r&&!t)return e(r);this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+s),method:"GET",callback:o=>{var a,l;if(o.json){var u=o.json.earlyAccessFeatures;return(a=this._instance.persistence)==null||a.unregister(_t),(l=this._instance.persistence)==null||l.register({[_t]:u}),e(u)}}})}gi(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter(n=>t[n]),flagVariants:Object.keys(t).filter(n=>t[n]).reduce((n,r)=>(n[r]=t[r],n),{})}}pi(e){var{flags:t,flagVariants:n}=this.gi();this.featureFlagEventHandlers.forEach(r=>r(t,n,{errorsLoading:e}))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(mt)||{};this._instance.register({[mt]:k({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(mt)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(ze)||{};Object.keys(n).length!==0&&Object.keys(n).forEach(r=>{n[r]=k({},n[r],e[r]),delete e[r]}),this._instance.register({[ze]:k({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(ze)||{};this._instance.register({[ze]:k({},t,{[e]:{}})})}else this._instance.unregister(ze)}reset(){this.ei=!1,this.ri=!1,this.si=!1,this.ni=!1,this.oi=!1,this.ai=!1,this.$anon_distinct_id=void 0,this.vi(),this.ii=!1}},hl=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"],Et=class{constructor(e,t){this.C=e,this.props={},this.mi=!1,this.yi=(n=>{var r="";return n.token&&(r=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+r+"_posthog"})(e),this.Y=this.bi(e),this.load(),e.debug&&w.info("Persistence loaded",e.persistence,k({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.wi}bi(e){hl.indexOf(e.persistence.toLowerCase())===-1&&(w.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return t==="localstorage"&&L.H()?L:t==="localstorage+cookie"&&jt.H()?jt:t==="sessionstorage"&&H.H()?H:t==="memory"?$a:t==="cookie"?pe:jt.H()?jt:pe}properties(){var e={};return A(this.props,function(t,n){if(n===Ke&&G(t))for(var r=Object.keys(t),s=0;s<r.length;s++)e["$feature/"+r[s]]=t[r[s]];else a=n,l=!1,(we(o=ma)?l:kr&&o.indexOf===kr?o.indexOf(a)!=-1:(A(o,function(u){if(l||(l=u===a))return Xt}),l))||(e[n]=t);var o,a,l}),e}load(){if(!this.wi){var e=this.Y.W(this.yi);e&&(this.props=N({},e))}}save(){this.wi||this.Y.G(this.yi,this.props,this.xi,this.$i,this.Si,this.C.debug)}remove(){this.Y.V(this.yi,!1),this.Y.V(this.yi,!0)}clear(){this.remove(),this.props={}}register_once(e,t,n){if(G(e)){m(t)&&(t="None"),this.xi=m(n)?this.Ei:n;var r=!1;if(A(e,(s,o)=>{this.props.hasOwnProperty(o)&&this.props[o]!==t||(this.props[o]=s,r=!0)}),r)return this.save(),!0}return!1}register(e,t){if(G(e)){this.xi=m(t)?this.Ei:t;var n=!1;if(A(e,(r,s)=>{e.hasOwnProperty(s)&&this.props[s]!==r&&(this.props[s]=r,n=!0)}),n)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.mi){var e=ro(this.C.custom_campaign_params,this.C.mask_personal_data_properties,this.C.custom_personal_data_properties);Ye(Ji(e))||this.register(e),this.mi=!0}}update_search_keyword(){var e;this.register((e=y?.referrer)?oo(e):{})}update_referrer_info(){var e;this.register_once({$referrer:ao(),$referring_domain:y!=null&&y.referrer&&((e=tn(y.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[ci]||this.props[ui]||this.register_once({[Jt]:lo(this.C.mask_personal_data_properties,this.C.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};A([ui,ci],o=>{var a=this.props[o];a&&A(a,function(l,u){e["$initial_"+qn(u)]=l})});var t,n,r=this.props[Jt];if(r){var s=(t=co(r),n={},A(t,function(o,a){n["$initial_"+qn(a)]=o}),n);N(e,s)}return e}safe_merge(e){return A(this.props,function(t,n){n in e||(e[n]=t)}),e}update_config(e,t,n){if(this.Ei=this.xi=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!n),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var r=this.bi(e),s=this.props;this.clear(),this.Y=r,this.props=s,this.save()}}set_disabled(e){this.wi=e,this.wi?this.remove():this.save()}set_cross_subdomain(e){e!==this.$i&&(this.$i=e,this.remove(),this.save())}set_secure(e){e!==this.Si&&(this.Si=e,this.remove(),this.save())}set_event_timer(e,t){var n=this.props[vt]||{};n[e]=t,this.props[vt]=n,this.save()}remove_event_timer(e){var t=(this.props[vt]||{})[e];return m(t)||(delete this.props[vt][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}},fc=function(i){return i.Button="button",i.Tab="tab",i.Selector="selector",i}({}),vc=function(i){return i.TopLeft="top_left",i.TopRight="top_right",i.TopCenter="top_center",i.MiddleLeft="middle_left",i.MiddleRight="middle_right",i.MiddleCenter="middle_center",i.Left="left",i.Center="center",i.Right="right",i.NextToTrigger="next_to_trigger",i}({}),jn=function(i){return i.Popover="popover",i.API="api",i.Widget="widget",i.ExternalSurvey="external_survey",i}({}),_c=function(i){return i.Open="open",i.MultipleChoice="multiple_choice",i.SingleChoice="single_choice",i.Rating="rating",i.Link="link",i}({}),mc=function(i){return i.NextQuestion="next_question",i.End="end",i.ResponseBased="response_based",i.SpecificQuestion="specific_question",i}({}),yc=function(i){return i.Once="once",i.Recurring="recurring",i.Always="always",i}({}),Wt=function(i){return i.SHOWN="survey shown",i.DISMISSED="survey dismissed",i.SENT="survey sent",i}({}),as=function(i){return i.SURVEY_ID="$survey_id",i.SURVEY_NAME="$survey_name",i.SURVEY_RESPONSE="$survey_response",i.SURVEY_ITERATION="$survey_iteration",i.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",i.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",i.SURVEY_SUBMISSION_ID="$survey_submission_id",i.SURVEY_QUESTIONS="$survey_questions",i.SURVEY_COMPLETED="$survey_completed",i}({}),_o=function(i){return i.Popover="popover",i.Inline="inline",i}({}),It=class{constructor(){this.ki={},this.ki={}}on(e,t){return this.ki[e]||(this.ki[e]=[]),this.ki[e].push(t),()=>{this.ki[e]=this.ki[e].filter(n=>n!==t)}}emit(e,t){for(var n of this.ki[e]||[])n(t);for(var r of this.ki["*"]||[])r(e,t)}},$i=class i{constructor(e){this.Pi=new It,this.Ti=(t,n)=>this.Ri(t,n)&&this.Ii(t,n)&&this.Ci(t,n),this.Ri=(t,n)=>n==null||!n.event||t?.event===n?.event,this._instance=e,this.Oi=new Set,this.Fi=new Set}init(){var e;if(!m((e=this._instance)==null?void 0:e.Mi)){var t;(t=this._instance)==null||t.Mi((n,r)=>{this.on(n,r)})}}register(e){var t,n;if(!m((t=this._instance)==null?void 0:t.Mi)&&(e.forEach(o=>{var a,l;(a=this.Fi)==null||a.add(o),(l=o.steps)==null||l.forEach(u=>{var c;(c=this.Oi)==null||c.add(u?.event||"")})}),(n=this._instance)!=null&&n.autocapture)){var r,s=new Set;e.forEach(o=>{var a;(a=o.steps)==null||a.forEach(l=>{l!=null&&l.selector&&s.add(l?.selector)})}),(r=this._instance)==null||r.autocapture.setElementSelectors(s)}}on(e,t){var n;t!=null&&e.length!=0&&(this.Oi.has(e)||this.Oi.has(t?.event))&&this.Fi&&((n=this.Fi)==null?void 0:n.size)>0&&this.Fi.forEach(r=>{this.Ai(t,r)&&this.Pi.emit("actionCaptured",r.name)})}Di(e){this.onAction("actionCaptured",t=>e(t))}Ai(e,t){if(t?.steps==null)return!1;for(var n of t.steps)if(this.Ti(e,n))return!0;return!1}onAction(e,t){return this.Pi.on(e,t)}Ii(e,t){if(t!=null&&t.url){var n,r=e==null||(n=e.properties)==null?void 0:n.$current_url;if(!r||typeof r!="string"||!i.ji(r,t?.url,t?.url_matching||"contains"))return!1}return!0}static ji(e,t,n){switch(n){case"regex":return!!f&&nt(e,t);case"exact":return t===e;case"contains":var r=i.Li(t).replace(/_/g,".").replace(/%/g,".*");return nt(e,r);default:return!1}}static Li(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}Ci(e,t){if((t!=null&&t.href||t!=null&&t.tag_name||t!=null&&t.text)&&!this.Ni(e).some(s=>!(t!=null&&t.href&&!i.ji(s.href||"",t?.href,t?.href_matching||"exact"))&&(t==null||!t.tag_name||s.tag_name===t?.tag_name)&&!(t!=null&&t.text&&!i.ji(s.text||"",t?.text,t?.text_matching||"exact")&&!i.ji(s.$el_text||"",t?.text,t?.text_matching||"exact"))))return!1;if(t!=null&&t.selector){var n,r=e==null||(n=e.properties)==null?void 0:n.$element_selectors;if(!r||!r.includes(t?.selector))return!1}return!0}Ni(e){return e?.properties.$elements==null?[]:e?.properties.$elements}},I=U("[Surveys]"),Li="seenSurvey_",pl=(i,e)=>{var t="$survey_"+e+"/"+i.id;return i.current_iteration&&i.current_iteration>0&&(t="$survey_"+e+"/"+i.id+"/"+i.current_iteration),t},ls=i=>{var e=""+Li+i.id;return i.current_iteration&&i.current_iteration>0&&(e=""+Li+i.id+"_"+i.current_iteration),e},gl=[jn.Popover,jn.Widget,jn.API],fl={ignoreConditions:!1,ignoreDelay:!1,displayType:_o.Popover},Di=class{constructor(e){this._instance=e,this.Ui=new Map,this.Hi=new Map}register(e){var t;m((t=this._instance)==null?void 0:t.Mi)||(this.zi(e),this.Bi(e))}Bi(e){var t=e.filter(n=>{var r,s;return((r=n.conditions)==null?void 0:r.actions)&&((s=n.conditions)==null||(s=s.actions)==null||(s=s.values)==null?void 0:s.length)>0});t.length!==0&&(this.qi==null&&(this.qi=new $i(this._instance),this.qi.init(),this.qi.Di(n=>{this.onAction(n)})),t.forEach(n=>{var r,s,o,a,l;n.conditions&&(r=n.conditions)!=null&&r.actions&&(s=n.conditions)!=null&&(s=s.actions)!=null&&s.values&&((o=n.conditions)==null||(o=o.actions)==null||(o=o.values)==null?void 0:o.length)>0&&((a=this.qi)==null||a.register(n.conditions.actions.values),(l=n.conditions)==null||(l=l.actions)==null||(l=l.values)==null||l.forEach(u=>{if(u&&u.name){var c=this.Hi.get(u.name);c&&c.push(n.id),this.Hi.set(u.name,c||[n.id])}}))}))}zi(e){var t;e.filter(n=>{var r,s;return((r=n.conditions)==null?void 0:r.events)&&((s=n.conditions)==null||(s=s.events)==null||(s=s.values)==null?void 0:s.length)>0}).length!==0&&((t=this._instance)==null||t.Mi((n,r)=>{this.onEvent(n,r)}),e.forEach(n=>{var r;(r=n.conditions)==null||(r=r.events)==null||(r=r.values)==null||r.forEach(s=>{if(s&&s.name){var o=this.Ui.get(s.name);o&&o.push(n.id),this.Ui.set(s.name,o||[n.id])}})}))}onEvent(e,t){var n,r,s=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[Mt])||[];if(Wt.SHOWN===e&&t&&s.length>0){var o;I.info("survey event matched, removing survey from activated surveys",{event:e,eventPayload:t,existingActivatedSurveys:s});var a=t==null||(o=t.properties)==null?void 0:o.$survey_id;if(a){var l=s.indexOf(a);l>=0&&(s.splice(l,1),this.Wi(s))}}else if(this.Ui.has(e)){I.info("survey event name matched",{event:e,eventPayload:t,surveys:this.Ui.get(e)});var u=[];(r=this._instance)==null||r.getSurveys(h=>{u=h.filter(d=>{var p;return(p=this.Ui.get(e))==null?void 0:p.includes(d.id)})});var c=u.filter(h=>{var d,p=(d=h.conditions)==null||(d=d.events)==null||(d=d.values)==null?void 0:d.find(g=>g.name===e);return!!p&&(!p.propertyFilters||Object.entries(p.propertyFilters).every(g=>{var v,[_,E]=g,x=t==null||(v=t.properties)==null?void 0:v[_];if(m(x)||we(x))return!1;var b=[String(x)],C=vo[E.operator];return C?C(E.values,b):(I.warn("Unknown property comparison operator: "+E.operator),!1)}))});this.Wi(s.concat(c.map(h=>h.id)||[]))}}onAction(e){var t,n=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[Mt])||[];this.Hi.has(e)&&this.Wi(n.concat(this.Hi.get(e)||[]))}Wi(e){var t;I.info("updating activated surveys",{activatedSurveys:e}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[Mt]:[...new Set(e)]})}getSurveys(){var e,t=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[Mt];return t||[]}getEventToSurveys(){return this.Ui}Gi(){return this.qi}},Ni=class{constructor(e){this.Vi=void 0,this._surveyManager=null,this.Ji=!1,this.Ki=!1,this.Yi=[],this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(F(t))return I.warn("Flags not loaded yet. Not loading surveys.");var n=$(t);this.Vi=n?t.length>0:t,I.info("flags response received, isSurveysEnabled: "+this.Vi),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);(n!=null&&n.startsWith(Li)||n!=null&&n.startsWith("inProgressSurvey_"))&&e.push(n)}e.forEach(r=>localStorage.removeItem(r))}loadIfEnabled(){if(!this._surveyManager)if(this.Ki)I.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)I.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())I.info("Not loading surveys in cookieless mode without consent.");else{var e=S?.__PosthogExtensions__;if(e){if(!m(this.Vi)||this._instance.config.advanced_enable_surveys){var t=this.Vi||this._instance.config.advanced_enable_surveys;this.Ki=!0;try{var n=e.generateSurveys;if(n)return void this.Xi(n,t);var r=e.loadExternalDependency;if(!r)return void this.Qi("PostHog loadExternalDependency extension not found.");r(this._instance,"surveys",s=>{s||!e.generateSurveys?this.Qi("Could not load surveys script",s):this.Xi(e.generateSurveys,t)})}catch(s){throw this.Qi("Error initializing surveys",s),s}finally{this.Ki=!1}}}else I.error("PostHog Extensions not found.")}}Xi(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new Di(this._instance),I.info("Surveys loaded successfully"),this.Zi({isLoaded:!0})}Qi(e,t){I.error(e,t),this.Zi({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.Yi.push(e),this._surveyManager&&this.Zi({isLoaded:!0}),()=>{this.Yi=this.Yi.filter(t=>t!==e)}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return I.info("Disabled. Not loading surveys."),e([]);var n=this._instance.get_property(oi);if(n&&!t)return e(n,{isLoaded:!0});if(this.Ji)return e([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this.Ji=!0,this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:r=>{var s;this.Ji=!1;var o=r.statusCode;if(o!==200||!r.json){var a="Surveys API could not be loaded, status: "+o;return I.error(a),e([],{isLoaded:!1,error:a})}var l,u=r.json.surveys||[],c=u.filter(h=>function(d){return!(!d.start_date||d.end_date)}(h)&&(function(d){var p;return!((p=d.conditions)==null||(p=p.events)==null||(p=p.values)==null||!p.length)}(h)||function(d){var p;return!((p=d.conditions)==null||(p=p.actions)==null||(p=p.values)==null||!p.length)}(h)));return c.length>0&&((l=this._surveyEventReceiver)==null||l.register(c)),(s=this._instance.persistence)==null||s.register({[oi]:u}),e(u,{isLoaded:!0})}})}catch(r){throw this.Ji=!1,r}}Zi(e){for(var t of this.Yi)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(n){I.error("Error in survey callback",n)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!F(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);I.warn("init was not called")}te(e){var t=null;return this.getSurveys(n=>{var r;t=(r=n.find(s=>s.id===e))!==null&&r!==void 0?r:null}),t}ie(e){if(F(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.te(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(F(this._surveyManager))return I.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.ie(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return F(this._surveyManager)?(I.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise(n=>{this.getSurveys(r=>{var s,o=(s=r.find(l=>l.id===e))!==null&&s!==void 0?s:null;if(o){var a=this.ie(o);n({visible:a.eligible,disabledReason:a.reason})}else n({visible:!1,disabledReason:"Survey not found"})},t)})}renderSurvey(e,t){var n;if(F(this._surveyManager))I.warn("init was not called");else{var r=typeof e=="string"?this.te(e):e;if(r!=null&&r.id)if(gl.includes(r.type)){var s=y?.querySelector(t);if(s)return(n=r.appearance)!=null&&n.surveyPopupDelaySeconds?(I.info("Rendering survey "+r.id+" with delay of "+r.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout(()=>{var o,a;I.info("Rendering survey "+r.id+" with delay of "+((o=r.appearance)==null?void 0:o.surveyPopupDelaySeconds)+" seconds"),(a=this._surveyManager)==null||a.renderSurvey(r,s),I.info("Survey "+r.id+" rendered")},1e3*r.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(r,s);I.warn("Survey element not found")}else I.warn("Surveys of type "+r.type+" cannot be rendered in the app");else I.warn("Survey not found")}}displaySurvey(e,t){var n;if(F(this._surveyManager))I.warn("init was not called");else{var r=this.te(e);if(r){var s=r;if((n=r.appearance)!=null&&n.surveyPopupDelaySeconds&&t.ignoreDelay&&(s=k({},r,{appearance:k({},r.appearance,{surveyPopupDelaySeconds:0})})),t.ignoreConditions===!1){var o=this.canRenderSurvey(r);if(!o.visible)return void I.warn("Survey is not eligible to be displayed: ",o.disabledReason)}t.displayType!==_o.Inline?this._surveyManager.handlePopoverSurvey(s):this.renderSurvey(s,t.selector)}else I.warn("Survey not found")}}},cs=U("[RateLimiter]"),Mi=class{constructor(e){var t,n;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=r=>{var s=r.text;if(s&&s.length)try{(JSON.parse(s).quota_limited||[]).forEach(o=>{cs.info((o||"events")+" is quota limited."),this.serverLimits[o]=new Date().getTime()+6e4})}catch(o){return void cs.warn('could not rate limit - continuing. Error: "'+o?.message+'"',{text:s})}},this.instance=e,this.captureEventsPerSecond=((t=e.config.rate_limiting)==null?void 0:t.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((n=e.config.rate_limiting)==null?void 0:n.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(e){var t,n,r;e===void 0&&(e=!1);var s=new Date().getTime(),o=(t=(n=this.instance.persistence)==null?void 0:n.get_property(li))!==null&&t!==void 0?t:{tokens:this.captureEventsBurstLimit,last:s};o.tokens+=(s-o.last)/1e3*this.captureEventsPerSecond,o.last=s,o.tokens>this.captureEventsBurstLimit&&(o.tokens=this.captureEventsBurstLimit);var a=o.tokens<1;return a||e||(o.tokens=Math.max(0,o.tokens-1)),!a||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=a,(r=this.instance.persistence)==null||r.set_property(li,o),{isRateLimited:a,remainingTokens:o.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}},Be=U("[RemoteConfig]"),ji=class{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=S._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}ee(e){var t,n;(t=S.__PosthogExtensions__)!=null&&t.loadExternalDependency?(n=S.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"remote-config",()=>e(this.remoteConfig)):(Be.error("PostHog Extensions not found. Cannot load remote config."),e())}re(e){this._instance.ci({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return Be.info("Using preloaded remote config",this.remoteConfig),void this.fi(this.remoteConfig);if(this._instance.M())return void Be.warn("Remote config is disabled. Falling back to local config.");this.ee(e=>{if(!e)return Be.info("No config found after loading remote JS config. Falling back to JSON."),void this.re(t=>{this.fi(t)});this.fi(e)})}catch(e){Be.error("Error loading remote config",e)}}fi(e){e?this._instance.config.__preview_remote_config?(this._instance.fi(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):Be.info("__preview_remote_config is disabled. Logging config instead",e):Be.error("Failed to fetch remote config from PostHog.")}},Bi=3e3,zi=class{constructor(e,t){this.se=!0,this.ne=[],this.oe=de(t?.flush_interval_ms||Bi,250,5e3,w.createLogger("flush interval"),Bi),this.ae=e}enqueue(e){this.ne.push(e),this.le||this.ue()}unload(){this.he();var e=this.ne.length>0?this.de():{},t=Object.values(e);[...t.filter(n=>n.url.indexOf("/e")===0),...t.filter(n=>n.url.indexOf("/e")!==0)].map(n=>{this.ae(k({},n,{transport:"sendBeacon"}))})}enable(){this.se=!1,this.ue()}ue(){var e=this;this.se||(this.le=setTimeout(()=>{if(this.he(),this.ne.length>0){var t=this.de(),n=function(){var s=t[r],o=new Date().getTime();s.data&&$(s.data)&&A(s.data,a=>{a.offset=Math.abs(a.timestamp-o),delete a.timestamp}),e.ae(s)};for(var r in t)n()}},this.oe))}he(){clearTimeout(this.le),this.le=void 0}de(){var e={};return A(this.ne,t=>{var n,r=t,s=(r?r.batchKey:null)||r.url;m(e[s])&&(e[s]=k({},r,{data:[]})),(n=e[s].data)==null||n.push(r.data)}),this.ne=[],e}},vl=["retriesPerformedSoFar"],Ui=class{constructor(e){this.ve=!1,this.ce=3e3,this.ne=[],this._instance=e,this.ne=[],this.fe=!0,!m(f)&&"onLine"in f.navigator&&(this.fe=f.navigator.onLine,this.pe=()=>{this.fe=!0,this.Dt()},this.ge=()=>{this.fe=!1},M(f,"online",this.pe),M(f,"offline",this.ge))}get length(){return this.ne.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,n=fs(e,vl);ge(t)&&t>0&&(n.url=cn(n.url,{retry_count:t})),this._instance.ci(k({},n,{callback:r=>{r.statusCode!==200&&(r.statusCode<400||r.statusCode>=500)&&(t??0)<10?this._e(k({retriesPerformedSoFar:t},n)):n.callback==null||n.callback(r)}}))}_e(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=function(o){var a=3e3*Math.pow(2,o),l=a/2,u=Math.min(18e5,a),c=(Math.random()-.5)*(u-l);return Math.ceil(u+c)}(t),r=Date.now()+n;this.ne.push({retryAt:r,requestOptions:e});var s="Enqueued failed request for retry in "+n;navigator.onLine||(s+=" (Browser is offline)"),w.warn(s),this.ve||(this.ve=!0,this.me())}me(){if(this.ye&&clearTimeout(this.ye),this.ne.length===0)return this.ve=!1,void(this.ye=void 0);this.ye=setTimeout(()=>{this.fe&&this.ne.length>0&&this.Dt(),this.me()},this.ce)}Dt(){var e=Date.now(),t=[],n=this.ne.filter(s=>s.retryAt<e||(t.push(s),!1));if(this.ne=t,n.length>0)for(var{requestOptions:r}of n)this.retriableRequest(r)}unload(){for(var{requestOptions:e}of(this.ye&&(clearTimeout(this.ye),this.ye=void 0),this.ve=!1,m(f)||(this.pe&&(f.removeEventListener("online",this.pe),this.pe=void 0),this.ge&&(f.removeEventListener("offline",this.ge),this.ge=void 0)),this.ne))try{this._instance.ci(k({},e,{transport:"sendBeacon"}))}catch(t){w.error(t)}this.ne=[]}},qi=class{constructor(e){this.be=()=>{var t,n,r,s;this.we||(this.we={});var o=this.scrollElement(),a=this.scrollY(),l=o?Math.max(0,o.scrollHeight-o.clientHeight):0,u=a+(o?.clientHeight||0),c=o?.scrollHeight||0;this.we.lastScrollY=Math.ceil(a),this.we.maxScrollY=Math.max(a,(t=this.we.maxScrollY)!==null&&t!==void 0?t:0),this.we.maxScrollHeight=Math.max(l,(n=this.we.maxScrollHeight)!==null&&n!==void 0?n:0),this.we.lastContentY=u,this.we.maxContentY=Math.max(u,(r=this.we.maxContentY)!==null&&r!==void 0?r:0),this.we.maxContentHeight=Math.max(c,(s=this.we.maxContentHeight)!==null&&s!==void 0?s:0)},this._instance=e}getContext(){return this.we}resetContext(){var e=this.we;return setTimeout(this.be,0),e}startMeasuringScrollPosition(){M(f,"scroll",this.be,{capture:!0}),M(f,"scrollend",this.be,{capture:!0}),M(f,"resize",this.be)}scrollElement(){if(!this._instance.config.scroll_root_selector)return f?.document.documentElement;var e=$(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var n=f?.document.querySelector(t);if(n)return n}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return f&&(f.scrollY||f.pageYOffset||f.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return f&&(f.scrollX||f.pageXOffset||f.document.documentElement.scrollLeft)||0}},_l=i=>lo(i?.config.mask_personal_data_properties,i?.config.custom_personal_data_properties),un=class{constructor(e,t,n,r){this.xe=s=>{var o=this.$e();if(!o||o.sessionId!==s){var a={sessionId:s,props:this.Se(this._instance)};this.Ee.register({[ai]:a})}},this._instance=e,this.ke=t,this.Ee=n,this.Se=r||_l,this.ke.onSessionId(this.xe)}$e(){return this.Ee.props[ai]}getSetOnceProps(){var e,t=(e=this.$e())==null?void 0:e.props;return t?"r"in t?co(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return A(Ji(this.getSetOnceProps()),(t,n)=>{n==="$current_url"&&(n="url"),e["$session_entry_"+qn(n)]=t}),e}},Bn=U("[SessionId]"),dn=class{on(e,t){return this.Pe.on(e,t)}constructor(e,t,n){var r;if(this.Te=[],this.Re=void 0,this.Pe=new It,this.Ie=(c,h)=>Math.abs(c-h)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.C=e.config,this.Ee=e.persistence,this.Ce=void 0,this.Oe=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.Fe=t||Fe,this.Me=n||Fe;var s=this.C.persistence_name||this.C.token,o=this.C.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*de(o,60,36e3,Bn.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.Ae(),this.De="ph_"+s+"_window_id",this.je="ph_"+s+"_primary_window_exists",this.Le()){var a=H.W(this.De),l=H.W(this.je);a&&!l?this.Ce=a:H.V(this.De),H.G(this.je,!0)}if((r=this.C.bootstrap)!=null&&r.sessionID)try{var u=(c=>{var h=c.replace(/-/g,"");if(h.length!==32)throw new Error("Not a valid UUID");if(h[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(h.substring(0,12),16)})(this.C.bootstrap.sessionID);this.Ne(this.C.bootstrap.sessionID,new Date().getTime(),u)}catch(c){Bn.error("Invalid sessionID in bootstrap",c)}this.Ue()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return m(this.Te)&&(this.Te=[]),this.Te.push(e),this.Oe&&e(this.Oe,this.Ce),()=>{this.Te=this.Te.filter(t=>t!==e)}}Le(){return this.C.persistence!=="memory"&&!this.Ee.wi&&H.H()}He(e){e!==this.Ce&&(this.Ce=e,this.Le()&&H.G(this.De,e))}ze(){return this.Ce?this.Ce:this.Le()?H.W(this.De):null}Ne(e,t,n){e===this.Oe&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this.Oe=e,this.Ee.register({[Yt]:[t,e,n]}))}Be(){if(this.Oe&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this.Oe,this._sessionStartTimestamp];var e=this.Ee.props[Yt];return $(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.Ne(null,null,null)}destroy(){clearTimeout(this.qe),this.qe=void 0,this.Re&&f&&(f.removeEventListener("beforeunload",this.Re,{capture:!1}),this.Re=void 0),this.Te=[]}Ue(){this.Re=()=>{this.Le()&&H.V(this.je)},M(f,"beforeunload",this.Re,{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.C.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var n=t||new Date().getTime(),[r,s,o]=this.Be(),a=this.ze(),l=ge(o)&&o>0&&Math.abs(n-o)>864e5,u=!1,c=!s,h=!c&&!e&&this.Ie(n,r);c||h||l?(s=this.Fe(),a=this.Me(),Bn.info("new session ID generated",{sessionId:s,windowId:a,changeReason:{noSessionId:c,activityTimeout:h,sessionPastMaximumLength:l}}),o=n,u=!0):a||(a=this.Me(),u=!0);var d=r===0||!e||l?n:r,p=o===0?new Date().getTime():o;return this.He(a),this.Ne(s,d,p),e||this.Ae(),u&&this.Te.forEach(g=>g(s,a,u?{noSessionId:c,activityTimeout:h,sessionPastMaximumLength:l}:void 0)),{sessionId:s,windowId:a,sessionStartTimestamp:p,changeReason:u?{noSessionId:c,activityTimeout:h,sessionPastMaximumLength:l}:void 0,lastActivityTimestamp:r}}Ae(){clearTimeout(this.qe),this.qe=setTimeout(()=>{var[e]=this.Be();if(this.Ie(new Date().getTime(),e)){var t=this.Oe;this.resetSessionId(),this.Pe.emit("forcedIdleReset",{idleSessionId:t})}},1.1*this.sessionTimeoutMs)}},ml=["$set_once","$set"],Ae=U("[SiteApps]"),Hi=class{constructor(e){this._instance=e,this.We=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}Ge(e,t){if(t){var n=this.globalsForEvent(t);this.We.push(n),this.We.length>1e3&&(this.We=this.We.slice(10))}}get siteAppLoaders(){var e;return(e=S._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance.Mi(this.Ge.bind(this));this.Ve=()=>{e(),this.We=[],this.Ve=void 0}}}globalsForEvent(e){var t,n,r,s,o,a,l;if(!e)throw new Error("Event payload is required");var u={},c=this._instance.get_property("$groups")||[],h=this._instance.get_property("$stored_group_properties")||{};for(var[d,p]of Object.entries(h))u[d]={id:c[d],type:d,properties:p};var{$set_once:g,$set:v}=e;return{event:k({},fs(e,ml),{properties:k({},e.properties,v?{$set:k({},(t=(n=e.properties)==null?void 0:n.$set)!==null&&t!==void 0?t:{},v)}:{},g?{$set_once:k({},(r=(s=e.properties)==null?void 0:s.$set_once)!==null&&r!==void 0?r:{},g)}:{}),elements_chain:(o=(a=e.properties)==null?void 0:a.$elements_chain)!==null&&o!==void 0?o:"",distinct_id:(l=e.properties)==null?void 0:l.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:u}}setupSiteApp(e){var t=this.apps[e.id],n=()=>{var a;!t.errored&&this.We.length&&(Ae.info("Processing "+this.We.length+" events for site app with id "+e.id),this.We.forEach(l=>t.processEvent==null?void 0:t.processEvent(l)),t.processedBuffer=!0),Object.values(this.apps).every(l=>l.processedBuffer||l.errored)&&((a=this.Ve)==null||a.call(this))},r=!1,s=a=>{t.errored=!a,t.loaded=!0,Ae.info("Site app with id "+e.id+" "+(a?"loaded":"errored")),r&&n()};try{var{processEvent:o}=e.init({posthog:this._instance,callback:a=>{s(a)}});o&&(t.processEvent=o),r=!0}catch(a){Ae.error("Error while initializing PostHog app with config id "+e.id,a),s(!1)}if(r&&t.loaded)try{n()}catch(a){Ae.error("Error while processing buffered events PostHog app with config id "+e.id,a),t.errored=!0}}Je(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var n of e)this.setupSiteApp(n)}Ke(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var n of Object.values(this.apps))try{n.processEvent==null||n.processEvent(t)}catch(r){Ae.error("Error while processing event "+e.event+" for site app "+n.id,r)}}}onRemoteConfig(e){var t,n,r,s=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.Je(),void this._instance.on("eventCaptured",u=>this.Ke(u))):void Ae.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((n=this.Ve)==null||n.call(this),(r=e.siteApps)!=null&&r.length)if(this.isEnabled){var o=function(u){var c;S["__$$ph_site_app_"+u]=s._instance,(c=S.__PosthogExtensions__)==null||c.loadSiteApp==null||c.loadSiteApp(s._instance,l,h=>{if(h)return Ae.error("Error while initializing PostHog app with config id "+u,h)})};for(var{id:a,url:l}of e.siteApps)o(a)}else Ae.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}},mo=function(i,e){if(!i)return!1;var t=i.userAgent;if(t&&xr(t,e))return!0;try{var n=i?.userAgentData;if(n!=null&&n.brands&&n.brands.some(r=>xr(r?.brand,e)))return!0}catch{}return!!i.webdriver},wt=function(i){return i.US="us",i.EU="eu",i.CUSTOM="custom",i}({}),us="i.posthog.com",Gi=class{constructor(e){this.Ye={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get flagsApiHost(){var e=this.instance.config.flags_api_host;return e?e.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+us,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.Ye[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.Ye[this.apiHost]=wt.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.Ye[this.apiHost]=wt.EU:this.Ye[this.apiHost]=wt.CUSTOM),this.Ye[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(e==="flags")return this.flagsApiHost+t;if(this.region===wt.CUSTOM)return this.apiHost+t;var n=us+t;switch(e){case"assets":return"https://"+this.region+"-assets."+n;case"api":return"https://"+this.region+"."+n}}},yl={icontains:(i,e)=>!!f&&e.href.toLowerCase().indexOf(i.toLowerCase())>-1,not_icontains:(i,e)=>!!f&&e.href.toLowerCase().indexOf(i.toLowerCase())===-1,regex:(i,e)=>!!f&&nt(e.href,i),not_regex:(i,e)=>!!f&&!nt(e.href,i),exact:(i,e)=>e.href===i,is_not:(i,e)=>e.href!==i},Wi=class i{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(n){n===void 0&&(n=!1),t.getWebExperiments(r=>{i.Xe("retrieved web experiments from the server"),t.Qe=new Map,r.forEach(s=>{if(s.feature_flag_key){var o;t.Qe&&(i.Xe("setting flag key ",s.feature_flag_key," to web experiment ",s),(o=t.Qe)==null||o.set(s.feature_flag_key,s));var a=t._instance.getFeatureFlag(s.feature_flag_key);B(a)&&s.variants[a]&&t.Ze(s.name,a,s.variants[a].transforms)}else if(s.variants)for(var l in s.variants){var u=s.variants[l];i.tr(u)&&t.Ze(s.name,l,u.transforms)}})},n)},this._instance=e,this._instance.onFeatureFlags(n=>{this.onFeatureFlags(n)})}onFeatureFlags(e){if(this._is_bot())i.Xe("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(F(this.Qe))return this.Qe=new Map,this.loadIfEnabled(),void this.previewWebExperiment();i.Xe("applying feature flags",e),e.forEach(t=>{var n;if(this.Qe&&(n=this.Qe)!=null&&n.has(t)){var r,s=this._instance.getFeatureFlag(t),o=(r=this.Qe)==null?void 0:r.get(t);s&&o!=null&&o.variants[s]&&this.Ze(o.name,s,o.variants[s].transforms)}})}}previewWebExperiment(){var e=i.getWindowLocation();if(e!=null&&e.search){var t=nn(e?.search,"__experiment_id"),n=nn(e?.search,"__experiment_variant");t&&n&&(i.Xe("previewing web experiments "+t+" && "+n),this.getWebExperiments(r=>{this.ir(parseInt(t),n,r)},!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,n){if(this._instance.config.disable_web_experiments&&!n)return e([]);var r=this._instance.get_property("$web_experiments");if(r&&!t)return e(r);this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:s=>{if(s.statusCode!==200||!s.json)return e([]);var o=s.json.experiments||[];return e(o)}})}ir(e,t,n){var r=n.filter(s=>s.id===e);r&&r.length>0&&(i.Xe("Previewing web experiment ["+r[0].name+"] with variant ["+t+"]"),this.Ze(r[0].name,t,r[0].variants[t].transforms))}static tr(e){return!F(e.conditions)&&i.er(e)&&i.rr(e)}static er(e){var t;if(F(e.conditions)||F((t=e.conditions)==null?void 0:t.url))return!0;var n,r,s,o=i.getWindowLocation();return!!o&&((n=e.conditions)==null||!n.url||yl[(r=(s=e.conditions)==null?void 0:s.urlMatchType)!==null&&r!==void 0?r:"icontains"](e.conditions.url,o))}static getWindowLocation(){return f?.location}static rr(e){var t;if(F(e.conditions)||F((t=e.conditions)==null?void 0:t.utm))return!0;var n=ro();if(n.utm_source){var r,s,o,a,l,u,c,h,d=(r=e.conditions)==null||(r=r.utm)==null||!r.utm_campaign||((s=e.conditions)==null||(s=s.utm)==null?void 0:s.utm_campaign)==n.utm_campaign,p=(o=e.conditions)==null||(o=o.utm)==null||!o.utm_source||((a=e.conditions)==null||(a=a.utm)==null?void 0:a.utm_source)==n.utm_source,g=(l=e.conditions)==null||(l=l.utm)==null||!l.utm_medium||((u=e.conditions)==null||(u=u.utm)==null?void 0:u.utm_medium)==n.utm_medium,v=(c=e.conditions)==null||(c=c.utm)==null||!c.utm_term||((h=e.conditions)==null||(h=h.utm)==null?void 0:h.utm_term)==n.utm_term;return d&&g&&v&&p}return!1}static Xe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];w.info("[WebExperiments] "+e,n)}Ze(e,t,n){this._is_bot()?i.Xe("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?n.forEach(r=>{if(r.selector){var s;i.Xe("applying transform of variant "+t+" for experiment "+e+" ",r);var o=(s=document)==null?void 0:s.querySelectorAll(r.selector);o?.forEach(a=>{var l=a;r.html&&(l.innerHTML=r.html),r.css&&l.setAttribute("style",r.css)})}}):i.Xe("Control variants leave the page unmodified.")}_is_bot(){return ee&&this._instance?mo(ee,this._instance.config.custom_blocked_useragents):void 0}},bl=U("[PostHog ExternalIntegrations]"),wl={intercom:"intercom-integration",crispChat:"crisp-chat-integration"},Vi=class{constructor(e){this._instance=e}it(e,t){var n;(n=S.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,e,r=>{if(r)return bl.error("failed to load script",r);t()})}startIfEnabledOrStop(){var e=this,t=function(o){var a,l,u;!r||(a=S.__PosthogExtensions__)!=null&&(a=a.integrations)!=null&&a[o]||e.it(wl[o],()=>{var c;(c=S.__PosthogExtensions__)==null||(c=c.integrations)==null||(c=c[o])==null||c.start(e._instance)}),!r&&(l=S.__PosthogExtensions__)!=null&&(l=l.integrations)!=null&&l[o]&&((u=S.__PosthogExtensions__)==null||(u=u.integrations)==null||(u=u[o])==null||u.stop())};for(var[n,r]of Object.entries((s=this._instance.config.integrations)!==null&&s!==void 0?s:{})){var s;t(n)}}},Xi="[SessionRecording]",gt=U(Xi),hn=class{get started(){var e;return!((e=this.sr)==null||!e.isStarted)}get status(){return this.sr?this.sr.status:this.nr&&!this.ar?"disabled":"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.nr=!1,this.lr=void 0,this._instance=e,!this._instance.sessionManager)throw gt.error("started without valid sessionManager"),new Error(Xi+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(Xi+' cannot be used with cookieless_mode="always"')}get ar(){var e,t=!((e=this._instance.get_property(Rn))==null||!e.enabled),n=!this._instance.config.disable_session_recording,r=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return f&&t&&n&&!r}startIfEnabledOrStop(e){var t;if(!this.ar||(t=this.sr)==null||!t.isStarted){var n=!m(Object.assign)&&!m(Array.from);this.ar&&n?(this.ur(e),gt.info("starting")):this.stopRecording()}}ur(e){var t,n,r;this.ar&&(S!=null&&(t=S.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(n=S.__PosthogExtensions__)!=null&&n.initSessionRecording?this.hr(e):(r=S.__PosthogExtensions__)==null||r.loadExternalDependency==null||r.loadExternalDependency(this._instance,this.dr,s=>{if(s)return gt.error("could not load recorder",s);this.hr(e)}))}stopRecording(){var e,t;(e=this.lr)==null||e.call(this),this.lr=void 0,(t=this.sr)==null||t.stop()}vr(){var e;(e=this._instance.persistence)==null||e.unregister(Cs)}cr(e){if(this._instance.persistence){var t,n,r=this._instance.persistence,s=()=>{var o=e.sessionRecording===!1?void 0:e.sessionRecording,a=o?.sampleRate,l=F(a)?null:parseFloat(a);F(l)&&this.vr();var u=o?.minimumDurationMilliseconds;r.register({[Rn]:k({enabled:!!o},o,{networkPayloadCapture:k({capturePerformance:e.capturePerformance},o?.networkPayloadCapture),canvasRecording:{enabled:o?.recordCanvas,fps:o?.canvasFps,quality:o?.canvasQuality},sampleRate:l,minimumDurationMilliseconds:m(u)?null:u,endpoint:o?.endpoint,triggerMatchType:o?.triggerMatchType,masking:o?.masking,urlTriggers:o?.urlTriggers})})};s(),(t=this.lr)==null||t.call(this),this.lr=(n=this._instance.sessionManager)==null?void 0:n.onSessionId(s)}}onRemoteConfig(e){"sessionRecording"in e?e.sessionRecording!==!1?(this.cr(e),this.nr=!0,this.startIfEnabledOrStop()):this.nr=!0:gt.info("skipping remote config with no sessionRecording",e)}log(e,t){var n;t===void 0&&(t="log"),(n=this.sr)!=null&&n.log?this.sr.log(e,t):gt.warn("log called before recorder was ready")}get dr(){var e,t,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(Rn);return(n==null||(t=n.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}hr(e){var t,n;if((t=S.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this.sr||(this.sr=(n=S.__PosthogExtensions__)==null?void 0:n.initSessionRecording(this._instance),this.sr._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this.sr.start(e)}onRRwebEmit(e){var t;(t=this.sr)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e,t;this.sr||(t=this._instance.persistence)==null||t.register({$replay_override_linked_flag:!0}),(e=this.sr)==null||e.overrideLinkedFlag()}overrideSampling(){var e,t;this.sr||(t=this._instance.persistence)==null||t.register({$replay_override_sampling:!0}),(e=this.sr)==null||e.overrideSampling()}overrideTrigger(e){var t,n;this.sr||(n=this._instance.persistence)==null||n.register({[e==="url"?"$replay_override_url_trigger":"$replay_override_event_trigger"]:!0}),(t=this.sr)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this.sr)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var n;return!((n=this.sr)==null||!n.tryAddCustomEvent(e,t))}},St={},Yi=()=>{},Xe="posthog",yo=!cl&&Y?.indexOf("MSIE")===-1&&Y?.indexOf("Mozilla")===-1,ds=i=>{var e;return{api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:_a(y?.location),persistence:"localStorage+cookie",persistence_name:"",loaded:Yi,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:i!=="2025-05-24"||"history_change",capture_pageleave:"if_capture_pageview",defaults:i??"unset",debug:K&&B(K?.search)&&K.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(f==null||(e=f.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var n="Bad HTTP status: "+t.statusCode+" "+t.text;w.error(n)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:Bi},error_tracking:{},_onCapture:Yi,__preview_eager_load_replay:!1}},hs=i=>{var e={};m(i.process_person)||(e.person_profiles=i.process_person),m(i.xhr_headers)||(e.request_headers=i.xhr_headers),m(i.cookie_name)||(e.persistence_name=i.cookie_name),m(i.disable_cookie)||(e.disable_persistence=i.disable_cookie),m(i.store_google)||(e.save_campaign_params=i.store_google),m(i.verbose)||(e.debug=i.verbose);var t=N({},e,i);return $(i.property_blacklist)&&(m(i.property_denylist)?t.property_denylist=i.property_blacklist:$(i.property_denylist)?t.property_denylist=[...i.property_blacklist,...i.property_denylist]:w.error("Invalid value for property_denylist config: "+i.property_denylist)),t},Ki=class{constructor(){this.__forceAllowLocalhost=!1}get pr(){return this.__forceAllowLocalhost}set pr(e){w.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}},pn=class i{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new Ki,this.gr=!1,this.version=_e.LIB_VERSION,this._r=new It,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=ds(),this.SentryIntegration=yi,this.sentryIntegration=e=>function(t,n){var r=zs(t,n);return{name:Bs,processEvent:s=>r(s)}}(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.mr=!1,this.yr=null,this.br=null,this.wr=null,this.featureFlags=new Fi(this),this.toolbar=new bi(this),this.scrollManager=new qi(this),this.pageViewManager=new Ti(this),this.surveys=new Ni(this),this.experiments=new Wi(this),this.exceptions=new Oi(this),this.rateLimiter=new Mi(this),this.requestRouter=new Gi(this),this.consent=new vi(this),this.externalIntegrations=new Vi(this),this.people={set:(e,t,n)=>{var r=B(e)?{[e]:t}:e;this.setPersonProperties(r),n?.({})},set_once:(e,t,n)=>{var r=B(e)?{[e]:t}:e;this.setPersonProperties(void 0,r),n?.({})}},this.on("eventCaptured",e=>w.info('send "'+e?.event+'"',e))}init(e,t,n){if(n&&n!==Xe){var r,s=(r=St[n])!==null&&r!==void 0?r:new i;return s._init(e,t,n),St[n]=s,St[Xe][n]=s,s}return this._init(e,t,n)}_init(e,t,n){var r,s;if(t===void 0&&(t={}),m(e)||Hn(e))return w.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},t.debug=this.$r(t.debug),this.Sr=t,this.Er=[],t.person_profiles&&(this.br=t.person_profiles),this.set_config(N({},ds(t.defaults),hs(t),{name:n,token:e})),this.config.on_xhr_error&&w.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:be.GZipJS;var o=this.kr();this.persistence=new Et(this.config,o),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Et(k({},this.config,{persistence:"sessionStorage"}),o);var a=k({},this.persistence.props),l=k({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Pr=new zi(b=>this.Tr(b),this.config.request_queue_config),this.Rr=new Ui(this),this.__request_queue=[];var u=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(u||(this.sessionManager=new dn(this),this.sessionPropsManager=new un(this,this.sessionManager,this.persistence)),new wi(this).startIfEnabledOrStop(),this.siteApps=new Hi(this),(r=this.siteApps)==null||r.init(),u||(this.sessionRecording=new hn(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new hi(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new xi(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new Ci(this),this.exceptionObserver=new _i(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new sn(this,Da),this.deadClicksAutocapture.startIfEnabled(),this.historyAutocapture=new mi(this),this.historyAutocapture.startIfEnabled(),_e.DEBUG=_e.DEBUG||this.config.debug,_e.DEBUG&&w.info("Starting in debug mode",{this:this,config:t,thisC:k({},this.config),p:a,s:l}),((s=t.bootstrap)==null?void 0:s.distinctID)!==void 0){var c,h,d=this.config.get_device_id(Fe()),p=(c=t.bootstrap)!=null&&c.isIdentifiedID?d:t.bootstrap.distinctID;this.persistence.set_property(me,(h=t.bootstrap)!=null&&h.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:p})}if(this.Ir()){var g,v,_=Object.keys(((g=t.bootstrap)==null?void 0:g.featureFlags)||{}).filter(b=>{var C;return!((C=t.bootstrap)==null||(C=C.featureFlags)==null||!C[b])}).reduce((b,C)=>{var P;return b[C]=((P=t.bootstrap)==null||(P=P.featureFlags)==null?void 0:P[C])||!1,b},{}),E=Object.keys(((v=t.bootstrap)==null?void 0:v.featureFlagPayloads)||{}).filter(b=>_[b]).reduce((b,C)=>{var P,z;return(P=t.bootstrap)!=null&&(P=P.featureFlagPayloads)!=null&&P[C]&&(b[C]=(z=t.bootstrap)==null||(z=z.featureFlagPayloads)==null?void 0:z[C]),b},{});this.featureFlags.receivedFeatureFlags({featureFlags:_,featureFlagPayloads:E})}if(u)this.register_once({distinct_id:lt,$device_id:null},"");else if(!this.get_distinct_id()){var x=this.config.get_device_id(Fe());this.register_once({distinct_id:x,$device_id:x},""),this.persistence.set_property(me,"anonymous")}return M(f,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?Na(this,()=>this.Cr()):this.Cr(),$e(this.config._onCapture)&&this.config._onCapture!==Yi&&(w.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",b=>this.config._onCapture(b.event,b))),this.config.ip&&w.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}fi(e){var t,n,r,s,o,a,l,u;if(!y||!y.body)return w.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this.fi(e)},500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=R(e.supportedCompression,be.GZipJS)?be.GZipJS:R(e.supportedCompression,be.Base64)?be.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.br?this.br:"identified_only"}),(n=this.siteApps)==null||n.onRemoteConfig(e),(r=this.sessionRecording)==null||r.onRemoteConfig(e),(s=this.autocapture)==null||s.onRemoteConfig(e),(o=this.heatmaps)==null||o.onRemoteConfig(e),this.surveys.onRemoteConfig(e),(a=this.webVitalsAutocapture)==null||a.onRemoteConfig(e),(l=this.exceptionObserver)==null||l.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(u=this.deadClicksAutocapture)==null||u.onRemoteConfig(e)}Cr(){try{this.config.loaded(this)}catch(e){w.critical("`loaded` function failed",e)}this.Or(),this.config.capture_pageview&&setTimeout(()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.Fr()},1),new ji(this).load(),this.featureFlags.flags()}Or(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Pr)==null||e.enable())}_dom_loaded(){this.is_capturing()&&De(this.__request_queue,e=>this.Tr(e)),this.__request_queue=[],this.Or()}_handle_unload(){var e,t;this.config.request_batching?(this.Mr()&&this.capture("$pageleave"),(e=this.Pr)==null||e.unload(),(t=this.Rr)==null||t.unload()):this.Mr()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}ci(e){this.__loaded&&(yo?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=cn(e.url,{ip:this.config.ip?1:0}),e.headers=k({},this.config.request_headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var n,r,s,o=k({},t);o.timeout=o.timeout||6e4,o.url=cn(o.url,{_:new Date().getTime().toString(),ver:_e.LIB_VERSION,compression:o.compression});var a=(n=o.transport)!==null&&n!==void 0?n:"fetch",l=Gt.filter(c=>!o.disableTransport||!c.transport||!o.disableTransport.includes(c.transport)),u=(r=(s=ks(l,c=>c.transport===a))==null?void 0:s.method)!==null&&r!==void 0?r:l[0].method;if(!u)throw new Error("No available transport method");u(o)})(k({},e,{callback:t=>{var n,r;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((n=(r=this.config).on_request_error)==null||n.call(r,t)),e.callback==null||e.callback(t)}}))))}Tr(e){this.Rr?this.Rr.retriableRequest(e):this.ci(e)}_execute_array(e){var t,n=[],r=[],s=[];De(e,a=>{a&&(t=a[0],$(t)?s.push(a):$e(a)?a.call(this):$(a)&&t==="alias"?n.push(a):$(a)&&t.indexOf("capture")!==-1&&$e(this[t])?s.push(a):r.push(a))});var o=function(a,l){De(a,function(u){if($(u[0])){var c=l;A(u,function(h){c=c[h[0]].apply(c,h.slice(1))})}else this[u[0]].apply(this,u.slice(1))},l)};o(n,this),o(r,this),o(s,this)}Ir(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,n){var r;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Pr){if(this.is_capturing())if(!m(e)&&B(e)){var s=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(s&&!this.config.__preview_capture_bot_pageviews)){var o=n!=null&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(o==null||!o.isRateLimited){t!=null&&t.$current_url&&!B(t?.$current_url)&&(w.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var a=new Date,l=n?.timestamp||a,u=Fe(),c={uuid:u,event:e,properties:this.calculateEventProperties(e,t||{},l,u)};e==="$pageview"&&this.config.__preview_capture_bot_pageviews&&s&&(c.event="$bot_pageview",c.properties.$browser_type="bot"),o&&(c.properties.$lib_rate_limit_remaining_tokens=o.remainingTokens),n?.$set&&(c.$set=n?.$set);var h,d=this.Ar(n?.$set_once);if(d&&(c.$set_once=d),(c=fa(c,n!=null&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=l,m(n?.timestamp)||(c.properties.$event_time_override_provided=!0,c.properties.$event_time_override_system_time=a),e===Wt.DISMISSED||e===Wt.SENT){var p=t?.[as.SURVEY_ID],g=t?.[as.SURVEY_ITERATION];h={id:p,current_iteration:g},localStorage.getItem(ls(h))||localStorage.setItem(ls(h),"true"),c.$set=k({},c.$set,{[pl({id:p,current_iteration:g},e===Wt.SENT?"responded":"dismissed")]:!0})}var v=k({},c.properties.$set,c.$set);if(Ye(v)||this.setPersonPropertiesForFlags(v),!F(this.config.before_send)){var _=this.Dr(c);if(!_)return;c=_}this._r.emit("eventCaptured",c);var E={method:"POST",url:(r=n?._url)!==null&&r!==void 0?r:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:c,compression:"best-available",batchKey:n?._batchKey};return!this.config.request_batching||n&&(n==null||!n._batchKey)||n!=null&&n.send_instantly?this.Tr(E):this.Pr.enqueue(E),c}w.critical("This capture call is ignored due to client rate limiting.")}}else w.error("No event name provided to posthog.capture")}else w.uninitializedWarning("posthog.capture")}Mi(e){return this.on("eventCaptured",t=>e(t.event,t))}calculateEventProperties(e,t,n,r,s){if(n=n||new Date,!this.persistence||!this.sessionPersistence)return t;var o=s?void 0:this.persistence.remove_event_timer(e),a=k({},t);if(a.token=this.config.token,a.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(a.$cookieless_mode=!0),e==="$snapshot"){var l=k({},this.persistence.properties(),this.sessionPersistence.properties());return a.distinct_id=l.distinct_id,(!B(a.distinct_id)&&!ge(a.distinct_id)||Hn(a.distinct_id))&&w.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),a}var u,c=Qa(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:h,windowId:d}=this.sessionManager.checkAndGetSessionAndWindowId(s,n.getTime());a.$session_id=h,a.$window_id=d}this.sessionPropsManager&&N(a,this.sessionPropsManager.getSessionProps());try{var p;this.sessionRecording&&N(a,this.sessionRecording.sdkDebugProperties),a.$sdk_debug_retry_queue_size=(p=this.Rr)==null?void 0:p.length}catch(E){a.$sdk_debug_error_capturing_properties=String(E)}if(this.requestRouter.region===wt.CUSTOM&&(a.$lib_custom_api_host=this.config.api_host),u=e!=="$pageview"||s?e!=="$pageleave"||s?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(n):this.pageViewManager.doPageView(n,r),a=N(a,u),e==="$pageview"&&y&&(a.title=y.title),!m(o)){var g=n.getTime()-o;a.$duration=parseFloat((g/1e3).toFixed(3))}Y&&this.config.opt_out_useragent_filter&&(a.$browser_type=this._is_bot()?"bot":"browser"),(a=N({},c,this.persistence.properties(),this.sessionPersistence.properties(),a)).$is_identified=this._isIdentified(),$(this.config.property_denylist)?A(this.config.property_denylist,function(E){delete a[E]}):w.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var v=this.config.sanitize_properties;v&&(w.error("sanitize_properties is deprecated. Use before_send instead"),a=v(a,e));var _=this.jr();return a.$process_person_profile=_,_&&!s&&this.Lr("_calculate_event_properties"),a}Ar(e){var t;if(!this.persistence||!this.jr()||this.gr)return e;var n=this.persistence.get_initial_props(),r=(t=this.sessionPropsManager)==null?void 0:t.getSetOnceProps(),s=N({},n,r||{},e||{}),o=this.config.sanitize_properties;return o&&(w.error("sanitize_properties is deprecated. Use before_send instead"),s=o(s,"$set_once")),this.gr=!0,Ye(s)?void 0:s}register(e,t){var n;(n=this.persistence)==null||n.register(e,t)}register_once(e,t,n){var r;(r=this.persistence)==null||r.register_once(e,t,n)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}Nr(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch{return t}}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,t,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,n)}getEarlyAccessFeatures(e,t,n){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,n)}on(e,t){return this._r.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,n;return(t=(n=this.sessionManager)==null?void 0:n.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=fl),this.surveys.displaySurvey(e,t)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,n){if(!this.__loaded||!this.persistence)return w.uninitializedWarning("posthog.identify");if(ge(e)&&(e=e.toString(),w.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))w.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==lt){if(this.Lr("posthog.identify")){var r=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var s=r;this.register_once({$had_persisted_distinct_id:!0,$device_id:s},"")}e!==r&&e!==this.get_property(ft)&&(this.unregister(ft),this.register({distinct_id:e}));var o=(this.persistence.get_property(me)||"anonymous")==="anonymous";e!==r&&o?(this.persistence.set_property(me,"identified"),this.setPersonPropertiesForFlags(k({},n||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:r},{$set:t||{},$set_once:n||{}}),this.wr=is(e,t,n),this.featureFlags.setAnonymousDistinctId(r)):(t||n)&&this.setPersonProperties(t,n),e!==r&&(this.reloadFeatureFlags(),this.unregister(Kt))}}else w.critical('The string "'+lt+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else w.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.Lr("posthog.setPersonProperties")){var n=is(this.get_distinct_id(),e,t);this.wr!==n?(this.setPersonPropertiesForFlags(k({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.wr=n):w.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,n){if(e&&t){if(this.Lr("posthog.group")){var r=this.getGroups();r[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:k({},r,{[e]:t})}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags({[e]:n})),r[e]===t||n||this.reloadFeatureFlags()}}else w.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.Lr("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,n,r,s;if(w.info("reset"),!this.__loaded)return w.uninitializedWarning("posthog.reset");var o=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(n=this.sessionPersistence)==null||n.clear(),this.surveys.reset(),this.featureFlags.reset(),(r=this.persistence)==null||r.set_property(me,"anonymous"),(s=this.sessionManager)==null||s.resetSessionId(),this.wr=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:lt,$device_id:null},"");else{var a=this.config.get_device_id(Fe());this.register_once({distinct_id:a,$device_id:e?a:o},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:n}=this.sessionManager.checkAndGetSessionAndWindowId(!0),r=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&n){var s,o=(s=e.timestampLookBack)!==null&&s!==void 0?s:10;if(!n)return r;r+="?t="+Math.max(Math.floor((new Date().getTime()-n)/1e3)-o,0)}return r}alias(e,t){return e===this.get_property(Es)?(w.critical("Attempting to create alias for existing People user - aborting."),-2):this.Lr("posthog.alias")?(m(t)&&(t=this.get_distinct_id()),e!==t?(this.Nr(ft,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(w.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=k({},this.config);if(G(e)){var n,r,s,o,a;N(this.config,hs(e));var l=this.kr();(n=this.persistence)==null||n.update_config(this.config,t,l),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Et(k({},this.config,{persistence:"sessionStorage"}),l);var u=this.$r(this.config.debug);Le(u)&&(this.config.debug=u),Le(this.config.debug)&&(this.config.debug?(_e.DEBUG=!0,L.H()&&L.G("ph_debug","true"),w.info("set_config",{config:e,oldConfig:t,newConfig:k({},this.config)})):(_e.DEBUG=!1,L.H()&&L.V("ph_debug"))),(r=this.sessionRecording)==null||r.startIfEnabledOrStop(),(s=this.autocapture)==null||s.startIfEnabled(),(o=this.heatmaps)==null||o.startIfEnabled(),this.surveys.loadIfEnabled(),this.Ur(),(a=this.externalIntegrations)==null||a.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,n={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(n).some(Boolean)){var r,s,o,a,l;(r=this.sessionManager)==null||r.checkAndGetSessionAndWindowId(),n.sampling&&((s=this.sessionRecording)==null||s.overrideSampling()),n.linked_flag&&((o=this.sessionRecording)==null||o.overrideLinkedFlag()),n.url_trigger&&((a=this.sessionRecording)==null||a.overrideTrigger("url")),n.event_trigger&&((l=this.sessionRecording)==null||l.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var n=new Error("PostHog syntheticException"),r=this.exceptions.buildProperties(e,{handled:!0,syntheticException:n});return this.exceptions.sendExceptionEvent(k({},r,t))}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:Xe;return t!==Xe&&(t=Xe+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(me))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(me))==="identified"}jr(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Ye(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[ft])&&((t=this.persistence)==null||(t=t.props)==null||!t[Zt]))}Mr(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.jr()||this.Lr("posthog.createPersonProfile")&&this.setPersonProperties({},{})}Lr(e){return this.config.person_profiles==="never"?(w.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.Nr(Zt,!0),!0)}kr(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}Ur(){var e,t,n,r,s=this.kr();return((e=this.persistence)==null?void 0:e.wi)!==s&&((n=this.persistence)==null||n.set_disabled(s)),((t=this.sessionPersistence)==null?void 0:t.wi)!==s&&((r=this.sessionPersistence)==null||r.set_disabled(s)),s}opt_in_capturing(e){if(this.config.cookieless_mode!=="always"){var t,n;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),(t=this.sessionManager)==null||t.destroy(),this.sessionManager=new dn(this),this.persistence&&(this.sessionPropsManager=new un(this,this.sessionManager,this.persistence)),this.sessionRecording=new hn(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this.Ur(),this.Or(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(m(e?.captureEventName)||e!=null&&e.captureEventName)&&this.capture((n=e?.captureEventName)!==null&&n!==void 0?n:"$opt_in",e?.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.Fr()}else w.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e,t;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this.Ur(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:lt,$device_id:null}),(e=this.sessionManager)==null||e.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,(t=this.sessionRecording)==null||t.stopRecording(),this.sessionRecording=void 0,this.Fr())):w.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===ye.GRANTED?"granted":e===ye.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this.Ur()}_is_bot(){return ee?mo(ee,this.config.custom_blocked_useragents):void 0}Fr(){y&&(y.visibilityState==="visible"?this.mr||(this.mr=!0,this.capture("$pageview",{title:y.title},{send_instantly:!0}),this.yr&&(y.removeEventListener("visibilitychange",this.yr),this.yr=null)):this.yr||(this.yr=this.Fr.bind(this),M(y,"visibilitychange",this.yr)))}debug(e){e===!1?(f?.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(f?.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}M(){var e,t,n,r,s,o,a,l=this.Sr||{};return"advanced_disable_flags"in l?!!l.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(w.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(n="advanced_disable_decide",r=!1,s=w,o=(t="advanced_disable_flags")in(e=l)&&!m(e[t]),a=n in e&&!m(e[n]),o?e[t]:a?(s&&s.warn("Config field '"+n+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[n]):r)}Dr(e){if(F(this.config.before_send))return e;var t=$(this.config.before_send)?this.config.before_send:[this.config.before_send],n=e;for(var r of t){if(n=r(n),F(n)){var s="Event '"+e.event+"' was rejected in beforeSend function";return Zo(e.event)?w.warn(s+". This can cause unexpected behavior."):w.info(s),null}n.properties&&!Ye(n.properties)||w.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return n}getPageViewId(){var e;return(e=this.pageViewManager.Vt)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,n){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(n)})}$r(e){var t=Le(e)&&!e,n=L.H()&&L.q("ph_debug")==="true";return!t&&(!!n||e)}};(function(i,e){for(var t=0;t<e.length;t++)i.prototype[e[t]]=ga(i.prototype[e[t]])})(pn,["identify"]);var ps,st=(ps=St[Xe]=new pn,function(){function i(){i.done||(i.done=!0,yo=!1,A(St,function(e){e._dom_loaded()}))}y!=null&&y.addEventListener?y.readyState==="complete"?i():M(y,"DOMContentLoaded",i,{capture:!1}):f&&w.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),ps);var mn={common:{acceptAll:"Accept All",rejectAll:"Reject All",customize:"Customize",save:"Save Settings"},cookieBanner:{title:"We value your privacy",description:"This site uses cookies to improve your browsing experience, analyze site traffic, and show personalized content."},consentManagerDialog:{title:"Privacy Settings",description:"Customize your privacy settings here. You can choose which types of cookies and tracking technologies you allow."},consentTypes:{necessary:{title:"Strictly Necessary",description:"These cookies are essential for the website to function properly and cannot be disabled."},functionality:{title:"Functionality",description:"These cookies enable enhanced functionality and personalization of the website."},marketing:{title:"Marketing",description:"These cookies are used to deliver relevant advertisements and track their effectiveness."},measurement:{title:"Analytics",description:"These cookies help us understand how visitors interact with the website and improve its performance."},experience:{title:"Experience",description:"These cookies help us provide a better user experience and test new features."}},frame:{title:"Accept {category} consent to view this content.",actionButton:"Enable {category} consent"}};function bo(i,e){return["cookieBanner","consentManagerDialog","common","consentTypes","frame"].reduce((n,r)=>(n[r]={...i[r],...e[r]||{}},n),{})}function wo(i,e){let t={en:JSON.parse(JSON.stringify(mn))},n=[i.translations,e?.translations];for(let r of n)if(r)for(let[s,o]of Object.entries(r)){if(!o)continue;let a=t[s]||t.en;t[s]=bo(a,o)}return{...i,...e,translations:t}}function ko(i,e,t=!1){if(t||typeof window>"u")return e||"en";let n=window.navigator.language?.split("-")[0]||"";return n&&n in i?n:e||"en"}function Eo(i,e){let t=wo(i,e),n=ko(t.translations,t.defaultLanguage,t.disableAutoLanguageSwitch);return{...t,defaultLanguage:n}}var So=i=>{let e,t=new Set,n=(u,c)=>{let h=typeof u=="function"?u(e):u;if(!Object.is(h,e)){let d=e;e=c??(typeof h!="object"||h===null)?h:Object.assign({},e,h),t.forEach(p=>p(e,d))}},r=()=>e,a={setState:n,getState:r,getInitialState:()=>l,subscribe:u=>(t.add(u),()=>t.delete(u))},l=e=i(n,r,a);return a},Co=i=>i?So(i):So;var ot={SHOW_CONSENT_BANNER:"/show-consent-banner",SET_CONSENT:"/consent/set",VERIFY_CONSENT:"/consent/verify"},ke={maxRetries:3,initialDelayMs:100,backoffFactor:2,retryableStatusCodes:[500,502,503,504],nonRetryableStatusCodes:[400,401,403,404],retryOnNetworkError:!0,shouldRetry:void 0},Sl=/^(?:[a-z+]+:)?\/\//i,xo=/^\/+/,To=/\/+$/,ar=i=>new Promise(e=>setTimeout(e,i));function Cl(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{let e=16*Math.random()|0;return(i==="x"?e:3&e|8).toString(16)})}var wn=class{constructor(e){Re(this,"backendURL");Re(this,"headers");Re(this,"customFetch");Re(this,"corsMode");Re(this,"retryConfig");this.backendURL=e.backendURL.endsWith("/")?e.backendURL.slice(0,-1):e.backendURL,this.headers={"Content-Type":"application/json",...e.headers},this.customFetch=e.customFetch,this.corsMode=e.corsMode||"cors",this.retryConfig={maxRetries:e.retryConfig?.maxRetries??ke.maxRetries??3,initialDelayMs:e.retryConfig?.initialDelayMs??ke.initialDelayMs??100,backoffFactor:e.retryConfig?.backoffFactor??ke.backoffFactor??2,retryableStatusCodes:e.retryConfig?.retryableStatusCodes??ke.retryableStatusCodes,nonRetryableStatusCodes:e.retryConfig?.nonRetryableStatusCodes??ke.nonRetryableStatusCodes,shouldRetry:e.retryConfig?.shouldRetry??ke.shouldRetry,retryOnNetworkError:e.retryConfig?.retryOnNetworkError??ke.retryOnNetworkError},this.checkPendingConsentSubmissions()}resolveUrl(e,t){if(Sl.test(e)){let s=new URL(e),o=s.pathname.replace(To,""),a=t.replace(xo,""),l=`${o}/${a}`;return s.pathname=l,s.toString()}let n=e.replace(To,""),r=t.replace(xo,"");return`${n}/${r}`}createResponseContext(e,t=null,n=null,r=null){return{data:t,error:n,ok:e,response:r}}async fetcher(e,t){let n={...this.retryConfig,...t?.retryConfig||{},retryableStatusCodes:t?.retryConfig?.retryableStatusCodes??this.retryConfig.retryableStatusCodes??ke.retryableStatusCodes,nonRetryableStatusCodes:t?.retryConfig?.nonRetryableStatusCodes??this.retryConfig.nonRetryableStatusCodes??ke.nonRetryableStatusCodes},{maxRetries:r,initialDelayMs:s,backoffFactor:o,retryableStatusCodes:a,nonRetryableStatusCodes:l,retryOnNetworkError:u}=n,c=0,h=s,d=null;for(;c<=(r??0);){let g=Cl(),v=this.customFetch||globalThis.fetch,_=this.resolveUrl(this.backendURL,e),E;try{E=new URL(_)}catch{E=new URL(_,window.location.origin)}if(t?.query)for(let[b,C]of Object.entries(t.query))C!==void 0&&E.searchParams.append(b,String(C));let x={method:t?.method||"GET",mode:this.corsMode,credentials:"include",headers:{...this.headers,"X-Request-ID":g,...t?.headers},...t?.fetchOptions};t?.body&&x.method!=="GET"&&(x.body=JSON.stringify(t.body));try{let b=await v(E.toString(),x),C=null,P=null;try{b.headers.get("content-type")?.includes("application/json")&&b.status!==204&&b.headers.get("content-length")!=="0"?C=await b.json():b.status===204&&(C=null)}catch(D){P=D}if(P){let D=this.createResponseContext(!1,null,{message:"Failed to parse response",status:b.status,code:"PARSE_ERROR",cause:P},b);if(t?.onError?.(D,e),t?.throw)throw new Error("Failed to parse response");return D}if(b.status>=200&&b.status<300){let D=this.createResponseContext(!0,C,null,b);return t?.onSuccess?.(D),D}let q=C,T=this.createResponseContext(!1,null,{message:q?.message||`Request failed with status ${b.status}`,status:b.status,code:q?.code||"API_ERROR",details:q?.details||null},b);d=T;let j=!1;if(l?.includes(b.status))console.debug(`Not retrying request to ${e} with status ${b.status} (nonRetryableStatusCodes)`),j=!1;else if(typeof n.shouldRetry=="function")try{j=n.shouldRetry(b,{attemptsMade:c,url:E.toString(),method:x.method||"GET"}),console.debug(`Custom retry strategy for ${e} with status ${b.status}: ${j}`)}catch{j=a?.includes(b.status)??!1,console.debug(`Custom retry strategy failed, falling back to status code check: ${j}`)}else j=a?.includes(b.status)??!1,console.debug(`Standard retry check for ${e} with status ${b.status}: ${j}`);if(!j||c>=(r??0)){if(t?.onError?.(T,e),t?.throw)throw new Error(T.error?.message||"Request failed");return T}c++,await ar(h??0),h=(h??0)*(o??2)}catch(b){if(b&&b.message==="Failed to parse response")throw b;let C=!(b instanceof Response),P=this.createResponseContext(!1,null,{message:b instanceof Error?b.message:String(b),status:0,code:"NETWORK_ERROR",cause:b},null);if(d=P,!(C&&u)||c>=(r??0)){if(t?.onError?.(P,e),t?.throw)throw b;return P}c++,await ar(h??0),h=(h??0)*(o??2)}}let p=d||this.createResponseContext(!1,null,{message:`Request failed after ${r} retries`,status:0,code:"MAX_RETRIES_EXCEEDED"},null);if(t?.onError?.(p,e),t?.throw)throw new Error(`Request failed after ${r} retries`);return p}async showConsentBanner(e){try{let t=await this.fetcher(ot.SHOW_CONSENT_BANNER,{method:"GET",...e});return t.ok||e?.testing?t:(console.warn("API request failed, falling back to offline mode for consent banner"),this.offlineFallbackForConsentBanner(e))}catch(t){if(e?.testing||e?.disableFallback){let n=this.createResponseContext(!1,null,{message:t instanceof Error?t.message:String(t),status:0,code:"NETWORK_ERROR",cause:t},null);return e?.onError&&await e.onError(n,ot.SHOW_CONSENT_BANNER),n}return console.warn("Error fetching consent banner info, falling back to offline mode:",t),this.offlineFallbackForConsentBanner(e)}}async offlineFallbackForConsentBanner(e){let t=!0,n=!1;try{typeof window<"u"&&window.localStorage&&(window.localStorage.setItem("c15t-storage-test-key","test"),window.localStorage.removeItem("c15t-storage-test-key"),n=!0,t=window.localStorage.getItem("c15t-consent")===null)}catch(s){console.warn("Failed to access localStorage in offline fallback:",s),t=!1}let r=this.createResponseContext(!0,{showConsentBanner:t&&n,jurisdiction:{code:"NONE",message:"Unknown (offline mode)"},location:{countryCode:null,regionCode:null},translations:mn},null,null);return e?.onSuccess&&await e.onSuccess(r),r}async setConsent(e){try{let t=await this.fetcher(ot.SET_CONSENT,{method:"POST",...e});return t.ok&&t.data||e?.testing?t:(console.warn("API request failed, falling back to offline mode for setting consent"),this.offlineFallbackForSetConsent(e))}catch(t){if(e?.testing||e?.disableFallback){let n=this.createResponseContext(!1,null,{message:t instanceof Error?t.message:String(t),status:0,code:"NETWORK_ERROR",cause:t},null);return e?.onError&&await e.onError(n,ot.SET_CONSENT),n}return console.warn("Error setting consent, falling back to offline mode:",t),this.offlineFallbackForSetConsent(e)}}async offlineFallbackForSetConsent(e){let t="c15t-pending-consent-submissions";try{if(typeof window<"u"&&window.localStorage&&(window.localStorage.setItem("c15t-storage-test-key","test"),window.localStorage.removeItem("c15t-storage-test-key"),window.localStorage.setItem("c15t-consent",JSON.stringify({timestamp:new Date().toISOString(),preferences:e?.body?.preferences||{}})),e?.body)){let r=[];try{let a=window.localStorage.getItem(t);a&&(r=JSON.parse(a))}catch(a){console.warn("Error parsing pending submissions:",a),r=[]}let s=e.body;r.some(a=>JSON.stringify(a)===JSON.stringify(s))||(r.push(s),window.localStorage.setItem(t,JSON.stringify(r)),console.log("Queued consent submission for retry on next page load"))}}catch(r){console.warn("Failed to write to localStorage in offline fallback:",r)}let n=this.createResponseContext(!0,null,null,null);return e?.onSuccess&&await e.onSuccess(n),n}async verifyConsent(e){return await this.fetcher(ot.VERIFY_CONSENT,{method:"POST",...e})}async $fetch(e,t){return await this.fetcher(e,t)}checkPendingConsentSubmissions(){let e="c15t-pending-consent-submissions";if(!(typeof window>"u"||!window.localStorage))try{window.localStorage.setItem("c15t-storage-test-key","test"),window.localStorage.removeItem("c15t-storage-test-key");let t=window.localStorage.getItem(e);if(!t)return;let n=JSON.parse(t);if(!n.length)return void window.localStorage.removeItem(e);console.log(`Found ${n.length} pending consent submission(s) to retry`),setTimeout(()=>{this.processPendingSubmissions(n)},2e3)}catch(t){console.warn("Failed to check for pending consent submissions:",t)}}async processPendingSubmissions(e){let t="c15t-pending-consent-submissions",r=[...e];for(let s=0;s<3&&r.length>0;s++){let o=[];for(let a=0;a<r.length;a++){let l=r[a];try{console.log("Retrying consent submission:",l),(await this.fetcher(ot.SET_CONSENT,{method:"POST",body:l})).ok&&(console.log("Successfully resubmitted consent"),o.push(a))}catch(u){console.warn("Failed to resend consent submission:",u)}}for(let a=o.length-1;a>=0;a--){let l=o[a];l!==void 0&&r.splice(l,1)}if(r.length===0)break;s<2&&await ar(1e3*(s+1))}try{typeof window<"u"&&window.localStorage&&(r.length>0?(window.localStorage.setItem(t,JSON.stringify(r)),console.log(`${r.length} consent submissions still pending for future retry`)):(window.localStorage.removeItem(t),console.log("All pending consent submissions processed successfully")))}catch(s){console.warn("Error updating pending submissions storage:",s)}}},xl=/^\/+/,ur=class{constructor(e){Re(this,"endpointHandlers");Re(this,"dynamicHandlers",{});this.endpointHandlers=e.endpointHandlers}createErrorResponse(e,t=500,n="HANDLER_ERROR",r){return{data:null,error:{message:e,status:t,code:n,cause:r},ok:!1,response:null}}async executeHandler(e,t){let n=this.endpointHandlers[e];if(!n){let r=this.createErrorResponse(`No endpoint handler found for '${String(e)}'`,404,"ENDPOINT_NOT_FOUND");if(t?.throw)throw new Error(`No endpoint handler found for '${String(e)}'`);return r}try{let r=await n(t);return{data:r.data,error:r.error,ok:r.ok??!r.error,response:r.response}}catch(r){let s=this.createErrorResponse(r instanceof Error?r.message:String(r),0,"HANDLER_ERROR",r);if(t?.throw)throw r;return s}}async showConsentBanner(e){return await this.executeHandler("showConsentBanner",e)}async setConsent(e){return await this.executeHandler("setConsent",e)}async verifyConsent(e){return await this.executeHandler("verifyConsent",e)}registerHandler(e,t){this.dynamicHandlers[e]=t}async $fetch(e,t){let n=e.replace(xl,"").split("/")[0];if(e in this.dynamicHandlers){let r=this.dynamicHandlers[e];try{return await r(t)}catch(s){return this.createErrorResponse(s instanceof Error?s.message:String(s),0,"HANDLER_ERROR",s)}}return!n||!(n in this.endpointHandlers)?this.createErrorResponse(`No endpoint handler found for '${e}'`,404,"ENDPOINT_NOT_FOUND"):await this.executeHandler(n,t)}},bn={translations:{en:mn},defaultLanguage:"en",disableAutoLanguageSwitch:!1},dr=class{createResponseContext(e=null){return{data:e,error:null,ok:!0,response:null}}async handleOfflineResponse(e){let t=this.createResponseContext();return e?.onSuccess&&await e.onSuccess(t),t}async showConsentBanner(e){let t=!0;try{typeof window<"u"&&window.localStorage&&(window.localStorage.setItem("c15t-storage-test-key","test"),window.localStorage.removeItem("c15t-storage-test-key"),t=window.localStorage.getItem("c15t-consent")===null)}catch(r){console.warn("Failed to access localStorage:",r),t=!1}let n=this.createResponseContext({showConsentBanner:t,jurisdiction:{code:"GDPR",message:"EU"},branding:"c15t",location:{countryCode:"GB",regionCode:null},translations:{language:bn.defaultLanguage,translations:bn.translations[bn.defaultLanguage??"en"]}});return e?.onSuccess&&await e.onSuccess(n),n}async setConsent(e){try{typeof window<"u"&&window.localStorage&&(window.localStorage.setItem("c15t-storage-test-key","test"),window.localStorage.removeItem("c15t-storage-test-key"),window.localStorage.setItem("c15t-consent",JSON.stringify({timestamp:new Date().toISOString(),preferences:e?.body?.preferences||{}})))}catch(t){console.warn("Failed to write to localStorage:",t)}return await this.handleOfflineResponse(e)}async verifyConsent(e){return await this.handleOfflineResponse(e)}async $fetch(e,t){return await this.handleOfflineResponse(t)}},Tl="/api/c15t",Rl="c15t",yn=new Map;function Pl(i){if(i.mode==="offline")return"offline";if(i.mode==="custom")return`custom:${Object.keys(i.endpointHandlers||{}).sort().join(",")}`;let e="";return"headers"in i&&i.headers&&(e=`:headers:${Object.keys(i.headers).sort().map(n=>`${n}=${i.headers?.[n]}`).join(",")}`),`c15t:${i.backendURL||""}${e}`}function Ao(i){let e=Pl(i);if(yn.has(e)){if(i.mode!=="offline"&&i.mode!=="custom"&&"headers"in i&&i.headers){let s=yn.get(e);s instanceof wn&&(s.headers={"Content-Type":"application/json",...i.headers})}let r=yn.get(e);if(r)return new Proxy(r,{get(s,o){return s[o]}})}let t=i.mode||Rl,n;switch(t){case"custom":{let r=i;n=new ur({endpointHandlers:r.endpointHandlers});break}case"offline":n=new dr;break;default:{let r=i;n=new wn({backendURL:r.backendURL||Tl,headers:r.headers,customFetch:r.customFetch,retryConfig:r.retryConfig});break}}return yn.set(e,n),n}var Ft=[{defaultValue:!0,description:"These trackers are used for activities that are strictly necessary to operate or deliver the service you requested from us and, therefore, do not require you to consent.",disabled:!0,display:!0,gdprType:1,name:"necessary"},{defaultValue:!1,description:"These trackers enable basic interactions and functionalities that allow you to access selected features of our service and facilitate your communication with us.",display:!1,gdprType:2,name:"functionality"},{defaultValue:!1,description:"These trackers help us to measure traffic and analyze your behavior to improve our service.",display:!1,gdprType:4,name:"measurement"},{defaultValue:!1,description:"These trackers help us to improve the quality of your user experience and enable interactions with external content, networks, and platforms.",display:!1,gdprType:3,name:"experience"},{defaultValue:!1,description:"These trackers help us to deliver personalized ads or marketing content to you, and to measure their performance.",display:!1,gdprType:5,name:"marketing"}],hr=Ft.map(i=>i.name);function Oo(i,e){if(i.length===0)throw new TypeError(`${e} condition cannot be empty`)}function Il(i,e){if(!(i in e))throw new Error(`Consent category "${i}" not found in consent state`);return e[i]||!1}function Al(i,e){let t=Array.isArray(i)?i:[i];return Oo(t,"AND"),t.every(n=>kn(n,e))}function Ol(i,e){let t=Array.isArray(i)?i:[i];return Oo(t,"OR"),t.some(n=>kn(n,e))}function kn(i,e){if(typeof i=="string")return Il(i,e);if(typeof i=="object"&&i!==null){if("and"in i)return Al(i.and,e);if("or"in i)return Ol(i.or,e);if("not"in i)return!kn(i.not,e)}throw new TypeError(`Invalid condition structure: ${JSON.stringify(i)}`)}function Z(i,e){return kn(i,e)}function Fo(i){let e=new Set;function t(n){if(typeof n=="string")return void e.add(n);typeof n=="object"&&n!==null&&("and"in n?(Array.isArray(n.and)?n.and:[n.and]).forEach(t):"or"in n?(Array.isArray(n.or)?n.or:[n.or]).forEach(t):"not"in n&&t(n.not))}return t(i),Array.from(e)}function Fl(i){let e=i.getAttribute("data-category");if(e){if(!hr.includes(e))throw new Error(`Invalid category attribute "${e}" on iframe. Must be one of: ${hr.join(", ")}`);return e}}function pr(i,e){let t=i.getAttribute("data-src"),n=Fl(i);if(!n)return;Z(n,e)?t&&!i.src&&(i.src=t,i.removeAttribute("data-src")):i.src&&i.removeAttribute("src")}function $o(){if(typeof document>"u")return[];let i=document.querySelectorAll("iframe[data-category]"),e=new Set;return i?(i.forEach(t=>{let n=t.getAttribute("data-category");if(!n)return;let r=n.trim();hr.includes(r)&&e.add(r)}),Array.from(e)):[]}function Ro(i){if(typeof document>"u")return;let e=document.querySelectorAll("iframe");e&&e.forEach(t=>{pr(t,i)})}function $l(i,e){let t=new MutationObserver(n=>{let r=i(),s=!1;if(n.forEach(o=>{o.addedNodes.forEach(a=>{if(a.nodeType===Node.ELEMENT_NODE){let l=a;l.tagName&&l.tagName.toUpperCase()==="IFRAME"&&(pr(l,r),l.hasAttribute("data-category")&&(s=!0));let u=l.querySelectorAll?.("iframe");u&&u.length>0&&u.forEach(c=>{pr(c,r),c.hasAttribute("data-category")&&(s=!0)})}})}),s&&e){let o=$o();o.length>0&&e(o)}});return t.observe(document.body,{childList:!0,subtree:!0}),t}function Lo(){if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID().replace(/-/g,"").substring(0,8);if(typeof crypto<"u"&&crypto.getRandomValues){let e=new Uint8Array(4);return crypto.getRandomValues(e),Array.from(e,t=>t.toString(36)).join("").padEnd(8,"0").substring(0,8)}return Math.random().toString(36).substring(2).padEnd(8,"0").substring(0,8)}function lr(i,e,t){return e?(t[i]||(t[i]=Lo()),t[i]):`c15t-script-${i}`}var $t=new Map;function Lt(i){return $t.has(i)}function gr(i){return $t.get(i)}function cr(i,e){$t.set(i,e)}function at(i){$t.delete(i)}function Ll(){return $t}function Do(i,e,t={}){let n=[];return i.forEach(r=>{if(!r.alwaysLoad&&!Z(r.category,e))return;if(Lt(r.id))return void r.onConsentChange?.({id:r.id,elementId:lr(r.id,r.anonymizeId!==!1,t),hasConsent:Z(r.category,e),consents:e});if(r.src&&r.textContent)throw new Error(`Script '${r.id}' cannot have both 'src' and 'textContent'. Choose one.`);if(!r.src&&!r.textContent&&!r.callbackOnly)throw new Error(`Script '${r.id}' must have either 'src', 'textContent', or 'callbackOnly' set to true.`);if(r.callbackOnly===!0){let u=r.anonymizeId!==!1,c=lr(r.id,u,t),h={id:r.id,elementId:c,consents:e,hasConsent:Z(r.category,e)};r.onBeforeLoad&&r.onBeforeLoad(h),r.onLoad&&r.onLoad(h),cr(r.id,null),n.push(r.id);return}let s=r.anonymizeId!==!1,o=lr(r.id,s,t);if(r.persistAfterConsentRevoked===!0){let u=document.getElementById(o);if(u){let c={id:r.id,hasConsent:Z(r.category,e),elementId:o,consents:e,element:u};r.onConsentChange?.(c),r.onLoad?.(c),cr(r.id,u),n.push(r.id);return}}let a=document.createElement("script");a.id=o,r.src?a.src=r.src:r.textContent&&(a.textContent=r.textContent),r.fetchPriority&&(a.fetchPriority=r.fetchPriority),r.async&&(a.async=!0),r.defer&&(a.defer=!0),r.nonce&&(a.nonce=r.nonce),r.attributes&&Object.entries(r.attributes).forEach(([u,c])=>{a.setAttribute(u,c)});let l={id:r.id,hasConsent:Z(r.category,e),elementId:o,consents:e,element:a};r.onLoad&&(r.textContent?setTimeout(()=>{r.onLoad?.({...l})},0):a.addEventListener("load",()=>{r.onLoad?.({...l})})),r.onError&&(r.textContent||a.addEventListener("error",()=>{r.onError?.({...l,error:new Error(`Failed to load script: ${r.src}`)})})),r.onBeforeLoad&&r.onBeforeLoad(l),document.head.appendChild(a),cr(r.id,a),n.push(r.id)}),n}function Dl(i,e,t={}){let n=[];return i.forEach(r=>{if(Lt(r.id)&&!r.alwaysLoad&&!Z(r.category,e)){let s=gr(r.id),o=t[r.id]||`c15t-script-${r.id}`;if(r.callbackOnly===!0||s===null){let a={id:r.id,elementId:o,consents:e,hasConsent:Z(r.category,e)};r.onDelete&&r.onDelete(a),at(r.id),n.push(r.id)}else if(s){let a={id:r.id,elementId:o,consents:e,hasConsent:Z(r.category,e),element:s};r.onDelete&&r.onDelete(a),r.persistAfterConsentRevoked?(at(r.id),n.push(r.id)):(s.remove(),at(r.id),n.push(r.id))}}}),n}function Nl(i,e,t={}){let n=Dl(i,e,t);return{loaded:Do(i,e,t),unloaded:n}}function Ml(i){return Lt(i)}function jl(){return Array.from(Ll().keys())}function Bl(i,e,t,n={}){let r=e.find(s=>s.id===i);if(!r)return!1;if(Lt(i)){let s=gr(i),o=n[i]||`c15t-script-${i}`;if(r.callbackOnly===!0||s===null){let a={id:i,elementId:o,consents:t,hasConsent:Z(r.category,t)};r.onDelete&&r.onDelete(a),at(i)}else if(s){let a={id:i,elementId:o,consents:t,hasConsent:Z(r.category,t),element:s};r.onDelete&&r.onDelete(a),r.persistAfterConsentRevoked||s.remove(),at(i)}}return!r.alwaysLoad&&!Z(r.category,t)?!1:(Do([r],t,n),!0)}function zl(i,e,t){let n=()=>{let{scripts:r,consents:s,scriptIdMap:o}=i(),a=Nl(r,s,o),l={...i().loadedScripts};return a.loaded.forEach(u=>{l[u]=!0}),a.unloaded.forEach(u=>{l[u]=!1}),e({loadedScripts:l}),a};return{updateScripts:()=>n(),setScripts:r=>{t&&t.destroy();let s=i(),o={...s.scriptIdMap};r.forEach(u=>{u.anonymizeId!==!1&&(o[u.id]=Lo())});let a=r.flatMap(u=>Fo(u.category)),l=[...new Set([...s.gdprTypes,...a])];e({scripts:[...s.scripts,...r],scriptIdMap:o,gdprTypes:l}),n()},removeScript:r=>{let s=i(),o=s.scripts.find(l=>l.id===r);if(Lt(r)){let l=gr(r);if(l){let u=s.scriptIdMap[r]||`c15t-script-${r}`,c={id:r,elementId:u,consents:s.consents,element:l,hasConsent:Z(o?.category??"necessary",s.consents)};o?.onDelete&&o.onDelete(c),l.remove(),at(r)}}let a={...s.scriptIdMap};delete a[r],e({scripts:s.scripts.filter(l=>l.id!==r),loadedScripts:{...s.loadedScripts,[r]:!1},scriptIdMap:a})},reloadScript:r=>{let s=i();return Bl(r,s.scripts,s.consents,s.scriptIdMap)},isScriptLoaded:r=>Ml(r),getLoadedScriptIds:()=>jl()}}var Ul={"www.google-analytics.com":"measurement","analytics.google.com":"measurement","www.googletagmanager.com":"measurement","stats.g.doubleclick.net":"measurement","ampcid.google.com":"measurement","analytics.twitter.com":"measurement","analytics.pinterest.com":"measurement","dc.services.visualstudio.com":"measurement","www.clarity.ms":"measurement","www.hotjar.com":"measurement","static.hotjar.com":"measurement","script.hotjar.com":"measurement","insights.hotjar.com":"measurement","mouseflow.com":"measurement","api.mouseflow.com":"measurement","tools.mouseflow.com":"measurement","cdn.heapanalytics.com":"measurement","plausible.io":"measurement","matomo.cloud":"measurement","matomo.org":"measurement","mixpanel.com":"measurement","api.mixpanel.com":"measurement","sentry.io":"measurement","browser.sentry-cdn.com":"measurement","js.monitor.azure.com":"measurement","stats.wp.com":"measurement","pixel.wp.com":"measurement","analytics.amplitude.com":"measurement","api2.amplitude.com":"measurement","cdn.amplitude.com":"measurement","api.segment.io":"measurement","cdn.segment.com":"measurement","api.segment.com":"measurement","pendo.io":"measurement","data.pendo.io":"measurement","cdn.pendo.io":"measurement","connect.facebook.net":"marketing","platform.twitter.com":"marketing","platform.linkedin.com":"marketing","www.googleadservices.com":"marketing","doubleclick.net":"marketing","googleads.g.doubleclick.net":"marketing","ad.doubleclick.net":"marketing","www.facebook.com":"marketing","ads.linkedin.com":"marketing","ads-api.tiktok.com":"marketing","analytics.tiktok.com":"marketing","business.tiktok.com":"marketing","ads.pinterest.com":"marketing","log.pinterest.com":"marketing","ads-twitter.com":"marketing","static.ads-twitter.com":"marketing","advertising.twitter.com":"marketing","ads.yahoo.com":"marketing","sp.analytics.yahoo.com":"marketing","gemini.yahoo.com":"marketing","adroll.com":"marketing","a.adroll.com":"marketing","d.adroll.com":"marketing","s.adroll.com":"marketing","adform.net":"marketing","track.adform.net":"marketing","dmp.adform.net":"marketing","criteo.com":"marketing","static.criteo.net":"marketing","bidder.criteo.com":"marketing","dynamic.criteo.com":"marketing","gum.criteo.com":"marketing","taboola.com":"marketing","cdn.taboola.com":"marketing","trc.taboola.com":"marketing","outbrain.com":"marketing","widgets.outbrain.com":"marketing","tr.outbrain.com":"marketing","amplify.outbrain.com":"marketing","bing.com":"marketing","bat.bing.com":"marketing","clarity.ms":"marketing","quantserve.com":"marketing","secure.quantserve.com":"marketing","pixel.quantserve.com":"marketing","exelator.com":"marketing","load.exelator.com":"marketing","api.exelator.com":"marketing","ad.360yield.com":"marketing","match.360yield.com":"marketing","ad.turn.com":"marketing","r.turn.com":"marketing","d.turn.com":"marketing","cdn.jsdelivr.net":"functionality","ajax.googleapis.com":"functionality","fonts.googleapis.com":"functionality","maps.googleapis.com":"functionality","www.recaptcha.net":"functionality","recaptcha.net":"functionality","www.gstatic.com":"functionality","fonts.gstatic.com":"functionality","cdnjs.cloudflare.com":"functionality","unpkg.com":"functionality","code.jquery.com":"functionality","maxcdn.bootstrapcdn.com":"functionality","cdn.datatables.net":"functionality","js.stripe.com":"functionality","api.stripe.com":"functionality","checkout.stripe.com":"functionality","js.braintreegateway.com":"functionality","api.braintreegateway.com":"functionality","cdn.shopify.com":"functionality","js.intercomcdn.com":"functionality","widget.intercom.io":"functionality","cdn.auth0.com":"functionality","js.pusher.com":"functionality","sockjs.pusher.com":"functionality","app.optimizely.com":"experience","cdn.optimizely.com":"experience","logx.optimizely.com":"experience","cdn.mouseflow.com":"experience","fullstory.com":"experience","rs.fullstory.com":"experience","edge.fullstory.com":"experience","vwo.com":"experience","dev.visualwebsiteoptimizer.com":"experience","assets.adobedtm.com":"experience","cdn.tt.omtrdc.net":"experience","demdex.net":"experience","sc.omtrdc.net":"experience","crazyegg.com":"experience","script.crazyegg.com":"experience","tracking.crazyegg.com":"experience","luckyorange.com":"experience","cdn.luckyorange.com":"experience","w1.luckyorange.com":"experience","upload.luckyorange.com":"experience","clicktale.net":"experience","cdn.clicktale.net":"experience","conductor.clicktale.net":"experience","userzoom.com":"experience","cdn.userzoom.com":"experience","api.userzoom.com":"experience","contentsquare.net":"experience","t.contentsquare.net":"experience","app.contentsquare.com":"experience"},ql=Ul;function Hl(){return{experience:!1,functionality:!1,marketing:!1,measurement:!1,necessary:!0}}var Gl=/^www\./,Wl=/:\d+$/;function Vl(i={},e){let t={disableAutomaticBlocking:!1,...i,domainConsentMap:i.overrideDomainConsentMap?i.domainConsentMap:{...ql,...i.domainConsentMap}},n=e||Hl(),r=window.fetch,s=window.XMLHttpRequest;function o(d){return d.toLowerCase().replace(Gl,"").replace(Wl,"").trim()}function a(d,p){let g=o(d),v=p[g];if(v)return v;for(let[_,E]of Object.entries(p)){let x=o(_);if(g.endsWith(`.${x}`)||g===x)return E}}function l(d){try{let p=new URL(d).hostname,g=a(p,t.domainConsentMap||{});return g?n[g]===!0:!0}catch{return!0}}function u(d){document.dispatchEvent(new CustomEvent("ConsentBlockedRequest",{detail:{url:d}}))}function c(){window.fetch===r&&(window.fetch=async(d,p)=>{let g=d instanceof Request?d.url:d.toString();return l(g)?await r.call(window,d,p):(u(g),Promise.reject(new Error(`Request to ${g} blocked due to missing consent`)))}),window.XMLHttpRequest===s&&(window.XMLHttpRequest=class extends s{open(d,p,g=!0,v,_){if(!l(p.toString()))throw u(p.toString()),new Error(`Request to ${p} blocked due to missing consent`);super.open(d,p,g,v,_)}})}function h(){window.fetch!==r&&(window.fetch=r),window.XMLHttpRequest!==s&&(window.XMLHttpRequest=s)}return t.disableAutomaticBlocking||c(),{updateConsents:d=>{n={...n,...d}},destroy:()=>{h()}}}function No(i,e){return e&&typeof window<"u"&&window.navigator.doNotTrack==="1"?Object.keys(i).reduce((t,n)=>(n in i&&(t[n]=n==="necessary"),t),{}):i}function Xl(i,e,t){return No(e,t)[i]||!1}function Yl(i){return i!==null}function Kl(i){try{if(window.localStorage)return window.localStorage.setItem("c15t-storage-test-key","test"),window.localStorage.removeItem("c15t-storage-test-key"),!0}catch(e){console.warn("localStorage not available, skipping consent banner:",e),i({isLoadingConsentInfo:!1,showPopup:!1})}return!1}function Po(i,{set:e,get:t,initialTranslationConfig:n,trackingBlocker:r},s){let{consentInfo:o,ignoreGeoLocation:a,callbacks:l,setDetectedCountry:u}=t(),{translations:c,location:h,showConsentBanner:d}=i,p=i.jurisdiction?.code==="NONE"&&!i.showConsentBanner,g={isLoadingConsentInfo:!1,branding:i.branding??"c15t",...o===null?{showPopup:d&&s||a}:{},...p&&{consents:{necessary:!0,functionality:!0,experience:!0,marketing:!0,measurement:!0}},locationInfo:{countryCode:h?.countryCode??null,regionCode:h?.regionCode??null,jurisdiction:i.jurisdiction?.code??null,jurisdictionMessage:i.jurisdiction?.message??null},jurisdictionInfo:i.jurisdiction};c?.language&&c?.translations;{let v=Eo({translations:{[c.language]:c.translations},disableAutoLanguageSwitch:!0,defaultLanguage:c.language},n);g.translationConfig=v}i.location?.countryCode&&u(i.location.countryCode),g.hasFetchedBanner=!0,g.lastBannerFetchData=i,e(g),p&&l?.onConsentSet?.({preferences:{necessary:!0,functionality:!0,experience:!0,marketing:!0,measurement:!0}}),l?.onBannerFetched?.({showConsentBanner:i.showConsentBanner,jurisdiction:i.jurisdiction,location:i.location,translations:{language:c.language,translations:c.translations}}),r?.updateConsents(t().consents),t().updateScripts()}async function Jl(i){let{get:e,set:t,manager:n,initialData:r}=i,{callbacks:s}=e();if(typeof window>"u")return;let o=Kl(t);if(o){if(t({isLoadingConsentInfo:!0}),r)try{let a=await r;if(a)return Po(a,i,!0),a}catch(a){throw a}try{let{data:a,error:l}=await n.showConsentBanner({onError:s.onError?u=>{s.onError&&s.onError({error:u.error?.message||"Unknown error"})}:void 0});if(l||!a)throw new Error(`Failed to fetch consent banner info: ${l?.message}`);return Po(a,i,o),a}catch(a){console.error("Error fetching consent banner information:",a),t({isLoadingConsentInfo:!1});let l=a instanceof Error?a.message:"Unknown error fetching consent banner information";s.onError?.({error:l}),t({showPopup:!1});return}}}var Mo={functionality_storage:"denied",security_storage:"denied",analytics_storage:"denied",ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",personalization_storage:"denied"},Zl={necessary:["security_storage"],functionality:["functionality_storage"],measurement:["analytics_storage"],marketing:["ad_storage","ad_user_data","ad_personalization"],experience:["personalization_storage"]};function jo(i){let e={...Mo};for(let t of Object.keys(i)){let n=i[t],r=Zl[t];for(let s of r)e[s]=n?"granted":"denied"}return e}function Ql(i){let e=i.consentState?jo(i.consentState):Mo,t=document.createElement("script");if(t.textContent=`
    window.dataLayer = window.dataLayer || [];
    window.gtag = function gtag() {
      window.dataLayer.push(arguments);
    };
    window.gtag('consent', 'default', {
      ...${JSON.stringify(e)},
    });
    window.dataLayer.push({
      'gtm.start': Date.now(),
      event: 'gtm.js',
    });
  `,!document.head)throw new Error("Document head is not available for script injection");document.head.appendChild(t)}function ec(i){let e=document.createElement("script");if(e.async=!0,e.src=i.customScriptUrl?i.customScriptUrl:`https://www.googletagmanager.com/gtm.js?id=${i.id}`,!document.head)throw new Error("Document head is not available for script injection");document.head.appendChild(e)}function tc(i){let e=i.id;if(!e||e.trim().length===0)throw new Error("GTM container ID is required and must be a non-empty string");typeof window>"u"||typeof document>"u"||(Ql(i),ec(i))}function nc(i){window.gtag&&window.gtag("consent","update",jo(i))}function ic(i,e){let t=null,n=!1;return{initializeIframeBlocker:()=>{if(n||typeof document>"u")return;let r=i();if(r.iframeBlockerConfig?.disableAutomaticBlocking)return;let s=()=>{let o=$o();o.length>0&&i().updateConsentCategories(o)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s(),setTimeout(s,100),Ro(r.consents),t=$l(()=>i().consents,o=>i().updateConsentCategories(o)),n=!0},updateIframeConsents:()=>{if(!n||typeof document>"u")return;let r=i(),{consents:s,iframeBlockerConfig:o}=r;o?.disableAutomaticBlocking||Ro(s)},destroyIframeBlocker:()=>{if(!n||typeof document>"u")return;let r=i(),{iframeBlockerConfig:s}=r;s?.disableAutomaticBlocking||(t&&(t.disconnect(),t=null),n=!1)}}}var rc="1.7.1",fr="privacy-consent-storage",Ee={config:{pkg:"c15t",version:rc,mode:"Unknown"},consents:Ft.reduce((i,e)=>(i[e.name]=e.defaultValue,i),{}),selectedConsents:Ft.reduce((i,e)=>(i[e.name]=e.defaultValue,i),{}),consentInfo:null,branding:"c15t",showPopup:!0,isLoadingConsentInfo:!1,hasFetchedBanner:!1,lastBannerFetchData:null,gdprTypes:["necessary","marketing"],isPrivacyDialogOpen:!1,isConsentDomain:!1,complianceSettings:{gdpr:{enabled:!0,appliesGlobally:!0,applies:!0},ccpa:{enabled:!0,appliesGlobally:!1,applies:void 0},lgpd:{enabled:!1,appliesGlobally:!1,applies:void 0},usStatePrivacy:{enabled:!0,appliesGlobally:!1,applies:void 0}},callbacks:{},detectedCountry:null,locationInfo:null,jurisdictionInfo:null,translationConfig:bn,includeNonDisplayedConsents:!1,consentTypes:Ft,iframeBlockerConfig:{disableAutomaticBlocking:!1},ignoreGeoLocation:!1,privacySettings:{honorDoNotTrack:!0},setConsent:()=>{},setShowPopup:()=>{},setIsPrivacyDialogOpen:()=>{},saveConsents:()=>{},resetConsents:()=>{},setGdprTypes:()=>{},setComplianceSetting:()=>{},resetComplianceSettings:()=>{},setCallback:()=>{},setDetectedCountry:()=>{},setLocationInfo:()=>{},getDisplayedConsents:()=>[],hasConsented:()=>!1,setTranslationConfig:()=>{},scripts:[],loadedScripts:{},scriptIdMap:{}};async function sc({manager:i,type:e,get:t,set:n,trackingBlocker:r}){let{callbacks:s,selectedConsents:o,consents:a,consentTypes:l,updateScripts:u,updateIframeConsents:c,gdprTypes:h}=t(),d=o??a??{};if(e==="all")for(let v of l)h.includes(v.name)&&(d[v.name]=!0);else if(e==="necessary")for(let v of l)d[v.name]=v.name==="necessary";let p={time:Date.now(),type:e};n({consents:d,selectedConsents:d,showPopup:!1,consentInfo:p}),await new Promise(v=>setTimeout(v,0)),r?.updateConsents(d),c(),nc(d),u();try{localStorage.setItem(fr,JSON.stringify({consents:d,consentInfo:p}))}catch(v){console.warn("Failed to persist consents to localStorage:",v)}s.onConsentSet?.({preferences:d});let g=await i.setConsent({body:{type:"cookie_banner",domain:window.location.hostname,preferences:d,metadata:{source:"consent_widget",acceptanceMethod:e}}});if(!g.ok){let v=g.error?.message??"Failed to save consents";s.onError?.({error:v}),s.onError||console.error(v)}}var Io=()=>{if(typeof window>"u")return null;let i=localStorage.getItem(fr);if(!i)return null;try{return JSON.parse(i)}catch(e){return console.error("Failed to parse stored consent:",e),null}},Bo=(i,e={})=>{let{namespace:t="c15tStore",trackingBlockerConfig:n,isConsentDomain:r=!1,translationConfig:s}=e,o=Io(),a=e.scripts&&e.scripts.length>0,l=typeof window>"u"||a?null:Vl(n||{},o?.consents||Ee.consents),u=Co((c,h)=>({...Ee,gdprTypes:e.initialGdprTypes??Ee.gdprTypes,ignoreGeoLocation:e.ignoreGeoLocation??!1,config:e.config??Ee.config,iframeBlockerConfig:e.iframeBlockerConfig??Ee.iframeBlockerConfig,isConsentDomain:r,callbacks:e.callbacks??Ee.callbacks,scripts:e.scripts??Ee.scripts,translationConfig:s||Ee.translationConfig,...o?{consents:o.consents,selectedConsents:o.consents,consentInfo:o.consentInfo,showPopup:!1,isLoadingConsentInfo:!1}:{showPopup:!1,isLoadingConsentInfo:!0},setShowPopup:(d,p=!1)=>{if(!d)return void c({showPopup:!1});let g=h(),v=Io();(p||!v&&!g.consentInfo&&!g.isLoadingConsentInfo)&&c({showPopup:!0})},setIsPrivacyDialogOpen:d=>{c({isPrivacyDialogOpen:d}),d||queueMicrotask(()=>{})},setSelectedConsent:(d,p)=>{c(g=>g.consentTypes.find(_=>_.name===d)?.disabled?g:{selectedConsents:{...g.selectedConsents,[d]:p}})},saveConsents:async d=>await sc({manager:i,type:d,get:h,set:c,trackingBlocker:l}),setConsent:(d,p)=>{c(g=>g.consentTypes.find(E=>E.name===d)?.disabled?g:{selectedConsents:{...g.consents,[d]:p}}),h().saveConsents("custom")},resetConsents:()=>{c(()=>{let d=Ft.reduce((g,v)=>(g[v.name]=v.defaultValue,g),{}),p={consents:d,selectedConsents:d,consentInfo:null};return localStorage.removeItem(fr),p})},setGdprTypes:d=>c({gdprTypes:d}),setComplianceSetting:(d,p)=>c(g=>({complianceSettings:{...g.complianceSettings,[d]:{...g.complianceSettings[d],...p}}})),resetComplianceSettings:()=>c({complianceSettings:Ee.complianceSettings}),setCallback:(d,p)=>{let g=h();if(c(v=>({callbacks:{...v.callbacks,[d]:p}})),d==="onConsentSet"&&p&&typeof p=="function"&&p?.({preferences:g.consents}),d==="onBannerFetched"&&g.hasFetchedBanner&&g.lastBannerFetchData&&p&&typeof p=="function"){let{lastBannerFetchData:v}=g;p?.({showConsentBanner:v.showConsentBanner,jurisdiction:v.jurisdiction,location:v.location,translations:{language:v.translations.language,translations:v.translations.translations}})}},setDetectedCountry:d=>c({detectedCountry:d}),setLocationInfo:d=>c({locationInfo:d}),fetchConsentBannerInfo:()=>Jl({manager:i,initialData:e._initialData,initialTranslationConfig:e.initialTranslationConfig,get:h,set:c,trackingBlocker:l}),getDisplayedConsents:()=>{let{gdprTypes:d,consentTypes:p}=h();return p.filter(g=>d.includes(g.name))},hasConsented:()=>{let{consentInfo:d}=h();return Yl(d)},getEffectiveConsents:()=>{let{consents:d,privacySettings:p}=h();return No(d,p.honorDoNotTrack)},hasConsentFor:d=>{let{consents:p,privacySettings:g}=h();return Xl(d,p,g.honorDoNotTrack)},has:d=>{let{consents:p}=h();return Z(d,p)},setTranslationConfig:d=>{c({translationConfig:d})},updateConsentCategories:d=>{let p=[...new Set([...h().gdprTypes,...d])];c({gdprTypes:p})},...zl(h,c,l),...ic(h,c)}));if(u.getState().initializeIframeBlocker(),e.scripts&&e.scripts.length>0&&u.getState().updateConsentCategories(e.scripts.flatMap(c=>Fo(c.category))),typeof window<"u"){if(window[t]=u,e.unstable_googleTagManager)try{tc({...e.unstable_googleTagManager,consentState:u.getState().consents})}catch(c){console.error("Failed to setup Google Tag Manager:",c)}u.getState().callbacks.onConsentSet?.({preferences:u.getState().consents}),u.getState().fetchConsentBannerInfo()}return u};var oc="phc_pHJHPnbMYIDtPIhCHqWSeUD5ho4GwjDBdRHtl8OiXBe",ac="https://us.i.posthog.com",lc="https://nineteen-eighty-four-us-east-production.c15t.dev",cc=Ao({mode:"c15t",backendURL:lc}),te=Bo(cc,{initialGdprTypes:["necessary","measurement","marketing"],ignoreGeoLocation:!0});function uc(){console.log("[Consent] Initializing PostHog"),st.init(oc,{api_host:ac,persistence:"localStorage+cookie",autocapture:!0,capture_pageview:!1,opt_out_capturing_by_default:!0,person_profiles:"identified_only",loaded:()=>{console.log("[Consent] PostHog loaded"),Dt()}})}function Dt(){let e=te.getState().consents?.measurement===!0;console.log("[Consent] Applying consent. Measurement:",e),e?(console.log("[Consent] \u2705 Analytics enabled"),st.opt_in_capturing(),st.capture("$pageview")):(console.log("[Consent] \u274C Analytics disabled"),st.opt_out_capturing())}function dc(){let i=document.getElementById("consent-accept-all"),e=document.getElementById("consent-reject-all"),t=document.getElementById("consent-save-preferences"),n=document.getElementById("consent-show-details"),r=document.getElementById("consent-simple-view"),s=document.getElementById("consent-details-view");i?.addEventListener("click",()=>{console.log("[Consent] Accept all"),te.getState().setConsent("necessary",!0),te.getState().setConsent("measurement",!0),te.getState().setConsent("marketing",!0),En(),Dt()}),e?.addEventListener("click",()=>{console.log("[Consent] Reject all"),te.getState().setConsent("necessary",!0),te.getState().setConsent("measurement",!1),te.getState().setConsent("marketing",!1),En(),Dt()}),t?.addEventListener("click",()=>{console.log("[Consent] Save preferences");let a=document.getElementById("consent-analytics"),l=document.getElementById("consent-marketing");te.getState().setConsent("necessary",!0),te.getState().setConsent("measurement",a?.checked||!1),te.getState().setConsent("marketing",l?.checked||!1),En(),Dt()}),n?.addEventListener("click",()=>{r&&s&&(r.style.display="none",s.style.display="block")}),document.querySelectorAll("[data-consent-manage]").forEach(a=>{a.addEventListener("click",l=>{l.preventDefault(),vr(),r&&s&&(r.style.display="none",s.style.display="block")})})}function vr(){let i=document.getElementById("consent-banner");i&&(i.style.display="flex",i.setAttribute("aria-hidden","false"))}function En(){let i=document.getElementById("consent-banner");i&&(document.activeElement&&i.contains(document.activeElement)&&document.activeElement.blur(),i.style.display="none",i.setAttribute("aria-hidden","true"))}function hc(){let i=new URLSearchParams(window.location.search),e=i.has("test-consent");if(i.has("reset-consent")){console.log("[Consent] Resetting consent"),localStorage.clear(),i.delete("reset-consent");let s=window.location.pathname+(i.toString()?"?"+i.toString():"");window.history.replaceState({},"",s)}let n=te.getState(),r=n.consents&&Object.keys(n.consents).length>0;e?(console.log("[Consent] Force showing banner"),vr()):n.showPopup||!r?(console.log("[Consent] Showing banner (no consent yet)"),vr()):(console.log("[Consent] Has consent, hiding banner"),En())}function pc(){te.subscribe(i=>{console.log("[Consent] State changed:",i.consents),Dt()})}function zo(){console.log("[Consent] Initializing");try{uc(),pc(),dc(),hc(),window.__store=te,window.__posthog=st,console.log("[Consent] \u2705 Initialization complete")}catch(i){console.error("[Consent] \u274C Initialization error:",i)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",zo):zo();})();
